{"version":3,"sources":["utils/color.js","utils/dbc.js","config.js","utils/url.js","logging/CloudLog.js","components/AddSignals.js","components/SignalLegendEntry/FIELDS.js","components/SignalLegendEntry/Field.js","components/SignalLegendEntry/OptionField.js","components/SignalLegendEntry/SignalForm.js","components/SignalLegendEntry/NumberField.js","utils/object.js","components/SignalLegendEntry/StringField.js","components/SignalLegendEntry/MapField.js","components/SignalLegendEntry/index.js","components/SignalLegend.js","images/webusb-enable-experimental-features.png","images/webusb-enable-webusb.png","workers/rlog-downloader.worker.js","workers/dbc-csv-downloader.worker.js","workers/message-parser.worker.js","workers/CanStreamerWorker.worker.js","api/github-auth.js","models/can/frame.js","models/can/BoardUnit.js","models/can/dbc.js","components/MessageBytes.js","components/Meta.js","utils/array.js","models/graph-data.js","vega/CanPlot.js","utils/debounce.js","components/CanGraph.js","components/CanGraphList.js","components/HLS.js","components/PlayButton.js","components/RouteSeeker/RouteSeeker.js","components/RouteVideoSync.js","components/CanLog.js","models/can/entries.js","components/PlaySpeedSelector.js","components/Explorer.js","components/Modals/baseModal.js","components/Modals/OnboardingModal.js","api/OpenDbc.js","components/SaveDbcModal.js","components/GithubDbcList.js","components/DbcUpload.js","components/LoadDbcModal.js","components/EditMessageModal.js","api/localstorage.js","api/unlogger.js","CanExplorer.js","utils/string.js","logging/Sentry.js","demo.js","corolla-dbc.js","init.js","index.js","models/can/signal.js","logging/LogEntries.js","utils/css.js"],"names":["shade","opacity","r","g","b","t","opacityPos","Math","abs","round","carFingerprintToDbc","require","createMessageSpec","dbc","address","id","bus","frame","getMessageFrame","size","entries","byteColors","Array","fill","byteStateChangeCounts","determineByteStateChangeTimes","hexData","time","msgSize","lastParsedMessage","byteStateChangeTimes","i","length","substr","createMessageEntry","relTime","data","signals","getSignalValues","Buffer","from","toString","updated","Date","now","parseMessage","timeStart","msgSpec","max","msgEntry","BIG_ENDIAN_START_BITS","j","push","bigEndianBitIndex","matrixBitIndex","indexOf","addCanMessage","canMessage","canStartTime","messages","prevMsgEntries","byteStateChangeCountsByMessage","busTime","undefined","prevMsgEntry","every","c","map","count","idx","matrixBitNumber","bigEndianIndex","reparseMessage","msg","findMaxByteStateChangeCount","Object","values","m","reduce","counts","countArr","concat","count1","count2","setMessageByteColors","message","maxByteStateChangeCount","isNaN","min","red","maxMessageSize","initial","entry","findDbcForCar","fingerprint","GITHUB_CLIENT_ID","GITHUB_REDIRECT_URL","GITHUB_AUTH_TOKEN_KEY","OPENDBC_SOURCE_REPO","USE_UNLOGGER","window","getUrlParameter","UNLOGGER_HOST","LOGENTRIES_TOKEN","PART_SEGMENT_LENGTH","CAN_GRAPH_MAX_POINTS","STREAMING_WINDOW","EXPLORER_URL","objToQuery","obj","keys","k","encodeURIComponent","decodeURIComponent","join","name","location","replace","results","RegExp","exec","search","modifyQueryParameters","add","remove","params","key","value","origin","pathname","CloudLog","LogEntries","init","token","no_format","catchall","this","context","bind","update","emit","level","global","__JEST__","ctx","created","getTime","src","log","warn","error","Styles","StyleSheet","create","bit","margin","padding","userSelect","cursor","textAlign","position","bitSelectedStyle","backgroundColor","byteIndex","bitSignificance","fontSize","display","bottom","left","right","highlightedSignalTitle","AddSignals","props","updateSignalStyles","signalStyles","calcSignalStyles","state","setState","matrixMouseMove","onSignalHover","signal","highlightedSignal","onBitHover","bitIdx","dragStartBit","dragSignal","copySignals","assign","startBit","isLittleEndian","msbBitIndex","DbcUtils","lsbBitNumber","diff","bitDescription","floor","lsbBitIndex","dragCurrentBit","onSignalHoverEnd","resetDragState","ev","highlightedSignalTooltipRef","current","tt","innerHTML","style","clientX","top","clientY","onTentativeSignalChange","onSignalChange","uid","signalName","propagateUpSignalChange","onSignalRemove","onSignalPlotChange","shouldPlot","signalUid","React","createRef","bits","maxMessageBytes","signalsCopy","componentDidMount","componentDidUpdate","prevProps","selectedMessageKey","shouldComponentUpdate","nextProps","nextState","messageIndex","JSON","stringify","plottedSignalUids","signalColorStyle","colorRgbStr","colors","getColors","darkenedColors","lightenedColors","colorsCommaSep","color","forEach","signalForBit","filter","signalBitIndex","nextNewSignalName","existingNames","signalNum","onBitMouseDown","createSignal","Signal","createSignalIfNotExtendingOne","dragEndBit","isDragAcrossSingleByte","onBitMouseUp","byteValueHex","byteIdx","bitValue","byteBitIdx","readInt8","bitIsContainedInSelection","bigEndianStartBit","bigEndianCurrentBit","bigEndianBitIdx","onBitDoubleClick","renderBitMatrix","rowCount","rows","rowBits","className","css","bitStyle","bitDesc","isMsb","isLsb","onMouseEnter","onMouseLeave","onMouseDown","onMouseUp","onDoubleClick","onMouseMove","ref","cellSpacing","onConfirmedSignalChange","render","toFixed","Component","unsignedTransformation","field","Number","title","type","transform","options","optionValues","Little","Big","startByte","endByte","Signed","Unsigned","Field","htmlFor","children","errorCls","valid","FieldMap","number","valueCol","fieldSpec","isExpanded","signalEdited","updateField","num","onChange","e","target","option","valueOptions","swapKeysAndValues","f","acc","optionEles","opt","defaultValue","string","mapString","str","desc","trim","split","splitted","matchAll","match","res","Map","set","getSignalEdited","fieldError","FIELDS","Node","onClick","SignalLegendEntry","signalCopy","toggleEditing","fieldSpecForName","parseInt","toggleExpandSignal","stopPropagation","toggleSignalPlot","isPlotted","preventDefault","equals","isHighlighted","expandedEntryClass","plottedButtonClass","colorBarStyle","cx","SignalForm","find","SignalLegend","expandedSignals","s","includes","updatedExpandedSignals","checkExpandedSignal","signalRows","sort","signal1","signal2","row","a","module","exports","Worker","authorizeUrl","route","client_id","redirect_uri","scope","Frame","transmitters","extended","comment","nextNewTransmitterName","txName","txNum","addTransmitter","header","text","copy","BoardUnit","attributes","DBC_COMMENT_RE","DBC_COMMENT_MULTI_LINE_RE","MSG_RE","SIGNAL_RE","MP_SIGNAL_RE","VAL_RE","VAL_TABLE_RE","MSG_TRANSMITTER_RE","SIGNAL_COMMENT_RE","SIGNAL_COMMENT_MULTI_LINE_RE","MESSAGE_COMMENT_RE","MESSAGE_COMMENT_MULTI_LINE_RE","BOARD_UNIT_RE","BOARD_UNIT_COMMENT_RE","BOARD_UNIT_COMMENT_MULTI_LINE_RE","floatOrInt","numericStr","isInteger","parseFloat","DBC","dbcString","boardUnits","comments","dbcText","importDbcString","get","nextNewFrameName","messageNames","msgName","msgNum","updateBoardUnits","boardUnitNames","bu","missingBoardUnits","arr","receiver","receivers","recv","array","txt","_newSymbols","boardUnitsText","frames","messageTxs","slice","addr","txs","signalsByMsgId","sig","s1","s2","msgAddr","valueDescriptions","valueDescriptionText","getMessageName","msgId","getSignals","createFrame","setSignals","frameSize","newMsg","addSignal","warnings","valueTables","followUp","lines","line","followUpLine","partialComment","matches","idString","transmitter","isSigned","factor","offset","unit","receiverStr","signalProperties","messageId","vals","description","table","tableName","items","hasFollowUp","newBoardUnits","boardUnitName","boardUnit","valueForIntSignal","signalSpec","view","sig_lsb","sig_msb","ret","byteLength","lsb","d","getUint8","BigInt","asIntN","has","DataView","buffer","signalValuesByName","getChffrMetricMappings","metricComment","metric","metrics","metricName","MessageBytes","isVisible","lastMessageIndex","lastSeekTime","onVisibilityChange","onCanvasRefAvailable","updateCanvas","canvasInView","ceil","canvas","height","seekIndex","seekTime","visualViewport","getBoundingClientRect","y","live","nextLastEntry","curLastEntry","findMostRecentMessage","mostRecentMessageIndex","findIndex","mostRecentMsg","getContext","x","fillStyle","fillRect","font","fillText","width","IntersectionObserver","observe","ckmeans","Meta","onFilterChanged","onFilterFocus","onFilterUnfocus","canMsgFilter","renderMessageBytes","dbcLastSaved","filterText","lastSaved","fromNow","hoveredMessages","orderedMessageKeys","lastSavedTimer","setInterval","componentWillUnmount","clearInterval","sortMessages","byteCountsDidUpdate","prevMessages","nextMessages","some","messagesByEntryCount","partialMapping","entryCountKey","entryCounts","bin","entryCount","partial","msg1","msg2","reverse","val","toLowerCase","lastSavedPretty","onMessageHover","onMessageHoverEnd","onMsgRemoveClick","selectedMessages","onMessageUnselected","onMessageSelected","updateSelectedMessages","orderedMessages","selectedMessageClass","renderCanMessages","renderAvailableMessagesList","cellPadding","saveable","navigator","ReadableStream","WritableStream","dbcFilename","showLoadDbc","saveLog","shareUrl","data-clipboard-text","data-clipboard-action","Clipboard","href","showSaveDbc","onFocus","onBlur","elementWiseEquals","arr1","arr2","ele","findIndexRight","condition","_calcGraphData","firstCanTime","console","samples","skip","lastEntry","random","appendNewGraphData","plottedSignals","graphData","plottedMessages","plottedMessageIds","index","maxGraphTime","series","signalUidsByMessageId","graphDataMaxMessageTimes","signalUids","maxIndex","ArrayUtils","newGraphData","firstNewEntryIdx","newEntries","signalGraphData","messageIdOutOfBounds","graphDataLowerBound","signalColors","v","debounce","func","wait","immediate","timeout","args","arguments","later","apply","callNow","clearTimeout","setTimeout","DefaultPlotInnerStyle","CanGraph","updateBounds","bounds","run","insertData","changeset","insert","change","plotInnerStyle","shiftX","shiftY","isDataInserted","getGraphData","spec","getGraphSpec","onNewView","onSignalClickTime","onSignalSegment","onDragAnchorMouseDown","onDragAnchorMouseUp","onDragStart","onPlotResize","firstRelTime","lastRelTime","messageRelTime","GraphData","CanPlotSpec","scales","domainMin","segment","domainMax","segmentIsNew","newSegment","visualChanged","canReceiveGraphDrop","dragPos","runAfter","updateStyleFromDragPos","plottedSignal","currentTime","runAsync","clickTime","onRelativeTimeClick","isArray","onSegmentChanged","getState","subcontext","brush","plotInnerStyleFromMouseEvent","rect","container","persist","onDragEnd","canReceiveDropClass","onGraphRefAvailable","messageName","unplot","background","onResize","measureRef","Vega","logLevel","signalListeners","renderer","actions","emptyTable","CanGraphList","draggingSignal","dragShift","graphToReceiveDrop","plotListRef","plotRefs","renderSignalPlot","onGraphDragStart","onGraphDragEnd","determineDraggingGraph","draggingGraph","hidden","document","elementFromPoint","closestPlot","closest","closestPlotRef","isEqualNode","mergePlots","fromPlot","toPlot","addCanGraphRef","isDragging","onSignalUnplotPressed","onGraphTimeClick","HLS","onSeeking","playing","onLoadStart","onPlaySeek","videoElement","shouldInitVideoTime","onSeeked","onLoadEnd","onLoadedData","startTime","playbackRate","playbackSpeed","source","loadSource","paused","play","pause","player","Hls","enableWorker","disablePtsDtsCorrectionInMp4Remux","on","Events","ERROR","event","fatal","ErrorTypes","NETWORK_ERROR","startLoad","MEDIA_ERROR","recoverMediaError","destroy","attachMedia","onVideoElementAvailable","video","autoPlay","muted","onWaiting","onPlaying","PlayButton","hover","imageSource","isPlaying","process","onPause","onPlay","alt","onMouseOver","RouteSeeker","updateDraggingSeek","ratio","onUserSeek","seekedBarStyle","zeroSeekedBarStyle","markerStyle","hiddenMarkerStyle","tooltipStyle","hiddenTooltipStyle","tooltipTime","executePlayTimer","segmentIndices","videoLength","newRatio","updateSeekedBar","nearestFrameTime","segmentProgress","cancelAnimationFrame","playTimer","mouseEventXOffsetPercent","progressBar","offsetWidth","markerOffsetPct","markerWidth","tooltipWidth","ratioTime","requestAnimationFrame","roundTime","loadingOverlay","justifyContent","alignItems","zIndex","loadingSpinner","img","hls","seekBar","RouteVideoSync","isLoading","userSeekTime","share","videoOffset","fullname","VideoApi","getQcameraStreamUrl","exp","duration","funcSeekToRatio","playSpeed","onVideoClick","CanLog","expandedMessages","messageHeights","allPacketsExpanded","renderLogListItemMessage","addDisplayedMessages","renderLogListItem","renderLogList","onExpandAllChanged","toggleExpandAllPackets","curMessageLength","nextMessageLength","newLength","ITEMS_PER_PAGE","expandMessage","msgIdx","onMessageExpanded","collapseMessage","expMsgTime","isSignalPlotted","plot","signalValuePretty","isFloat","isMessageExpanded","plotted","onSignalPlotPressed","toggleExpandPacketSignals","msgIsExpanded","msgHasSignals","renderLogListItemSignals","plottedButtonText","hasSignalsClass","expandedClass","msgHexs","substring","hx","listLength","checked","expandAllText","expandAllClass","itemRenderer","itemsRenderer","pageSize","updateWhenThisValueChanges","findTimeIndex","findRelativeTimeIndex","findSegmentIndices","isRelative","segmentTimeLow","segmentTimeHi","timeIndexFunc","segmentIdxLow","upperSegmentIdxHi","segmentIdxHi","PlaySpeedSelector","onPlaySpeedChanged","currentTarget","float","clipSegment","_segment","_segmentIndices","nextMessage","segmentStartIdx","segmentEndIdx","segmentStartTime","segmentEndTime","Explorer","updateSegment","selectedMessage","currentParts","Entries","userSeekIndex","startSegments","shouldShowAddSignal","autoplay","showAddSignal","onKeyDown","toggleShouldShowAddSignal","changePlaySpeed","addEventListener","removeEventListener","keyCode","resetSegment","prevMessage","curMessage","newPlottedSignals","messageExists","Boolean","signalExists","timeWindow","routeStartTime","partStartOffset","partEndOffset","windowStartTime","clone","format","windowEndTime","indexFromSeekTime","l","onSeek","secondsLoadedRouteRelative","secondsLoaded","partsCount","renderSelectMessagePrompt","selectedMessagePlottedSignalUids","renderExplorerSignals","selectedMessageName","showEditMessageModal","onClose","fromPlotIdx","splice","toPlotIdx","signalsExpandedClass","thumbnails","graphSegment","maxqcamera","url","Modal","windowHeight","modalHeight","updateHeights","contentRect","innerHeight","readVariationClasses","variations","classes","variation","checkClosability","disableClose","checkYScrollability","handleClose","subtitle","navigation","footer","OnboardingModal","webUsbEnabled","usb","viewingUsbInstructions","pandaConnected","attemptPandaConnection","toggleUsbInstructions","navigateToExplorer","script","createElement","body","appendChild","onload","AppleID","auth","clientId","AuthConfig","APPLE_CLIENT_ID","APPLE_SCOPES","redirectURI","APPLE_REDIRECT_URI","APPLE_STATE","async","detail","authorization","code","APPLE_REDIRECT_PATH","qs","handlePandaConnect","filterRoutesWithCan","drive","can","renderPandaEligibility","attemptingPandaConnection","renderLogin","CommaAuth","isAuthenticated","GOOGLE_REDIRECT_LINK","signIn","GITHUB_REDIRECT_LINK","renderOnboardingOptions","renderUsbInstructions","instructionalImages","step2","step3","renderModalContent","renderModalFooter","rel","OpenDBC","github","GitHub","sourceRepo","getRepo","githubUsername","hasAuth","fetchGithubUsername","getUser","user","getProfile","profile","login","repoFullName","repo","username","repoName","getContents","response","content","path","dbcPath","fileContents","rawContentsUrl","download_url","fetch","cache","resp","repoSourceIsOpenDbc","repoDetails","full_name","getGithubUsername","openDbcFork","getDetails","repoDetailResp","fork","status","contents","commitMessage","getRef","refResp","getCommit","object","sha","headCommitResp","headCommit","getTree","tree","headTreeResp","headTree","mode","createTree","createTreeResp","createdTree","commit","commitResp","updateHead","updateHeadResp","SaveDbcModal","tab","sourceDbcFilename","tabs","commitToGitHub","downloadDbcFile","forkOpenDbcAndWait","renderForkButton","renderTabNavigation","renderActions","openDbcClient","getUserOpenDbcFork","filename","commitFile","onDbcSaved","blob","Blob","FileSaver","saveAs","isTimedOut","interval","then","primaryActionDisabled","renderForkStep","disabled","hasGithubAuth","loginWithGithub","renderFilenameField","data-extension","renderCommitMessage","renderTabContent","GithubDbcList","paths","selectedPath","pathQuery","updatePathQuery","list","selectPath","getDbcContents","dbcContents","onDbcLoaded","placeholder","p","DbcUpload","onTextChanged","LoadDbcModal","dbcSource","userOpenDbcRepo","handleSave","onDbcSelected","EditMessageModal","messageFrame","editTransmitter","fetchPersistedDbc","routeName","maybeDbc","localStorage","getItem","parse","persistDbc","dbcJson","setItem","UnloggerClient","socket","SocketIO","seek","dongleId","baseTime","seekSeconds","RLogDownloader","LogCSVDownloader","MessageParser","CanStreamerWorker","dataCache","CanExplorer","partChangeDebounced","loadMessagesFromCache","spawnWorker","canFrameOffset","routeInitTime","firstFrameTime","carFingerprint","lastBusTime","currentPart","currentWorkers","loadingParts","loadedParts","showOnboarding","editMessageModalMessage","partsLoaded","spawnWorkerHash","pandaNoDeviceSelected","isGithubAuthenticated","githubAuthToken","logUrls","OpenDbc","unloggerClient","hideOnboarding","hideLoadDbc","hideSaveDbc","hideEditMessageModal","onPartChange","onMessageFrameEdited","initCanData","processStreamedCanMessages","onStreamedCanMessagesProcessed","showingModal","lastMessageEntriesById","githubSignOut","downloadLogAsCSV","pandaReader","Panda","onMessage","dataCacheTimer","loadMessagesFromCacheRunning","part","lastUsed","Moment","proclog","start_time","routePromise","logUrlsPromise","Promise","resolve","DrivesApi","getRouteInfo","RawDataApi","getRouteFiles","all","initData","newState","getShareSignature","shareSignature","catch","err","CommaAuthStorage","logOut","isAuthed","lastUpdated","writer","createWriteStream","getWriter","encoder","TextEncoder","downloadLiveLogAsCSV","dataHandler","downloadRawLogAsCSV","logData","shouldClose","progress","close","uint8array","encode","write","handler","worker","onmessage","postMessage","sourceId","mergeThumbnails","newThumbnails","oldIndex","newIndex","monoTime","result","cancelWorker","workerHash","minPart","maxPart","allWorkerParts","partOffset","tempPart","hash","charCodeAt","newMessages","isFinished","carParams","CarFingerprint","addMessagesToDataCache","prepend","dataCallback","base","isLegacyShare","addAndRehydrateMessages","msgEntries","newMsgEntries","msgLength","newMsgLength","entryLength","msgIndex","newMsgIndex","getParseSegment","parseMessageEntry","msgs","loadMessagesFromCacheTimer","isCanceled","start","performance","promises","prev","cacheEntry","newMessageEntries","messageEntries","promise","getParseSegmentInternal","reparseMessages","end","decacheMessageId","_messages","reject","_entry","lastMsg","memo","sessionStorage","AUTH_PATH","updateMessageFrame","msgKey","GithubAuth","newCanMessages","canStreamerWorker","firstEntryIndexInsideStreamingWindow","windowFloor","enforceStreamingMessageWindow","messageIds","newEntryFloor","_onStreamedCanMessagesProcessed","persistedDbc","unlisten","onError","stack","dataArray","unpersistGithubAuthToken","removeItem","segments","selectedPart","routes","opts","__webpack_hash__","release","Raven","config","install","demoProps","isDemo","provider","AuthApi","refreshAccessToken","AuthStorage","setCommaAccessToken","onboardingPath","Request","configure","Sentry","routeFullName","isShare","authTokenQueryParam","persistGithubAuthToken","urlNoAuthToken","fetchPersistedGithubAuthToken","authenticate","ReactDOM","getElementById","multiplex","calculateMin","calculateMax","generateColors","_colors","defineProperty","enumberable","byteOrder","signedChar","littleEndianBitDescription","bitIndex","bitRange","bitNumber","bigEndianBitDescription","range","calculateRawRange","rawRange","pow","rawMin","rawMax","parts","lastColor","randomcolor","otherSignal","self","_indexOf","LogStream","_endpoint","_traceCode","trace","PI","_pageInfo","page_info","_token","_print","print","_noFormat","_SSL","XDomainRequest","ssl","protocol","LEENDPOINT","_backlog","_active","_sentPageInfo","_apiCall","request","_getAjaxObject","XMLHttpRequest","constructor","onreadystatechange","readyState","shift","open","setRequestHeader","overrideMimeType","send","_getEvent","prototype","call","Error","_agentInfo","nav","doNotTrack","screen","referrer","innerWidth","browser","appName","version","appVersion","cookie_enabled","cookieEnabled","do_not_track","platform","_rawLog","serialized","ex","oldHandler","onerror","newHandler","Logger","logger","dict","endpoint","_log","info","loggers","_createLogStream","hasOwnProperty","_deprecatedInit","createLogStream","to","_getLogger","_destroyLogStream","styles","it","_definition","_name","classNames"],"mappings":"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","file":"static/js/main.5a891b75.chunk.js","sourcesContent":["export function shade([r, g, b], opacity) {\n  /*\n    @param {Array} rgb\n    @param {Number} opacity -1.0 -> +1.0\n        negative opacity will darken image\n\n    returns new RGB array\n    */\n  const t = opacity < 0 ? 0 : 255;\n  const opacityPos = Math.abs(opacity);\n\n  return [\n    Math.round((t - r) * opacityPos) + r,\n    Math.round((t - g) * opacityPos) + g,\n    Math.round((t - b) * opacityPos) + b\n  ];\n}\n","const carFingerprintToDbc = require('./car_fingerprint_to_dbc.json');\n\nfunction findMaxByteStateChangeCount(messages) {\n  return Object.values(messages)\n    .map((m) => m.byteStateChangeCounts)\n    .reduce((counts, countArr) => counts.concat(countArr), []) // flatten arrays\n    .reduce((count1, count2) => (count1 > count2 ? count1 : count2), 0); // find max\n}\n\nfunction addCanMessage(\n  canMessage,\n  dbc,\n  canStartTime,\n  messages,\n  prevMsgEntries,\n  byteStateChangeCountsByMessage\n) {\n  const {\n    address, busTime, data, bus\n  } = canMessage;\n  const id = `${bus}:${address.toString(16)}`;\n\n  if (messages[id] === undefined) messages[id] = createMessageSpec(dbc, address, id, bus);\n\n  const prevMsgEntry = messages[id].entries.length > 0\n    ? messages[id].entries[messages[id].entries.length - 1]\n    : prevMsgEntries[id] || null;\n\n  if (\n    byteStateChangeCountsByMessage[id]\n    && messages[id].byteStateChangeCounts.every((c) => c === 0)\n  ) {\n    messages[id].byteStateChangeCounts = byteStateChangeCountsByMessage[id];\n  }\n\n  const { msgEntry, byteStateChangeCounts } = parseMessage(\n    dbc,\n    busTime,\n    address,\n    data,\n    canStartTime,\n    prevMsgEntry\n  );\n\n  messages[id].byteStateChangeCounts = byteStateChangeCounts.map(\n    (count, idx) => messages[id].byteStateChangeCounts[idx] + count\n  );\n\n  messages[id].entries.push(msgEntry);\n\n  return msgEntry;\n}\n\nfunction createMessageSpec(dbc, address, id, bus) {\n  const frame = dbc.getMessageFrame(address);\n  const size = frame ? frame.size : 8;\n\n  return {\n    address,\n    id,\n    bus,\n    entries: [],\n    frame,\n    byteColors: Array(size).fill(0),\n    byteStateChangeCounts: Array(size).fill(0)\n  };\n}\n\nfunction determineByteStateChangeTimes(\n  hexData,\n  time,\n  msgSize,\n  lastParsedMessage\n) {\n  const byteStateChangeCounts = Array(msgSize).fill(0);\n  let byteStateChangeTimes;\n\n  if (!lastParsedMessage) {\n    byteStateChangeTimes = Array(msgSize).fill(time);\n  } else {\n    // debugger;\n    byteStateChangeTimes = lastParsedMessage.byteStateChangeTimes;\n\n    for (let i = 0; i < byteStateChangeTimes.length; i++) {\n      const currentData = hexData.substr(i * 2, 2);\n      const prevData = lastParsedMessage.hexData.substr(i * 2, 2);\n\n      if (currentData !== prevData) {\n        byteStateChangeTimes[i] = time;\n        byteStateChangeCounts[i] = 1;\n      }\n    }\n  }\n\n  return { byteStateChangeTimes, byteStateChangeCounts };\n}\n\nfunction createMessageEntry(\n  dbc,\n  address,\n  time,\n  relTime,\n  data,\n  byteStateChangeTimes\n) {\n  return {\n    signals: dbc.getSignalValues(address, data),\n    address,\n    data,\n    time,\n    relTime,\n    hexData: Buffer.from(data).toString('hex'),\n    byteStateChangeTimes,\n    updated: Date.now()\n  };\n}\n\nfunction reparseMessage(dbc, msg, lastParsedMessage) {\n  const msgSpec = dbc.getMessageFrame(msg.address);\n  const msgSize = msgSpec ? msgSpec.size : 8;\n\n  const {\n    byteStateChangeTimes,\n    byteStateChangeCounts\n  } = determineByteStateChangeTimes(\n    msg.hexData,\n    msg.relTime,\n    msgSize,\n    lastParsedMessage\n  );\n\n  const msgEntry = {\n    ...msg,\n    signals: dbc.getSignalValues(msg.address, msg.data),\n    byteStateChangeTimes,\n    updated: Date.now()\n  };\n\n  return { msgEntry, byteStateChangeCounts };\n}\n\nfunction parseMessage(dbc, time, address, data, timeStart, lastParsedMessage) {\n  let hexData;\n  if (typeof data === 'string') {\n    hexData = data;\n    data = Buffer.from(data, 'hex');\n  } else {\n    hexData = Buffer.from(data).toString('hex');\n  }\n  const msgSpec = dbc.getMessageFrame(address);\n  const msgSize = msgSpec ? msgSpec.size : Math.max(8, data.length);\n  const relTime = time - timeStart;\n\n  const {\n    byteStateChangeTimes,\n    byteStateChangeCounts\n  } = determineByteStateChangeTimes(\n    hexData,\n    relTime,\n    msgSize,\n    lastParsedMessage\n  );\n  const msgEntry = createMessageEntry(\n    dbc,\n    address,\n    time,\n    relTime,\n    data,\n    byteStateChangeTimes\n  );\n\n  return { msgEntry, byteStateChangeCounts };\n}\n\nconst BIG_ENDIAN_START_BITS = [];\nfor (let i = 0; i < 8 * 64; i += 8) {\n  for (let j = 7; j > -1; j--) {\n    BIG_ENDIAN_START_BITS.push(i + j);\n  }\n}\n\nfunction bigEndianBitIndex(matrixBitIndex) {\n  return BIG_ENDIAN_START_BITS.indexOf(matrixBitIndex);\n}\n\nfunction matrixBitNumber(bigEndianIndex) {\n  return BIG_ENDIAN_START_BITS[bigEndianIndex];\n}\n\nfunction setMessageByteColors(message, maxByteStateChangeCount) {\n  message.byteColors = message.byteStateChangeCounts\n    .map((count) => (isNaN(count)\n      ? 0\n      : Math.min(255, 75 + 180 * (count / maxByteStateChangeCount))))\n    .map((red) => `rgb(${Math.round(red)},0,0)`);\n\n  return message;\n}\n\nfunction maxMessageSize(message, initial = 8) {\n  let max = initial;\n  for (const entry of message.entries) {\n    const data = Buffer.from(entry.hexData, 'hex');\n    if (data.length > max) {\n      max = data.length;\n    }\n  }\n  return max;\n}\n\nfunction findDbcForCar(fingerprint) {\n  if (fingerprint in carFingerprintToDbc) {\n    return carFingerprintToDbc[fingerprint];\n  }\n  return null;\n}\n\nexport default {\n  bigEndianBitIndex,\n  addCanMessage,\n  createMessageSpec,\n  matrixBitNumber,\n  parseMessage,\n  reparseMessage,\n  findMaxByteStateChangeCount,\n  setMessageByteColors,\n  createMessageEntry,\n  maxMessageSize,\n  findDbcForCar,\n};\n","import { getUrlParameter } from './utils/url';\n\nconst ENV = process.env.NODE_ENV === 'production' ? 'prod' : 'debug';\n\nconst ENV_GITHUB_CLIENT_ID = {\n  debug: 'f1e42d14f45491f9ca34',\n  prod: '4b43250e7499a97d62a5'\n};\nexport const GITHUB_CLIENT_ID = ENV_GITHUB_CLIENT_ID[ENV];\n\nconst ENV_GITHUB_REDIRECT_URL = {\n  debug: 'http://127.0.0.1:1235/callback',\n  prod: 'https://api.comma.ai/cabana/ghcallback'\n};\nexport const GITHUB_REDIRECT_URL = ENV_GITHUB_REDIRECT_URL[ENV];\nexport const GITHUB_AUTH_TOKEN_KEY = 'gh_access_token';\nexport const OPENDBC_SOURCE_REPO = 'commaai/opendbc';\n\nexport const USE_UNLOGGER = typeof window !== 'undefined' && getUrlParameter('unlogger') !== null;\nexport const UNLOGGER_HOST = 'http://localhost:8080/unlogger';\n\nexport const LOGENTRIES_TOKEN = '4bc98019-8277-4fe0-867c-ed21ea843cc5';\n\nexport const PART_SEGMENT_LENGTH = 3;\n\nexport const CAN_GRAPH_MAX_POINTS = 5000;\n\nexport const STREAMING_WINDOW = 60;\n\nconst ENV_EXPLORER_URL = {\n  debug: 'http://127.0.0.1:3000/',\n  prod: 'https://connect.comma.ai/'\n};\nexport const EXPLORER_URL = ENV_EXPLORER_URL[ENV];\n","/* eslint-disable no-restricted-globals */\nexport function objToQuery(obj) {\n  return Object.keys(obj)\n    .map((k) => `${k}=${encodeURIComponent(decodeURIComponent(obj[k]))}`)\n    .join('&');\n}\n\nexport function getUrlParameter(name) {\n  const { location } = window;\n  name = name.replace(/[[]/, '\\\\[').replace(/[\\]]/, '\\\\]');\n  const regex = new RegExp(`[\\\\?&]${name}=([^&#]*)`);\n  const results = regex.exec(location.search);\n\n  return results === null\n    ? null\n    : decodeURIComponent(results[1].replace(/\\+/g, ' '));\n}\n\nexport function modifyQueryParameters({ add, remove = [] }) {\n  const regex = new RegExp('[\\\\?&]([^&#]+)=([^&#]*)');\n  const results = regex.exec(location.search);\n\n  let params = {};\n  if (results != null) {\n    for (let i = 1; i < results.length - 1; i += 2) {\n      const key = results[i];\n      const value = results[i + 1];\n      params[key] = value;\n    }\n    for (const key in params) {\n      if (remove.indexOf(key) !== -1) {\n        delete params[key];\n      }\n    }\n    params = { ...params, ...add };\n  } else {\n    params = add;\n  }\n\n  return `${location.origin + location.pathname}?${objToQuery(params)}`;\n}\n","import LogEntries from './LogEntries';\nimport { LOGENTRIES_TOKEN } from '../config';\n\nclass CloudLog {\n  constructor() {\n    LogEntries.init({\n      token: LOGENTRIES_TOKEN,\n      no_format: true,\n      catchall: false\n    });\n    this.context = {};\n  }\n\n  bind(obj) {\n    this.context.update(obj);\n  }\n\n  emit(message, level = 'log') {\n    if (typeof global.__JEST__ !== 'undefined') {\n      // Don't log in testing environment\n      return;\n    }\n\n    const entry = {\n      ctx: this.context,\n      created: new Date().getTime() / 1000,\n      msg: message,\n      src: 'JSCloudLog'\n    };\n\n    if (level === 'log') {\n      LogEntries.log(entry);\n    } else if (level === 'warn') {\n      LogEntries.warn(entry);\n    } else if (level === 'error') {\n      LogEntries.error(entry);\n    }\n  }\n\n  log(message) {\n    this.emit(message);\n  }\n\n  warn(message) {\n    this.emit(message, 'warn');\n  }\n\n  error(message) {\n    this.emit(message, 'error');\n  }\n}\n\nexport default new CloudLog();\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { StyleSheet } from 'aphrodite/no-important';\nimport css from '../utils/css';\n\nimport SignalLegend from './SignalLegend';\nimport Signal from '../models/can/signal';\nimport { shade } from '../utils/color';\nimport DbcUtils from '../utils/dbc';\n\n/*\nAddSignals component draws an 8x8 matrix\nrepresenting the bytes in a CAN message, alongside\na signal legend. Dragging on the matrix\neither extends or creates a signal, which is\nconfigurable in the legend.\n*/\n\nconst Styles = StyleSheet.create({\n  bit: {\n    margin: 0,\n    padding: 9,\n    userSelect: 'none',\n    cursor: 'pointer',\n    textAlign: 'center',\n    position: 'relative'\n  },\n  bitSelectedStyle: {\n    backgroundColor: 'rgba(0,119,158,0.5)'\n  },\n  byteIndex: {\n    backgroundColor: '#ededed'\n  },\n  bitSignificance: {\n    fontSize: 12,\n    display: 'block',\n    position: 'absolute',\n    bottom: 0,\n    left: 0,\n    right: 0,\n    margin: '0 auto'\n  },\n  highlightedSignalTitle: {\n    backgroundColor: 'rgba(0,0,0,0.2)'\n  }\n});\n\nexport default class AddSignals extends Component {\n  static propTypes = {\n    message: PropTypes.object,\n    onConfirmedSignalChange: PropTypes.func,\n    messageIndex: PropTypes.number,\n    onSignalPlotChange: PropTypes.func,\n    plottedSignalUids: PropTypes.array,\n    selectedMessageKey: PropTypes.string\n  };\n\n  constructor(props) {\n    super(props);\n\n    let signals = {};\n    if (props.message && props.message.frame && props.message.frame.signals) {\n      signals = this.copySignals(props.message.frame.signals);\n    }\n\n    this.highlightedSignalTooltipRef = React.createRef();\n\n    this.state = {\n      bits: [],\n      signals,\n      signalStyles: this.calcSignalStyles(signals),\n      highlightedSignal: null,\n      dragStartBit: null,\n      dragSignal: null,\n      dragCurrentBit: null,\n      maxMessageBytes: 8,\n    };\n  }\n\n  copySignals(signals) {\n    return Object.entries(signals).reduce(\n      (signalsCopy, [signalName, signal]) => {\n        signalsCopy[signalName] = Object.assign(Object.create(signal), signal);\n        return signalsCopy;\n      },\n      {}\n    );\n  }\n\n  componentDidMount() {\n    this.componentDidUpdate({}, {});\n  }\n\n  componentDidUpdate(prevProps) {\n    if (!prevProps.message || prevProps.message.address !== this.props.message.address ||\n      prevProps.selectedMessageKey !== this.props.selectedMessageKey)\n    {\n      const signals = this.props.message.frame ? this.props.message.frame.signals : {};\n\n      this.setState({\n        signals: this.copySignals(signals),\n        maxMessageBytes: DbcUtils.maxMessageSize(this.props.message)\n      }, this.updateSignalStyles);\n    }\n  }\n\n  shouldComponentUpdate(nextProps, nextState) {\n    return (\n      nextProps.selectedMessageKey !== this.props.selectedMessageKey ||\n      nextProps.message.address !== this.props.message.address ||\n      nextProps.message.hexData !== this.props.message.hexData ||\n      nextProps.messageIndex !== this.props.messageIndex ||\n      JSON.stringify(nextProps.plottedSignalUids) !== JSON.stringify(this.props.plottedSignalUids) ||\n      JSON.stringify(this.state) !== JSON.stringify(nextState)\n    );\n  }\n\n  signalColorStyle(signal) {\n    const colors = signal.getColors(this.props.selectedMessageKey);\n\n    let colorRgbStr;\n    let backgroundColor;\n    if (this.state && this.state.highlightedSignal === signal.name) {\n      // when signal highlighted,\n      // darkened background and lightened text.\n\n      const darkenedColors = shade(colors, -0.5);\n      const lightenedColors = shade(colors, 0.9);\n      colorRgbStr = `rgb(${lightenedColors.join(',')})`;\n      backgroundColor = `rgba(${darkenedColors.join(',')},0.5)`;\n    } else {\n      const colorsCommaSep = colors.join(',');\n      colorRgbStr = `rgb(${colorsCommaSep})`;\n      backgroundColor = `rgba(${colorsCommaSep},0.2)`;\n    }\n\n    const style = StyleSheet.create({\n      signal: { color: colorRgbStr, backgroundColor }\n    }).signal;\n    return style;\n  }\n\n  updateSignalStyles = () => {\n    const signalStyles = this.calcSignalStyles(this.state.signals);\n\n    this.setState({ signalStyles });\n    this.matrixMouseMove();\n  };\n\n  calcSignalStyles(signals) {\n    const signalStyles = {};\n    Object.values(signals).forEach((signal) => {\n      signalStyles[signal.name] = this.signalColorStyle(signal);\n    });\n\n    return signalStyles;\n  }\n\n  signalForBit(bitIdx) {\n    // bitIdx in [0,64)\n    // returns instance of Signal\n\n    return Object.values(this.state.signals).filter(\n      (signal) => signal.bitDescription(bitIdx) !== null\n    )[0];\n  }\n\n  onSignalHover = (signal) => {\n    if (!signal) return;\n\n    this.setState({ highlightedSignal: signal.name }, this.updateSignalStyles);\n  };\n\n  signalBitIndex(bitIdx, signal) {\n    // todo does this work for both big and little endian?\n    let { startBit } = signal;\n    if (!signal.isLittleEndian) {\n      startBit = DbcUtils.bigEndianBitIndex(startBit);\n    }\n    return bitIdx - startBit;\n  }\n\n  onBitHover = (bitIdx, signal) => {\n    let { dragStartBit, signals, dragSignal } = this.state;\n\n    if (dragStartBit !== null) {\n      if (dragSignal !== null) {\n        signals = this.copySignals(signals);\n        dragSignal = Object.assign(Object.create(dragSignal), dragSignal);\n\n        if (dragStartBit === dragSignal.startBit && dragSignal.size > 1) {\n          if (!dragSignal.isLittleEndian) {\n            // should not be able to drag the msb past the lsb\n            const hoveredBigEndian = DbcUtils.bigEndianBitIndex(bitIdx);\n            const lsbBigEndian = dragSignal.lsbBitNumber();\n\n            if (hoveredBigEndian > lsbBigEndian) {\n              return;\n            }\n          } else {\n            // should not be able to drag the lsb past the msb\n            if (bitIdx > dragSignal.msbBitIndex()) {\n              return;\n            }\n          }\n\n          const diff = bitIdx - dragStartBit;\n\n          if (dragSignal.isLittleEndian) {\n            dragSignal.size -= diff;\n          } else if (dragSignal.bitDescription(bitIdx) === null) {\n            dragSignal.size += Math.abs(diff);\n          } else {\n            dragSignal.size -= Math.abs(diff);\n          }\n\n          dragSignal.startBit += diff;\n\n          signals[dragSignal.name] = dragSignal;\n          dragStartBit = dragSignal.startBit;\n        } else if (dragSignal.size === 1) {\n          // 1-bit signals can be dragged in either direction\n          if (Math.floor(bitIdx / 8) === Math.floor(dragStartBit / 8)) {\n            if (bitIdx > dragStartBit) {\n              if (dragSignal.isLittleEndian) {\n                dragSignal.size = bitIdx - dragSignal.startBit;\n              } else {\n                dragSignal.startBit = bitIdx;\n                dragSignal.size = bitIdx - dragStartBit + 1;\n                dragStartBit = bitIdx;\n              }\n            } else if (dragSignal.isLittleEndian) {\n              dragSignal.startBit = bitIdx;\n              dragSignal.size = dragStartBit - bitIdx + 1;\n              dragStartBit = bitIdx;\n            } else {\n              dragSignal.size = dragStartBit - bitIdx + 1;\n              dragStartBit = bitIdx;\n            }\n          }\n\n          signals[dragSignal.name] = dragSignal;\n        } else if (\n          dragSignal.isLittleEndian\n          && dragStartBit === dragSignal.msbBitIndex()\n        ) {\n          if (bitIdx < dragSignal.startBit) {\n            // should not be able to drag the MSB past the LSB\n            return;\n          }\n          const diff = bitIdx - dragStartBit;\n          if (dragSignal.bitDescription(bitIdx) === null) {\n            dragSignal.size += Math.abs(diff);\n          } else {\n            dragSignal.size -= Math.abs(diff);\n          }\n          signals[dragSignal.name] = dragSignal;\n          dragStartBit = dragSignal.msbBitIndex();\n        } else if (\n          !dragSignal.isLittleEndian\n          && dragStartBit === dragSignal.lsbBitIndex()\n        ) {\n          const diff = bitIdx - dragStartBit;\n          if (dragSignal.bitDescription(bitIdx) === null) {\n            dragSignal.size += Math.abs(diff);\n          } else {\n            dragSignal.size -= Math.abs(diff);\n          }\n          signals[dragSignal.name] = dragSignal;\n          dragStartBit = dragSignal.lsbBitIndex();\n        }\n        this.setState({\n          signals,\n          dragSignal,\n          dragCurrentBit: bitIdx,\n          dragStartBit\n        });\n      } else {\n        this.setState({ dragCurrentBit: bitIdx });\n      }\n    }\n    if (signal) {\n      this.onSignalHover(signal);\n    }\n  };\n\n  onSignalHoverEnd = (signal) => {\n    if (!signal) return;\n\n    this.setState({ highlightedSignal: null }, this.updateSignalStyles);\n  };\n\n  nextNewSignalName() {\n    const existingNames = Object.keys(this.state.signals);\n    let signalNum = 1;\n    let signalName;\n    do {\n      signalName = `NEW_SIGNAL_${signalNum}`;\n      signalNum++;\n    } while (existingNames.indexOf(signalName) !== -1);\n\n    return signalName;\n  }\n\n  onBitMouseDown(dragStartBit, dragSignal) {\n    this.setState({\n      dragStartBit,\n      dragSignal: dragSignal || null\n    });\n  }\n\n  createSignal({ startBit, size, isLittleEndian }) {\n    const signal = new Signal({\n      name: this.nextNewSignalName(),\n      startBit,\n      size,\n      isLittleEndian\n    });\n    let { signals } = this.state;\n    signals = { ...signals };\n    signals[signal.name] = signal;\n\n    this.setState({ signals }, this.propagateUpSignalChange);\n  }\n\n  createSignalIfNotExtendingOne(dragStartBit, dragEndBit) {\n    if (this.state.dragSignal === null) {\n      // check for overlapping bits\n      for (let i = dragStartBit; i <= dragEndBit; i++) {\n        if (this.signalForBit(i) !== undefined) {\n          // Don't create signal if a signal is already defined in the selected range.\n          return;\n        }\n      }\n      const isDragAcrossSingleByte = Math.floor(dragEndBit / 8) === Math.floor(dragStartBit / 8);\n      const isDragDirectionUp = !isDragAcrossSingleByte && dragEndBit < dragStartBit;\n\n      let isLittleEndian;\n      if (isDragAcrossSingleByte || !isDragDirectionUp) {\n        isLittleEndian = dragStartBit % 8 < 4;\n      } else {\n        isLittleEndian = dragStartBit % 8 >= 4;\n      }\n      let size;\n      let startBit = dragStartBit;\n\n      if (isDragAcrossSingleByte) {\n        size = Math.abs(dragEndBit - dragStartBit) + 1;\n      } else if (isLittleEndian) {\n        if (dragEndBit > dragStartBit) {\n          startBit = dragStartBit;\n          size = dragEndBit - dragStartBit + 1;\n        } else {\n          startBit = dragEndBit;\n          size = dragStartBit - dragEndBit + 1;\n        }\n      } else {\n        if (dragEndBit < dragStartBit) {\n          startBit = dragEndBit;\n        }\n        size = Math.abs(\n          DbcUtils.bigEndianBitIndex(dragEndBit)\n              - DbcUtils.bigEndianBitIndex(dragStartBit)\n        ) + 1;\n      }\n\n      this.createSignal({ startBit, size, isLittleEndian });\n    }\n  }\n\n  onBitMouseUp(dragEndBit, signal) {\n    if (this.state.dragStartBit !== null) {\n      const { dragStartBit } = this.state;\n\n      if (dragEndBit !== dragStartBit) {\n        // one-bit signal requires double click\n        // see onBitDoubleClick\n        this.createSignalIfNotExtendingOne(dragStartBit, dragEndBit);\n      }\n      this.propagateUpSignalChange();\n      this.resetDragState();\n    }\n  }\n\n  byteValueHex(byteIdx) {\n    const { entries } = this.props.message;\n    if (this.props.messageIndex < entries.length) {\n      const entry = entries[this.props.messageIndex];\n\n      return entry.hexData.substr(byteIdx * 2, 2);\n    }\n    return '--';\n  }\n\n  bitValue(byteIdx, byteBitIdx) {\n    const { entries } = this.props.message;\n    if (this.props.messageIndex < entries.length) {\n      const entry = entries[this.props.messageIndex];\n      const data = Buffer.from(entry.hexData, 'hex');\n      if (byteIdx >= data.length) {\n        return '-';\n      }\n      const byte = data.readInt8(byteIdx);\n      return (byte >> byteBitIdx) & 1;\n    }\n    return '-';\n  }\n\n  bitIsContainedInSelection(bitIdx, isLittleEndian = false) {\n    const { dragStartBit, dragCurrentBit } = this.state;\n\n    if (isLittleEndian || dragStartBit % 8 < 4) {\n      return (\n        dragStartBit !== null\n        && dragCurrentBit !== null\n        && bitIdx >= dragStartBit\n        && bitIdx <= dragCurrentBit\n      );\n    }\n    const bigEndianStartBit = DbcUtils.bigEndianBitIndex(dragStartBit);\n    const bigEndianCurrentBit = DbcUtils.bigEndianBitIndex(dragCurrentBit);\n    const bigEndianBitIdx = DbcUtils.bigEndianBitIndex(bitIdx);\n    return (\n      dragStartBit !== null\n      && dragCurrentBit !== null\n      && bigEndianBitIdx >= bigEndianStartBit\n      && bigEndianBitIdx <= bigEndianCurrentBit\n    );\n  }\n\n  onBitDoubleClick(startBit, signal) {\n    if (signal === undefined) {\n      this.createSignal({ startBit, size: 1, isLittleEndian: false });\n    }\n  }\n\n  renderBitMatrix() {\n    const { message } = this.props;\n    const rows = [];\n    let rowCount;\n    if (message.frame && message.frame.size) {\n      rowCount = Math.floor((message.frame.size * 8) / 8);\n    } else {\n      rowCount = this.state.maxMessageBytes;\n    }\n\n    for (let i = 0; i < rowCount; i++) {\n      const rowBits = [];\n\n      rowBits.push(<td key={`rowIndex${i}`} className={css(Styles.bit, Styles.byteIndex)}>{i.toString()}</td>);\n\n      for (let j = 7; j >= 0; j--) {\n        const bitIdx = i * 8 + j;\n        const signal = this.signalForBit(bitIdx);\n        let bitStyle = null;\n        let bitSignificance = '';\n        if (signal) {\n          bitStyle = this.state.signalStyles[signal.name] || null;\n          const bitDesc = signal.bitDescription(bitIdx);\n          bitSignificance = bitDesc.isMsb ? 'msb' : bitDesc.isLsb ? 'lsb' : '';\n        } else if (this.bitIsContainedInSelection(bitIdx)) {\n          bitStyle = Styles.bitSelectedStyle;\n        }\n        const className = css('bit', Styles.bit, bitStyle);\n        const bitValue = this.bitValue(i, j);\n\n        rowBits.push(\n          <td\n            key={j.toString()}\n            className={className}\n            onMouseEnter={() => this.onBitHover(bitIdx, signal)}\n            onMouseLeave={() => this.onSignalHoverEnd(signal)}\n            onMouseDown={this.onBitMouseDown.bind(this, bitIdx, signal)}\n            onMouseUp={this.onBitMouseUp.bind(this, bitIdx, signal)}\n            onDoubleClick={this.onBitDoubleClick.bind(this, bitIdx, signal)}\n          >\n            <span>{bitValue}</span>\n            <span className={css(Styles.bitSignificance)}>\n              {bitSignificance}\n            </span>\n          </td>\n        );\n      }\n\n      rowBits.push(<td key=\"hex-repr\" className={css(Styles.bit)}><b>{this.byteValueHex(i)}</b></td>);\n      rows.push(<tr key={i.toString()}>{rowBits}</tr>);\n    }\n\n    return (\n      <div className=\"cabana-explorer-signals-matrix\" onMouseMove={this.matrixMouseMove}>\n        {this.state.highlightedSignal &&\n          <p ref={this.highlightedSignalTooltipRef} className=\"cabana-explorer-signals-matrix-tooltip\" />\n        }\n        <table cellSpacing={0} onMouseLeave={this.resetDragState}>\n          <tbody>{rows}</tbody>\n        </table>\n      </div>\n    );\n  }\n\n  resetDragState = () => {\n    this.setState({\n      dragStartBit: null,\n      dragSignal: null,\n      dragCurrentBit: null\n    });\n  };\n\n  matrixMouseMove = (ev) => {\n    if (this.state.highlightedSignal && this.highlightedSignalTooltipRef.current) {\n      const tt = this.highlightedSignalTooltipRef.current;\n      const signal = this.state.signals[this.state.highlightedSignal];\n\n      tt.innerHTML = signal.name;\n      if (ev) {\n        tt.style.left = (ev.clientX + 15) + 'px';\n        tt.style.top = (ev.clientY + 5) + 'px';\n      }\n    }\n  };\n\n  onTentativeSignalChange = (signal) => {\n    // Tentative signal changes are not propagated up\n    // but their effects are displayed in the bitmatrix\n    const { signals } = this.state;\n    signals[signal.name] = signal;\n    this.setState({ signals });\n  };\n\n  onSignalChange = (signal) => {\n    const { signals } = this.state;\n\n    if (signal.name in signals && signals[signal.name].uid !== signal.uid) {\n      return false;\n    }\n\n    for (const signalName in signals) {\n      if (signals[signalName].uid === signal.uid) {\n        delete signals[signalName];\n      }\n    }\n    signals[signal.name] = signal;\n\n    this.setState({ signals }, this.propagateUpSignalChange);\n    return true;\n  };\n\n  onSignalRemove = (signal) => {\n    const { signals } = this.state;\n    delete signals[signal.name];\n    this.setState({ signals }, this.propagateUpSignalChange);\n  };\n\n  propagateUpSignalChange() {\n    const { signals } = this.state;\n\n    this.props.onConfirmedSignalChange(\n      this.props.message,\n      this.copySignals(signals)\n    );\n  }\n\n  onSignalPlotChange = (shouldPlot, signalUid) => {\n    const { message } = this.props;\n\n    this.props.onSignalPlotChange(shouldPlot, message.id, signalUid);\n  };\n\n  render() {\n    const { selectedMessageKey } = this.props;\n    return (\n      <div className=\"cabana-explorer-signals-controller\">\n        {Object.keys(this.state.signals).length === 0 ? (\n          <p>Double click or drag to add a signal</p>\n        ) : null}\n        {this.props.message.entries[this.props.messageIndex] ? (\n          <div className=\"cabana-explorer-signals-time\">\n            <p>\n              time:\n              {' '}\n              {this.props.message.entries[\n                this.props.messageIndex\n              ].relTime.toFixed(3)}\n            </p>\n          </div>\n        ) : null}\n        {this.renderBitMatrix()}\n        <SignalLegend\n          signals={this.state.signals}\n          signalStyles={this.state.signalStyles}\n          highlightedSignal={this.state.highlightedSignal}\n          onSignalHover={this.onSignalHover}\n          onSignalHoverEnd={this.onSignalHoverEnd}\n          onTentativeSignalChange={this.onTentativeSignalChange}\n          onSignalChange={this.onSignalChange}\n          onSignalRemove={this.onSignalRemove}\n          onSignalPlotChange={this.onSignalPlotChange}\n          plottedSignalUids={this.props.plottedSignalUids}\n          selectedMessageKey={selectedMessageKey}\n        />\n      </div>\n    );\n  }\n}\n","import DbcUtils from '../../utils/dbc';\n\nconst unsignedTransformation = (field) => (value, signal) => {\n  if (value !== '') {\n    value = Number(value) || 0;\n\n    if (value < 0) {\n      value = 0;\n    }\n  }\n  signal[field] = value;\n  return signal;\n};\n\nexport default [\n  {\n    field: 'name',\n    title: 'Name',\n    type: 'string'\n  },\n  {\n    field: 'size',\n    title: 'Size',\n    type: 'number',\n    transform: unsignedTransformation('size')\n  },\n  {\n    field: 'startBit',\n    title: (signal) => (signal.isLittleEndian ? 'Least significant bit' : 'Most significant bit'),\n    type: 'number',\n    transform: unsignedTransformation('startBit')\n  },\n  {\n    field: 'isLittleEndian',\n    title: 'Endianness',\n    type: 'option',\n    options: {\n      options: ['Little', 'Big'],\n      optionValues: { Little: true, Big: false }\n    },\n    transform: (isLittleEndian, signal) => {\n      if (signal.isLittleEndian !== isLittleEndian) {\n        const { startBit } = signal;\n\n        if (isLittleEndian) {\n          // big endian -> little endian\n          const startByte = Math.floor(signal.startBit / 8);\n          const endByte = Math.floor((signal.startBit - signal.size + 1) / 8);\n\n          if (startByte === endByte) {\n            signal.startBit = signal.startBit - signal.size + 1;\n          } else {\n            signal.startBit = DbcUtils.matrixBitNumber(startBit);\n          }\n        } else {\n          // little endian -> big endian\n          const startByte = Math.floor(signal.startBit / 8);\n          const endByte = Math.floor((signal.startBit + signal.size - 1) / 8);\n\n          if (startByte === endByte) {\n            signal.startBit = signal.startBit + signal.size - 1;\n          } else {\n            signal.startBit = DbcUtils.bigEndianBitIndex(startBit);\n          }\n        }\n        signal.isLittleEndian = isLittleEndian;\n      }\n      return signal;\n    }\n  },\n  {\n    field: 'isSigned',\n    title: 'Sign',\n    type: 'option',\n    options: {\n      options: ['Signed', 'Unsigned'],\n      optionValues: { Signed: true, Unsigned: false }\n    }\n  },\n  {\n    field: 'factor',\n    title: 'Factor',\n    type: 'number'\n  },\n  {\n    field: 'offset',\n    title: 'Offset',\n    type: 'number'\n  },\n  {\n    field: 'unit',\n    title: 'Unit',\n    type: 'string'\n  },\n  {\n    field: 'comment',\n    title: 'Comment',\n    type: 'string'\n  },\n  {\n    field: 'min',\n    title: 'Minimum value',\n    type: 'number'\n  },\n  {\n    field: 'max',\n    title: 'Maximum value',\n    type: 'number'\n  },\n  {\n    field: 'valueDescriptions',\n    title: 'Value descriptions',\n    type: 'map'\n  }\n];\n","import React, { Component } from 'react';\n\nexport default class Field extends Component {\n  render() {\n    const { title, htmlFor, children, valid } = this.props;\n    const errorCls = valid === false ? ' form-field-error' : '';\n    return (\n      <div className={ `form-field form-field--small${errorCls}` }>\n        <label htmlFor={htmlFor}>{title}</label>\n        {children}\n      </div>\n    );\n  }\n}\n","import React from 'react';\nimport Field from './Field';\n\nimport { swapKeysAndValues } from '../../utils/object';\n\nexport default ({\n  fieldSpec,\n  signal,\n  isExpanded,\n  signalEdited,\n  updateField,\n  valid\n}) => {\n  let valueCol;\n  const { field, title } = fieldSpec;\n  const htmlFor = `${signal.name}_${field}`;\n  const { options, optionValues } = fieldSpec.options;\n  const valueOptions = swapKeysAndValues(optionValues);\n\n  if (isExpanded) {\n    const optionEles = options.map((opt) => (\n      <option key={opt} value={optionValues[opt]}>\n        {opt}\n      </option>\n    ));\n    valueCol = (\n      <select\n        id={htmlFor}\n        defaultValue={signalEdited}\n        onChange={(e) => {\n          updateField(fieldSpec, e.target.value === 'true');\n        }}\n      >\n        {optionEles}\n      </select>\n    );\n  } else {\n    valueCol = <span>{valueOptions[signal[field]]}</span>;\n  }\n\n  return (\n    <Field\n      title={typeof title === 'function' ? title(signal) : title}\n      htmlFor={htmlFor}\n      valid={valid}\n    >\n      {valueCol}\n    </Field>\n  );\n};\n","import React from 'react';\n\nimport FIELDS from './FIELDS';\nimport NumberField from './NumberField';\nimport StringField from './StringField';\nimport OptionField from './OptionField';\nimport MapField from './MapField';\n\nconst FieldMap = {\n  number: NumberField,\n  option: OptionField,\n  string: StringField,\n  map: MapField,\n};\n\nexport default ({\n  signal,\n  onSignalRemove,\n  isExpanded,\n  getSignalEdited,\n  fieldError,\n  update\n}) => (\n  <div className=\"signals-legend-entry-form\">\n    {FIELDS.map((field) => {\n      const Node = FieldMap[field.type];\n      const valid = fieldError !== field.field;\n      return (\n        <div className=\"signals-legend-entry-form-field\" key={field.field}>\n          <Node\n            fieldSpec={field}\n            signal={signal}\n            isExpanded={isExpanded}\n            signalEdited={getSignalEdited(field.field)}\n            updateField={update}\n            valid={valid}\n          />\n        </div>\n      );\n    })}\n    <div className=\"signals-legend-entry-form-remove\">\n      <button\n        className=\"button--tiny button--alpha\"\n        onClick={() => onSignalRemove(signal)}\n      >\n        Remove Signal\n      </button>\n    </div>\n  </div>\n);\n","import React from 'react';\nimport Field from './Field';\n\nexport default ({\n  fieldSpec,\n  signal,\n  isExpanded,\n  signalEdited,\n  updateField,\n  valid\n}) => {\n  const { field, title } = fieldSpec;\n  const htmlFor = `${signal.name}_${field}`;\n  let valueCol;\n\n  if (isExpanded) {\n    let value = signalEdited;\n    if (value !== '') {\n      const num = Number(value);\n      value = isNaN(num) ? '' : num;\n    }\n    valueCol = (\n      <input\n        id={htmlFor}\n        type=\"number\"\n        value={value}\n        onChange={(e) => {\n          updateField(fieldSpec, e.target.value);\n        }}\n      />\n    );\n  } else {\n    const value = signal[field];\n    valueCol = <span>{value}</span>;\n  }\n  return (\n    <Field\n      title={typeof title === 'function' ? title(signal) : title}\n      htmlFor={htmlFor}\n      valid={valid}\n    >\n      {valueCol}\n    </Field>\n  );\n};\n","export function swapKeysAndValues(obj, f) {\n  return Object.keys(obj).reduce((acc, k) => {\n    acc[obj[k]] = k;\n    return acc;\n  }, {});\n}\n\nexport function fromArray(arr) {\n  // arr is an array of array key-value pairs\n  // like [['a', 1], ['b', 2]]\n\n  const pairs = arr.map(([k, v]) => ({ [k]: v }));\n  if (pairs.length > 0) {\n    return Object.assign(...pairs);\n  }\n  return {};\n}\n","import React from 'react';\nimport Field from './Field';\n\nexport default ({\n  fieldSpec,\n  signal,\n  isExpanded,\n  signalEdited,\n  updateField,\n  valid\n}) => {\n  const { field, title } = fieldSpec;\n  const htmlFor = `${signal.name}_${field}`;\n  let valueCol;\n  if (isExpanded) {\n    valueCol = (\n      <input\n        id={htmlFor}\n        type=\"text\"\n        value={signalEdited || ''}\n        onChange={(e) => {\n          updateField(fieldSpec, e.target.value);\n        }}\n      />\n    );\n  } else {\n    valueCol = <span>{signal[field]}</span>;\n  }\n\n  return (\n    <Field\n      title={typeof title === 'function' ? title(signal) : title}\n      htmlFor={htmlFor}\n      valid={valid}\n    >\n      {valueCol}\n    </Field>\n  );\n};\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport Field from './Field';\n\nexport default class MapField extends Component {\n  static propTypes = {\n    fieldSpec: PropTypes.any,\n    signal: PropTypes.any,\n    isExpanded: PropTypes.any,\n    signalEdited: PropTypes.any,\n    updateField: PropTypes.any,\n    valid: PropTypes.any,\n  };\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      valid: true,\n      mapString: '',\n    };\n\n    this.onChange = this.onChange.bind(this);\n  }\n\n  componentDidMount() {\n    this.componentDidUpdate({}, {});\n  }\n\n  componentDidUpdate(prevProps) {\n    if (prevProps.isExpanded !== this.props.isExpanded) {\n      const entryPairs = Array.from(this.props.signalEdited.entries());\n      const mapString = entryPairs.reduce((str, [value, desc]) => `${str + value} \"${desc}\" `, '').trim();\n      this.setState({ mapString });\n    }\n  }\n\n  onChange(ev) {\n    const mapString = ev.target.value;\n    this.setState({ mapString });\n\n    if ((mapString.split('\"').length - 1) % 2 !== 0) {\n      this.setState({ valid: false });\n      return;\n    }\n    let splitted = Array.from(mapString.matchAll(/[^\\s\"]+|\"([^\"]*)\"/g));\n    if (splitted.length % 2 !== 0) {\n      this.setState({ valid: false });\n      return;\n    }\n\n    splitted = splitted.map(([match, group]) => group || match);\n    const res = new Map();\n    for (let i = 0; i < splitted.length; i += 2) {\n      res.set(splitted[i], splitted[i+1]);\n    }\n\n    this.setState({ valid: true });\n    this.props.updateField(this.props.fieldSpec, res);\n  }\n\n  render() {\n    const { fieldSpec, signal, isExpanded } = this.props;\n\n    const htmlFor = `${signal.name}_${fieldSpec.field}`;\n    let valueCol;\n\n    if (isExpanded) {\n      valueCol = <input id={htmlFor} type=\"text\" value={this.state.mapString} onChange={this.onChange} />;\n    } else {\n      valueCol = <span>{signal[fieldSpec.field]}</span>;\n    }\n\n    return (\n      <Field title={typeof fieldSpec.title === 'function' ? fieldSpec.title(signal) : fieldSpec.title}\n        htmlFor={htmlFor} valid={this.props.valid && this.state.valid}>\n        {valueCol}\n      </Field>\n    );\n  }\n}\n","// SignalLegendEntry.js\n\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport cx from 'classnames';\n\nimport Signal from '../../models/can/signal';\nimport SignalForm from './SignalForm';\nimport FIELDS from './FIELDS';\n\nexport default class SignalLegendEntry extends Component {\n  static propTypes = {\n    signal: PropTypes.instanceOf(Signal).isRequired,\n    isHighlighted: PropTypes.bool,\n    onSignalHover: PropTypes.func,\n    onSignalHoverEnd: PropTypes.func,\n    onTentativeSignalChange: PropTypes.func,\n    onSignalChange: PropTypes.func,\n    onSignalRemove: PropTypes.func,\n    onSignalPlotChange: PropTypes.func,\n    toggleExpandSignal: PropTypes.func,\n    isPlotted: PropTypes.bool,\n    isExpanded: PropTypes.bool\n  };\n\n  static fieldSpecForName = (name) => FIELDS.find((field) => field.field === name);\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      fieldError: null,\n      signalEdited: Object.assign(Object.create(props.signal), props.signal)\n    };\n  }\n\n  componentDidUpdate(prevProps) {\n    if (!this.props.signal.equals(prevProps.signal)) {\n      this.setState({\n        fieldError: null,\n        signalEdited: Object.assign(\n          Object.create(this.props.signal),\n          this.props.signal\n        )\n      });\n    }\n  }\n\n  updateField = (fieldSpec, value) => {\n    let { signalEdited } = this.state;\n    const { signal } = this.props;\n\n    if (fieldSpec.transform) {\n      signalEdited = fieldSpec.transform(value, signalEdited);\n    } else {\n      signalEdited[fieldSpec.field] = value;\n    }\n\n    // Save entire signal while editing\n    this.setState({ signalEdited });\n    const signalCopy = Object.assign(Object.create(signal), signal);\n    Object.entries(signalEdited).forEach(([field, value]) => {\n      signalCopy[field] = value;\n    });\n\n    const updated = this.props.onSignalChange(signalCopy);\n    this.setState({ fieldError: !updated ? fieldSpec.field : null });\n  };\n\n  toggleEditing = (e) => {\n    let { signalEdited } = this.state;\n    const { signal, isExpanded } = this.props;\n    const signalCopy = Object.assign(Object.create(signal), signal);\n\n    if (isExpanded) {\n      // Finished editing, save changes & reset intermediate\n      // signalEdited state.\n      Object.entries(signalEdited).forEach(([field, value]) => {\n        const fieldSpec = SignalLegendEntry.fieldSpecForName(field);\n\n        if (\n          fieldSpec\n          && fieldSpec.type === 'number'\n          && isNaN(parseInt(value, 10))\n        ) {\n          value = 0;\n        }\n\n        signalCopy[field] = value;\n      });\n      this.props.onSignalChange(signalCopy);\n    } else {\n      signalEdited = signalCopy;\n    }\n\n    // Expand and enable signal editing\n    this.setState({\n      fieldError: null,\n      signalEdited,\n    });\n    this.props.toggleExpandSignal(signal);\n    e.stopPropagation();\n  };\n\n  toggleSignalPlot = (e) => {\n    const { signal, isPlotted } = this.props;\n    e.preventDefault();\n    this.props.onSignalPlotChange(!isPlotted, signal.uid);\n  };\n\n  getSignalEdited = (field) => this.state.signalEdited[field];\n\n  render() {\n    const {\n      signal, isHighlighted, color, isPlotted, isExpanded\n    } = this.props;\n    const expandedEntryClass = isExpanded ? 'is-expanded' : null;\n    const plottedButtonClass = isPlotted ? 'button' : 'button--alpha';\n    const colorBarStyle = {\n      opacity: isHighlighted ? 0.5 : 0.3,\n      backgroundColor: color ? `rgb(${color.join(',')})` : null,\n    };\n    return (\n      <div\n        className={cx('signals-legend-entry', expandedEntryClass)}\n        onMouseEnter={() => this.props.onSignalHover(signal)}\n        onMouseLeave={() => this.props.onSignalHoverEnd(signal)}\n      >\n        <div className=\"signals-legend-entry-colorbar\" style={ colorBarStyle } />\n        <div className=\"signals-legend-entry-header\">\n          <div\n            className=\"signals-legend-entry-header-name\"\n            onClick={this.toggleEditing}\n          >\n            <strong>{signal.name}</strong>\n          </div>\n          <div\n            className=\"signals-legend-entry-header-action\"\n            onClick={this.toggleSignalPlot}\n          >\n            <button className={cx('button--tiny', plottedButtonClass)}>\n              {isPlotted ? 'Hide Plot' : 'Show Plot'}\n            </button>\n          </div>\n        </div>\n        <div className=\"signals-legend-entry-body\">\n          {isExpanded && (\n            <SignalForm\n              signal={signal}\n              onSignalRemove={this.props.onSignalRemove}\n              isExpanded={isExpanded}\n              getSignalEdited={this.getSignalEdited}\n              fieldError={this.state.fieldError}\n              update={this.updateField}\n            />\n          )}\n        </div>\n      </div>\n    );\n  }\n}\n","// SignalLegend.js\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\n\nimport SignalLegendEntry from './SignalLegendEntry';\n\nexport default class SignalLegend extends Component {\n  static propTypes = {\n    signals: PropTypes.object,\n    signalStyles: PropTypes.object,\n    highlightedSignal: PropTypes.string,\n    onSignalHover: PropTypes.func,\n    onSignalHoverEnd: PropTypes.func,\n    onTentativeSignalChange: PropTypes.func,\n    onSignalChange: PropTypes.func,\n    onSignalRemove: PropTypes.func,\n    onSignalPlotChange: PropTypes.func,\n    plottedSignalUids: PropTypes.array,\n    selectedMessageKey: PropTypes.string\n  };\n\n  state = {\n    expandedSignals: []\n  };\n\n  toggleExpandSignal = (s) => {\n    const { expandedSignals } = this.state;\n    if (!expandedSignals.includes(s.uid)) {\n      const updatedExpandedSignals = [...expandedSignals, s.uid];\n      this.setState({ expandedSignals: updatedExpandedSignals });\n    } else {\n      const updatedExpandedSignals = expandedSignals.filter((i) => i !== s.uid);\n      this.setState({ expandedSignals: updatedExpandedSignals });\n    }\n  };\n\n  checkExpandedSignal(s) {\n    return this.state.expandedSignals.includes(s);\n  }\n\n  render() {\n    const { signals, highlightedSignal, selectedMessageKey } = this.props;\n    const signalRowsNested = Object.entries(signals)\n      .sort(([_, signal1], [__, signal2]) => {\n        if (signal1.startBit < signal2.startBit) {\n          return -1;\n        }\n        return 1;\n      })\n      .map(([signalName, signal]) => {\n        const colors = signals[signalName].getColors(selectedMessageKey);\n        const isHighlighted = highlightedSignal === signalName;\n\n        return (\n          <SignalLegendEntry\n            key={signal.uid}\n            signal={signal}\n            isHighlighted={isHighlighted}\n            color={colors}\n            onSignalHover={this.props.onSignalHover}\n            onSignalHoverEnd={this.props.onSignalHoverEnd}\n            onTentativeSignalChange={this.props.onTentativeSignalChange}\n            onSignalChange={this.props.onSignalChange}\n            onSignalRemove={this.props.onSignalRemove}\n            onSignalPlotChange={this.props.onSignalPlotChange}\n            toggleExpandSignal={this.toggleExpandSignal}\n            isPlotted={this.props.plottedSignalUids.indexOf(signal.uid) !== -1}\n            isExpanded={this.checkExpandedSignal(signal.uid)}\n          />\n        );\n      });\n\n    const signalRows = signalRowsNested\n      .filter((row) => row != null)\n      .reduce((a, b) => a.concat(b), []);\n\n    return <div className=\"cabana-explorer-signals-legend\">{signalRows}</div>;\n  }\n}\n","module.exports = __webpack_public_path__ + \"static/media/webusb-enable-experimental-features.e5a08e76.png\";","module.exports = __webpack_public_path__ + \"static/media/webusb-enable-webusb.aceef6a0.png\";","module.exports = function() {\n  return new Worker(__webpack_public_path__ + \"cc0b0d28fa183afa289a.worker.js\");\n};","module.exports = function() {\n  return new Worker(__webpack_public_path__ + \"6e307d3c0861c64b8219.worker.js\");\n};","module.exports = function() {\n  return new Worker(__webpack_public_path__ + \"3d99c06516e86031771d.worker.js\");\n};","module.exports = function() {\n  return new Worker(__webpack_public_path__ + \"2e0400b7acb35a5a97a9.worker.js\");\n};","import { GITHUB_CLIENT_ID, GITHUB_REDIRECT_URL } from '../config';\nimport { objToQuery } from '../utils/url';\n\nexport function authorizeUrl(route) {\n  const params = {\n    client_id: GITHUB_CLIENT_ID,\n    redirect_uri: GITHUB_REDIRECT_URL,\n    scope: 'user:email public_repo',\n    state: JSON.stringify({ route })\n  };\n\n  return `http://github.com/login/oauth/authorize?${objToQuery(params)}`;\n}\n","export default class Frame {\n  constructor({\n    name,\n    id = 0,\n    size = 0,\n    transmitters = [],\n    extended = 0,\n    comment = null,\n    signals = {}\n  }) {\n    Object.assign(this, {\n      name,\n      id,\n      size,\n      transmitters,\n      extended,\n      comment,\n      signals\n    });\n  }\n\n  nextNewTransmitterName() {\n    let txNum = 1;\n    let txName;\n    do {\n      txName = `NEW_TRANSMITTER_${txNum}`;\n      txNum++;\n    } while (this.transmitters.indexOf(txName) !== -1);\n\n    return txName;\n  }\n\n  addTransmitter() {\n    const txName = this.nextNewTransmitterName();\n    this.transmitters.push(txName);\n    return txName;\n  }\n\n  header() {\n    return (\n      `BO_ ${this.id} ${this.name}: ${this.size} `\n      + `${this.transmitters[0] || 'XXX'}`\n    );\n  }\n\n  text() {\n    const signals = Object.values(this.signals)\n      .map((signal) => ` ${signal.text()}`) // indent\n      .join('\\n');\n\n    if (signals.length > 0) {\n      return `${this.header()}\\n${signals}`;\n    }\n    return this.header();\n  }\n\n  copy() {\n    const copy = Object.assign(Object.create(this), this);\n\n    return copy;\n  }\n}\n","export default class BoardUnit {\n  constructor(name) {\n    this.name = name;\n    this.attributes = {};\n    this.comment = null;\n  }\n\n  text() {\n    return this.name;\n  }\n}\n","import CloudLog from '../../logging/CloudLog';\nimport Signal from './signal';\nimport Frame from './frame';\nimport BoardUnit from './BoardUnit';\nimport DbcUtils from '../../utils/dbc';\n\nconst DBC_COMMENT_RE = /^CM_ *\"(.*)\";/;\nconst DBC_COMMENT_MULTI_LINE_RE = /^CM_ *\"(.*)/;\n\nconst MSG_RE = /^BO_ (\\w+) (\\w+) *: (\\w+) (\\w+)/;\n\nconst SIGNAL_RE = /^SG_ (\\w+) : (\\d+)\\|(\\d+)@(\\d+)([+|-]) \\(([0-9.+-eE]+),([0-9.+-eE]+)\\) \\[([0-9.+-eE]+)\\|([0-9.+-eE]+)\\] \"(.*)\" (.*)/;\n// Multiplexed signal\nconst MP_SIGNAL_RE = /^SG_ (\\w+) (\\w+) *: (\\d+)\\|(\\d+)@(\\d+)([+|-]) \\(([0-9.+-eE]+),([0-9.+-eE]+)\\) \\[([0-9.+-eE]+)\\|([0-9.+-eE]+)\\] \"(.*)\" (.*)/;\n\nconst VAL_RE = /^VAL_ (\\w+) (\\w+) (.*);/;\nconst VAL_TABLE_RE = /^VAL_TABLE_ (\\w+) (.*);/;\n\nconst MSG_TRANSMITTER_RE = /^BO_TX_BU_ ([0-9]+) *: *(.+);/;\n\nconst SIGNAL_COMMENT_RE = /^CM_ SG_ *(\\w+) *(\\w+) *\"(.*)\";/;\nconst SIGNAL_COMMENT_MULTI_LINE_RE = /^CM_ SG_ *(\\w+) *(\\w+) *\"(.*)/;\n\n// Message Comments (CM_ BO_ )\nconst MESSAGE_COMMENT_RE = /^CM_ BO_ *(\\w+) *\"(.*)\";/;\nconst MESSAGE_COMMENT_MULTI_LINE_RE = /^CM_ BO_ *(\\w+) *\"(.*)/;\n\nconst BOARD_UNIT_RE = /^BU_:(.*)/;\nconst BOARD_UNIT_COMMENT_RE = /^CM_ BU_ *(\\w+) *\"(.*)\";/;\nconst BOARD_UNIT_COMMENT_MULTI_LINE_RE = /^CM_ BU_ *(\\w+) *\"(.*)/;\n\n// Follow ups are used to parse multi-line comment definitions\nconst FOLLOW_UP_DBC_COMMENT = 'FollowUpDbcComment';\nconst FOLLOW_UP_SIGNAL_COMMENT = 'FollowUpSignalComment';\nconst FOLLOW_UP_MSG_COMMENT = 'FollowUpMsgComment';\nconst FOLLOW_UP_BOARD_UNIT_COMMENT = 'FollowUpBoardUnitComment';\n\n/* global BigInt */\n\nfunction floatOrInt(numericStr) {\n  if (Number.isInteger(numericStr)) {\n    return parseInt(numericStr, 10);\n  }\n  return parseFloat(numericStr);\n}\n\nexport function swapOrder(arr, wordSize, gSize) {\n  const swappedWords = [];\n\n  for (let i = 0; i < arr.length; i += wordSize) {\n    const word = arr.slice(i, i + wordSize);\n    for (let j = wordSize - gSize; j > -gSize; j -= gSize) {\n      swappedWords.push(word.slice(j, j + gSize));\n    }\n  }\n\n  return swappedWords.join('');\n}\n\nexport default class DBC {\n  constructor(dbcString) {\n    this.boardUnits = [];\n    this.comments = [];\n    this.messages = new Map();\n\n    if (dbcString !== undefined) {\n      this.dbcText = dbcString;\n      this.importDbcString(dbcString);\n    }\n  }\n\n  getMessageFrame(address) {\n    return this.messages.get(address);\n  }\n\n  nextNewFrameName() {\n    const messageNames = [];\n\n    for (const msg of this.messages.values()) {\n      messageNames.push(msg.name);\n    }\n\n    let msgNum = 1;\n    let msgName;\n    do {\n      msgName = `NEW_MSG_${msgNum}`;\n      msgNum++;\n    } while (messageNames.indexOf(msgName) !== -1);\n\n    return msgName;\n  }\n\n  updateBoardUnits() {\n    const boardUnitNames = this.boardUnits.map((bu) => bu.name);\n    const missingBoardUnits = Array.from(this.messages.entries())\n      .map(([msgId, frame]) => Object.values(frame.signals))\n      .reduce((arr, signals) => arr.concat(signals), [])\n      .map((signal) => signal.receiver)\n      .reduce((arr, receivers) => arr.concat(receivers), [])\n      .filter((recv, idx, array) => array.indexOf(recv) === idx)\n      .filter((recv) => boardUnitNames.indexOf(recv) === -1)\n      .map((recv) => new BoardUnit(recv));\n\n    this.boardUnits = this.boardUnits.concat(missingBoardUnits);\n  }\n\n  text() {\n    this.updateBoardUnits();\n\n    let txt = 'VERSION \"\"\\n\\n\\n';\n    txt += `NS_ :${this._newSymbols()}`;\n    txt += '\\n\\nBS_:\\n';\n\n    const boardUnitsText = this.boardUnits.map((bu) => bu.text()).join(' ');\n    txt += `\\nBU_: ${boardUnitsText}\\n\\n\\n`;\n\n    const frames = [];\n    for (const frame of this.messages.values()) {\n      frames.push(frame);\n    }\n    txt += `${frames.map((f) => f.text()).join('\\n\\n')}\\n\\n`;\n\n    const messageTxs = frames\n      .map((f) => [f.id, f.transmitters.slice(1)])\n      .filter(([addr, txs]) => txs.length > 0);\n    txt += `${messageTxs\n      .map(([addr, txs]) => `BO_TX_BU_ ${addr} : ${txs.join(',')};`)\n      .join('\\n')}\\n\\n\\n`;\n\n    txt += this.boardUnits\n      .filter((bu) => bu.comment !== null)\n      .map((bu) => `CM_ BU_ ${bu.name} \"${bu.comment}\";`)\n      .join('\\n');\n\n    txt += frames\n      .filter((f) => f.comment !== null)\n      .map((msg) => `CM_ BO_ ${msg.address} \"${msg.comment}\";`)\n      .join('\\n');\n\n    const signalsByMsgId = frames\n      .map((f) => Object.values(f.signals).map((sig) => [f.id, sig]))\n      .reduce((s1, s2) => s1.concat(s2), []);\n\n    txt += `${signalsByMsgId\n      .filter(([msgAddr, sig]) => sig.comment !== null)\n      .map(\n        ([msgAddr, sig]) => `CM_ SG_ ${msgAddr} ${sig.name} \"${sig.comment}\";`\n      )\n      .join('\\n')}\\n`;\n\n    txt += `${signalsByMsgId\n      .filter(([msgAddr, sig]) => sig.valueDescriptions.size > 0)\n      .map(([msgAddr, sig]) => sig.valueDescriptionText(msgAddr))\n      .join('\\n')}\\n`;\n\n    txt += this.comments.map((comment) => `CM_ \"${comment}\";`).join('\\n');\n\n    return `${txt.trim()}\\n`;\n  }\n\n  getMessageName(msgId) {\n    const msg = this.getMessageFrame(msgId);\n    if (msg && msg.frame) return msg.frame.name;\n    return null;\n  }\n\n  getSignals(msgId) {\n    const msg = this.getMessageFrame(msgId);\n    if (msg) return msg.signals;\n    return {};\n  }\n\n  createFrame(msgId, size=64) {\n    const msg = new Frame({\n      name: this.nextNewFrameName(),\n      id: msgId,\n      size: size,\n    });\n\n    this.messages.set(msgId, msg);\n    return msg;\n  }\n\n  setSignals(msgId, signals, frameSize) {\n    const msg = this.getMessageFrame(msgId); // TODO conform frameSize\n    if (msg) {\n      const newMsg = Object.assign(Object.create(msg), msg);\n      newMsg.signals = signals;\n      this.messages.set(msgId, newMsg);\n    } else {\n      const msg = this.createFrame(msgId, frameSize);\n      msg.signals = signals;\n\n      this.messages.set(msgId, msg);\n      this.updateBoardUnits();\n    }\n  }\n\n  addSignal(msgId, signal) {\n    const msg = this.getMessageFrame(msgId);\n\n    if (msg) {\n      msg.signals[signal.name] = signal;\n      this.updateBoardUnits();\n    }\n  }\n\n  importDbcString(dbcString) {\n    const warnings = [];\n    const messages = new Map();\n    let boardUnits = [];\n    const valueTables = new Map();\n    let id = 0;\n    let followUp = null;\n\n    const lines = dbcString.split('\\n');\n    for (let i = 0; i < lines.length; i++) {\n      let line = lines[i].trim();\n\n      if (line.length === 0) continue;\n\n      if (followUp != null) {\n        const { type, data } = followUp;\n        line = line.replace(/\" *;/, '');\n        let followUpLine = `\\n${line.substr(0, line.length)}`;\n        if (line.indexOf('\"') !== -1) {\n          followUp = null;\n          followUpLine = followUpLine.substr(0, followUpLine.length - 1);\n        }\n        if (type === FOLLOW_UP_SIGNAL_COMMENT) {\n          const signal = data;\n          signal.comment += followUpLine;\n        } else if (type === FOLLOW_UP_MSG_COMMENT) {\n          const msg = data;\n          msg.comment += followUpLine;\n        } else if (type === FOLLOW_UP_BOARD_UNIT_COMMENT) {\n          const boardUnit = data;\n          boardUnit.comment += followUpLine;\n        } else if (type === FOLLOW_UP_DBC_COMMENT) {\n          //          const comment = data;\n          const partialComment = this.comments[this.comments.length - 1];\n          this.comments[this.comments.length - 1] = partialComment + followUpLine;\n        }\n      }\n\n      if (line.indexOf('BO_ ') === 0) {\n        const matches = line.match(MSG_RE);\n        if (matches === null) {\n          warnings.push(\n            `failed to parse message definition on line ${i + 1} -- ${line}`\n          );\n          continue;\n        }\n        let [idString, name, size, transmitter] = matches.slice(1);\n        id = parseInt(idString, 0); // 0 radix parses hex or dec\n        size = parseInt(size, 10);\n        const frame = new Frame({\n          name,\n          id,\n          size,\n          transmitters: [transmitter]\n        });\n        messages.set(id, frame);\n      } else if (line.indexOf('SG_') === 0) {\n        let matches = line.match(SIGNAL_RE);\n\n        if (matches === null) {\n          matches = line.match(MP_SIGNAL_RE);\n          if (matches === null) {\n            warnings.push(\n              `failed to parse signal definition on line ${i + 1} -- ${line}`\n            );\n            continue;\n          }\n          // for now, ignore multiplex which is matches[1]\n          matches = matches[1] + matches.slice(3);\n        } else {\n          matches = matches.slice(1);\n        }\n\n        let [\n          name,\n          startBit,\n          size,\n          isLittleEndian,\n          isSigned,\n          factor,\n          offset,\n          min,\n          max,\n          unit,\n          receiverStr\n        ] = matches;\n        startBit = parseInt(startBit, 10);\n        size = parseInt(size, 10);\n        isLittleEndian = parseInt(isLittleEndian, 10) === 1;\n        isSigned = isSigned === '-';\n        factor = floatOrInt(factor);\n        offset = floatOrInt(offset);\n        min = floatOrInt(min);\n        max = floatOrInt(max);\n        const receiver = receiverStr.split(',').map((s) => s.trim());\n\n        const signalProperties = {\n          name,\n          startBit,\n          size,\n          isLittleEndian,\n          isSigned,\n          factor,\n          offset,\n          unit,\n          min,\n          max,\n          receiver\n        };\n        const signal = new Signal(signalProperties);\n\n        if (messages.get(id) !== undefined) {\n          messages.get(id).signals[name] = signal;\n        } else {\n          CloudLog.warn(\n            `importDbcString: could not add signal: ${name} due to missing message: ${id}`\n          );\n        }\n      } else if (line.indexOf('VAL_ ') === 0) {\n        const matches = line.match(VAL_RE);\n\n        if (matches !== null) {\n          let [messageId, signalName, vals] = matches.slice(1);\n          vals = vals\n            .split('\"')\n            .map((s) => s.trim())\n            .filter((s) => s.length > 0);\n\n          messageId = parseInt(messageId, 10);\n          const msg = messages.get(messageId);\n          const signal = msg.signals[signalName];\n          if (signal === undefined) {\n            warnings.push(\n              `could not find signal for value description on line ${i\n                + 1} -- ${line}`\n            );\n            continue;\n          }\n          for (let i = 0; i < vals.length; i += 2) {\n            const value = vals[i].trim();\n            const description = vals[i + 1].trim();\n            signal.valueDescriptions.set(value, description);\n          }\n        } else {\n          warnings.push(\n            `failed to parse value description on line ${i + 1} -- ${line}`\n          );\n        }\n      } else if (line.indexOf('VAL_TABLE_ ') === 0) {\n        const matches = line.match(VAL_TABLE_RE);\n\n        if (matches !== null) {\n          const table = new Map();\n          let [tableName, items] = matches.slice(1);\n          items = items\n            .split('\"')\n            .map((s) => s.trim())\n            .filter((s) => s.length > 0);\n\n          for (let i = 0; i < items.length; i += 2) {\n            const key = items[i];\n            const value = items[i + 1];\n            table.set(key, value);\n          }\n          valueTables.set(tableName, table);\n        } else {\n          warnings.push(\n            `failed to parse value table on line ${i + 1} -- ${line}`\n          );\n        }\n      } else if (line.indexOf('BO_TX_BU_ ') === 0) {\n        const matches = line.match(MSG_TRANSMITTER_RE);\n\n        if (matches !== null) {\n          let [messageId, transmitter] = matches.slice(1);\n          messageId = parseInt(messageId, 10);\n\n          const msg = messages.get(messageId);\n          msg.transmitters.push(transmitter);\n          messages.set(messageId, msg);\n        } else {\n          warnings.push(\n            `failed to parse message transmitter definition on line ${i\n              + 1} -- ${line}`\n          );\n        }\n      } else if (line.indexOf('CM_ SG_ ') === 0) {\n        let matches = line.match(SIGNAL_COMMENT_RE);\n        let hasFollowUp = false;\n        if (matches === null) {\n          matches = line.match(SIGNAL_COMMENT_MULTI_LINE_RE);\n          hasFollowUp = true;\n        }\n        if (matches === null) {\n          warnings.push(\n            `failed to parse signal comment on line ${i + 1} -- ${line}`\n          );\n          continue;\n        }\n\n        let [messageId, signalName, comment] = matches.slice(1);\n\n        messageId = parseInt(messageId, 10);\n        const msg = messages.get(messageId);\n        if (msg === undefined) {\n          warnings.push(`failed to parse signal comment on line ${i\n            + 1} -- ${line}:\n                                    message id ${messageId} does not exist prior to this line`);\n          continue;\n        }\n        const signal = msg.signals[signalName];\n        if (signal === undefined) {\n          warnings.push(\n            `failed to parse signal comment on line ${i + 1} -- ${line}`\n          );\n          continue;\n        } else {\n          signal.comment = comment;\n          messages.set(messageId, msg);\n        }\n\n        if (hasFollowUp) {\n          followUp = { type: FOLLOW_UP_SIGNAL_COMMENT, data: signal };\n        }\n      } else if (line.indexOf('CM_ BO_ ') === 0) {\n        let matches = line.match(MESSAGE_COMMENT_RE);\n        let hasFollowUp = false;\n        if (matches === null) {\n          matches = line.match(MESSAGE_COMMENT_MULTI_LINE_RE);\n          hasFollowUp = true;\n          if (matches === null) {\n            warnings.push(\n              `failed to message comment on line ${i + 1} -- ${line}`\n            );\n            continue;\n          }\n        }\n\n        let [messageId, comment] = matches.slice(1);\n        messageId = parseInt(messageId, 10);\n        const msg = messages.get(messageId);\n        if (msg === undefined) {\n          warnings.push(\n            `failed to find message to add comment to, msg id: ${messageId}`\n          );\n          continue;\n        }\n        msg.comment = comment;\n\n        if (hasFollowUp) {\n          followUp = { type: FOLLOW_UP_MSG_COMMENT, data: msg };\n        }\n      } else if (line.indexOf('BU_: ') === 0) {\n        const matches = line.match(BOARD_UNIT_RE);\n\n        if (matches !== null) {\n          const [boardUnitNameStr] = matches.slice(1);\n          const newBoardUnits = boardUnitNameStr\n            .split(' ')\n            .map((s) => s.trim())\n            .filter((s) => s.length > 0)\n            .map((name) => new BoardUnit(name));\n\n          boardUnits = boardUnits.concat(newBoardUnits);\n        } else {\n          warnings.push(\n            `failed to parse board unit definition on line ${i + 1} -- ${line}`\n          );\n          continue;\n        }\n      } else if (line.indexOf('CM_ BU_ ') === 0) {\n        let matches = line.match(BOARD_UNIT_COMMENT_RE);\n        let hasFollowUp = false;\n        if (matches === null) {\n          matches = line.match(BOARD_UNIT_COMMENT_MULTI_LINE_RE);\n          hasFollowUp = true;\n          if (matches === null) {\n            warnings.push(\n              `failed to parse board unit comment on line ${i + 1} -- ${line}`\n            );\n            continue;\n          }\n        }\n\n        const [boardUnitName, comment] = matches.slice(1);\n        const boardUnit = boardUnits.find((bu) => bu.name === boardUnitName);\n        if (boardUnit) {\n          boardUnit.comment = comment;\n        }\n\n        if (hasFollowUp) {\n          followUp = { type: FOLLOW_UP_BOARD_UNIT_COMMENT, data: boardUnit };\n        }\n      } else if (line.indexOf('CM_ ') === 0) {\n        let matches = line.match(DBC_COMMENT_RE);\n        let hasFollowUp = false;\n        if (matches === null) {\n          matches = line.match(DBC_COMMENT_MULTI_LINE_RE);\n          if (matches === null) {\n            warnings.push(\n              `failed to parse dbc comment on line ${i + 1} -- ${line}`\n            );\n            continue;\n          } else {\n            hasFollowUp = true;\n          }\n        }\n\n        const [comment] = matches.slice(1);\n        this.comments.push(comment);\n        if (hasFollowUp) {\n          followUp = { type: FOLLOW_UP_DBC_COMMENT, data: comment };\n        }\n      }\n    }\n\n    // Disabled b/c live mode frequently calls this function\n    // and executes way too many network requests\n    if (warnings.length > 0) {\n      // warnings.forEach((warning) => CloudLog.warn('importDbcString: ' + warning));\n      // warnings.forEach((warning) => console.log('importDbcString: ' + warning));\n    }\n\n    this.messages = messages;\n    this.boardUnits = boardUnits;\n    this.valueTables = valueTables;\n  }\n\n  valueForIntSignal(signalSpec, view) {\n    let sig_lsb, sig_msb;\n    if (signalSpec.isLittleEndian) {\n      sig_lsb = signalSpec.startBit;\n      sig_msb = signalSpec.startBit + signalSpec.size - 1;\n    } else {\n      sig_lsb = DbcUtils.matrixBitNumber(DbcUtils.bigEndianBitIndex(signalSpec.startBit) + signalSpec.size - 1);\n      sig_msb = signalSpec.startBit;\n    }\n\n    let ret = signalSpec.size > 32 ? 0n : 0;\n    let i = Math.floor(sig_msb / 8);\n    let bits = signalSpec.size;\n    while (i >= 0 && i < view.byteLength && bits > 0) {\n      let lsb = Math.floor(sig_lsb / 8) === i ? sig_lsb : i*8;\n      let msb = Math.floor(sig_msb / 8) === i ? sig_msb : (i+1)*8 - 1;\n      let size = msb - lsb + 1;\n\n      let d = (view.getUint8(i) >>> (lsb - (i*8))) & ((1 << size) - 1);\n      if (signalSpec.size > 32) {\n        ret |= BigInt(d) << BigInt(bits - size);\n      } else {\n        ret |= d << (bits - size);\n      }\n\n      bits -= size;\n      i = signalSpec.isLittleEndian ? i-1 : i+1;\n    }\n\n    if (signalSpec.size > 32) {\n      ret = signalSpec.isSigned ? BigInt.asIntN(64, ret) : ret;\n      if (Number.isInteger(signalSpec.factor)) {\n        return ret * BigInt(signalSpec.factor) + BigInt(signalSpec.offset);\n      } else {\n        return parseFloat(ret) * signalSpec.factor + signalSpec.offset;\n      }\n    } else {\n      if (signalSpec.isSigned) {\n        ret -= ((ret >> (signalSpec.size-1)) & 1) ? (1 << signalSpec.size) : 0;\n      }\n      return ret * signalSpec.factor + signalSpec.offset;\n    }\n  }\n\n  getSignalValues(messageId, data) {\n    if (!this.messages.has(messageId)) {\n      return {};\n    }\n    const frame = this.getMessageFrame(messageId);\n    const view = new DataView(data.buffer);\n    const signalValuesByName = {};\n    Object.values(frame.signals).forEach((signalSpec) => {\n      if (isNaN(signalSpec.startBit)) {\n        return;\n      }\n      signalValuesByName[signalSpec.name] = this.valueForIntSignal(signalSpec, view);\n    });\n\n    return signalValuesByName;\n  }\n\n  getChffrMetricMappings() {\n    const metricComment = this.comments.find(\n      (comment) => comment.indexOf('CHFFR_METRIC') === 0\n    );\n    if (!metricComment) {\n      return null;\n    }\n\n    return metricComment\n      .split(';')\n      .map((metric) => metric.trim().split(' '))\n      .reduce(\n        (metrics, [_, messageId, signalName, metricName, factor, offset]) => {\n          metrics[metricName] = {\n            messageId: parseInt(messageId, 10),\n            signalName,\n            factor: parseFloat(factor),\n            offset: parseFloat(offset)\n          };\n          return metrics;\n        },\n        {}\n      );\n  }\n\n  _newSymbols() {\n    return `\n    NS_DESC_\n    CM_\n    BA_DEF_\n    BA_\n    VAL_\n    CAT_DEF_\n    CAT_\n    FILTER\n    BA_DEF_DEF_\n    EV_DATA_\n    ENVVAR_DATA_\n    SGTYPE_\n    SGTYPE_VAL_\n    BA_DEF_SGTYPE_\n    BA_SGTYPE_\n    SIG_TYPE_REF_\n    VAL_TABLE_\n    SIG_GROUP_\n    SIG_VALTYPE_\n    SIGTYPE_VALTYPE_\n    BO_TX_BU_\n    BA_DEF_REL_\n    BA_REL_\n    BA_DEF_DEF_REL_\n    BU_SG_REL_\n    BU_EV_REL_\n    BU_BO_REL_\n    SG_MUL_VAL_`;\n  }\n}\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\n\nimport DbcUtils from '../utils/dbc';\n\nexport default class MessageBytes extends Component {\n  static propTypes = {\n    seekTime: PropTypes.number.isRequired,\n    message: PropTypes.object.isRequired,\n    seekIndex: PropTypes.number,\n    live: PropTypes.bool.isRequired\n  };\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isVisible: true,\n      lastMessageIndex: 0,\n      lastSeekTime: 0,\n    };\n\n    this.onVisibilityChange = this.onVisibilityChange.bind(this);\n    this.onCanvasRefAvailable = this.onCanvasRefAvailable.bind(this);\n    this.updateCanvas = this.updateCanvas.bind(this);\n    this.canvasInView = this.canvasInView.bind(this);\n  }\n\n  componentDidMount() {\n    this.componentDidUpdate({}, {});\n  }\n\n  componentDidUpdate(prevProps) {\n    if (prevProps.message !== this.props.message) {\n      let rowCount;\n      if (this.props.message.frame && this.props.message.frame.size) {\n        rowCount = Math.ceil(this.props.message.frame.size / 8);\n      } else {\n        rowCount = Math.ceil(DbcUtils.maxMessageSize(this.props.message, this.state.maxMessageBytes) / 8);\n      }\n      if (this.canvas) {\n        this.canvas.height = rowCount * 15;\n      }\n    }\n\n    if (prevProps.seekIndex !== this.props.seekIndex ||\n      Math.floor(prevProps.seekTime * 60) !== Math.floor(this.props.seekTime * 60))\n    {\n      this.updateCanvas();\n    }\n  }\n\n  canvasInView() {\n    return (!window.visualViewport || !this.canvas || (this.canvas.getBoundingClientRect().y >= 270 &&\n      window.visualViewport.height >= this.canvas.getBoundingClientRect().y));\n  }\n\n  shouldComponentUpdate(nextProps, nextState) {\n    if (nextProps.live && nextProps.message.entries.length) {\n      const nextLastEntry = nextProps.message.entries[nextProps.message.entries.length - 1];\n      const curLastEntry = this.props.message.entries[\n        this.props.message.entries.length - 1\n      ];\n\n      return !nextLastEntry || !curLastEntry || nextLastEntry.hexData !== curLastEntry.hexData;\n    }\n    return nextProps.seekTime !== this.props.seekTime;\n  }\n\n  findMostRecentMessage(seekTime) {\n    const { message } = this.props;\n    const { lastMessageIndex, lastSeekTime } = this.state;\n    let mostRecentMessageIndex = null;\n    if (seekTime >= lastSeekTime) {\n      for (let i = lastMessageIndex; i < message.entries.length; ++i) {\n        const msg = message.entries[i];\n        if (msg && msg.relTime >= seekTime) {\n          mostRecentMessageIndex = i;\n          break;\n        }\n      }\n    }\n\n    if (!mostRecentMessageIndex) {\n      // TODO this can be faster with binary search, not currently a bottleneck though.\n\n      mostRecentMessageIndex = message.entries.findIndex(\n        (e) => e.relTime >= seekTime\n      );\n    }\n\n    if (mostRecentMessageIndex) {\n      this.setState({\n        lastMessageIndex: mostRecentMessageIndex,\n        lastSeekTime: seekTime\n      });\n      return message.entries[mostRecentMessageIndex];\n    }\n  }\n\n  updateCanvas() {\n    const { message, live, seekTime } = this.props;\n    if (!this.canvas || message.entries.length === 0 || !this.canvasInView()) {\n      return;\n    }\n\n    let mostRecentMsg = message.entries[message.entries.length - 1];\n    if (!live) {\n      mostRecentMsg = this.findMostRecentMessage(seekTime);\n\n      if (!mostRecentMsg) {\n        mostRecentMsg = message.entries[0];\n      }\n    }\n\n    const ctx = this.canvas.getContext('2d');\n    // ctx.clearRect(0, 0, 180, 15);\n\n    for (let i = 0; i < message.byteStateChangeCounts.length; ++i) {\n      const hexData = mostRecentMsg.hexData.substr(i * 2, 2);\n\n      const x = (i % 8) * 20;\n      const y = Math.floor(i / 8) * 15;\n\n      ctx.fillStyle = message.byteColors[i];\n      ctx.fillRect(x, y, 20, 15);\n\n      ctx.font = '12px Courier';\n      ctx.fillStyle = 'white';\n      ctx.fillText(hexData ? hexData : '-', x + 2, y + 12);\n    }\n  }\n\n  onVisibilityChange(isVisible) {\n    if (isVisible !== this.state.isVisible) {\n      this.setState({ isVisible });\n    }\n  }\n\n  onCanvasRefAvailable(ref) {\n    if (!ref) return;\n\n    this.canvas = ref;\n    this.canvas.width = 160;\n    let rowCount;\n    if (this.props.message.frame && this.props.message.frame.size) {\n      rowCount = Math.ceil(this.props.message.frame.size / 8);\n    } else {\n      rowCount = Math.ceil(DbcUtils.maxMessageSize(this.props.message, this.state.maxMessageBytes) / 8);\n    }\n    this.canvas.height = rowCount * 15;\n\n    const observer = new IntersectionObserver(this.updateCanvas);\n    observer.observe(this.canvas);\n  }\n\n  render() {\n    return (\n      <canvas\n        ref={this.onCanvasRefAvailable}\n        className=\"cabana-meta-messages-list-item-bytes-canvas\"\n      />\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport cx from 'classnames';\nimport PropTypes from 'prop-types';\nimport Clipboard from 'clipboard';\n\nimport MessageBytes from './MessageBytes';\n\nconst { ckmeans } = require('simple-statistics');\n\nexport default class Meta extends Component {\n  static propTypes = {\n    onMessageSelected: PropTypes.func,\n    onMessageUnselected: PropTypes.func,\n    dongleId: PropTypes.string,\n    name: PropTypes.string,\n    messages: PropTypes.objectOf(PropTypes.object),\n    selectedMessages: PropTypes.array,\n    onPartChanged: PropTypes.func,\n    partsCount: PropTypes.number,\n    showLoadDbc: PropTypes.func,\n    showSaveDbc: PropTypes.func,\n    dbcFilename: PropTypes.string,\n    dbcLastSaved: PropTypes.object, // moment.js object,\n    showEditMessageModal: PropTypes.func,\n    route: PropTypes.object,\n    partsLoaded: PropTypes.number,\n    currentParts: PropTypes.array,\n    seekTime: PropTypes.number,\n    loginWithGithub: PropTypes.element,\n    isDemo: PropTypes.bool,\n    live: PropTypes.bool\n  };\n\n  constructor(props) {\n    super(props);\n\n    this.onFilterChanged = this.onFilterChanged.bind(this);\n    this.onFilterFocus = this.onFilterFocus.bind(this);\n    this.onFilterUnfocus = this.onFilterUnfocus.bind(this);\n    this.canMsgFilter = this.canMsgFilter.bind(this);\n    this.renderMessageBytes = this.renderMessageBytes.bind(this);\n\n    const { dbcLastSaved } = props;\n\n    this.state = {\n      filterText: 'Filter',\n      lastSaved:\n        dbcLastSaved !== null ? this.props.dbcLastSaved.fromNow() : null,\n      hoveredMessages: [],\n      orderedMessageKeys: [],\n    };\n  }\n\n  componentDidMount() {\n    this.lastSavedTimer = setInterval(() => {\n      if (this.props.dbcLastSaved !== null) {\n        this.setState({ lastSaved: this.props.dbcLastSaved.fromNow() });\n      }\n    }, 30000);\n  }\n\n  componentWillUnmount() {\n    window.clearInterval(this.lastSavedTimer);\n  }\n\n  componentDidUpdate(prevProps) {\n    if (prevProps.lastSaved !== this.props.lastSaved) {\n      this.setState({ lastSaved: this.props.dbcLastSaved.fromNow() });\n    }\n\n    if (JSON.stringify(Object.keys(prevProps.messages)) !== JSON.stringify(Object.keys(this.props.messages))) {\n      const orderedMessageKeys = this.sortMessages(this.props.messages);\n      this.setState({ hoveredMessages: [], orderedMessageKeys });\n    } else if (this.state.orderedMessageKeys.length === 0 || (!this.props.live && prevProps.messages &&\n      this.props.messages && this.byteCountsDidUpdate(prevProps.messages, this.props.messages)))\n    {\n      const orderedMessageKeys = this.sortMessages(this.props.messages);\n      if (orderedMessageKeys.length > 0) {\n        this.setState({ orderedMessageKeys });\n      }\n    }\n  }\n\n  byteCountsDidUpdate(prevMessages, nextMessages) {\n    return Object.entries(nextMessages).some(\n      ([msgId, msg]) => JSON.stringify(msg.byteStateChangeCounts)\n        !== JSON.stringify(prevMessages[msgId].byteStateChangeCounts)\n    );\n  }\n\n  sortMessages(messages) {\n    // Returns list of message keys, ordered as follows:\n    // messages are binned into at most 10 bins based on entry count\n    // each bin is sorted by message CAN address\n    // then the list of bins is flattened and reversed to\n    // yield a count-descending, address-ascending order.\n\n    if (Object.keys(messages).length === 0) return [];\n    const messagesByEntryCount = Object.entries(messages).reduce(\n      (partialMapping, [msgId, msg]) => {\n        const entryCountKey = msg.entries.length.toString(); // js object keys are strings\n        if (!partialMapping[entryCountKey]) {\n          partialMapping[entryCountKey] = [msg];\n        } else {\n          partialMapping[entryCountKey].push(msg);\n        }\n        return partialMapping;\n      },\n      {}\n    );\n\n    const entryCounts = Object.keys(messagesByEntryCount).map((count) => parseInt(count, 10));\n    const binnedEntryCounts = ckmeans(\n      entryCounts,\n      Math.min(entryCounts.length, 10)\n    );\n    const sortedKeys = binnedEntryCounts\n      .map((bin) => bin\n        .map((entryCount) => messagesByEntryCount[entryCount.toString()])\n        .reduce((messages, partial) => messages.concat(partial), [])\n        .sort((msg1, msg2) => {\n          if (msg1.address < msg2.address) {\n            return 1;\n          }\n          return -1;\n        })\n        .map((msg) => msg.id))\n      .reduce((keys, bin) => keys.concat(bin), [])\n      .reverse();\n\n    return sortedKeys;\n  }\n\n  onFilterChanged(e) {\n    let val = e.target.value;\n    if (val.trim() === 'Filter') val = '';\n\n    this.setState({ filterText: val });\n  }\n\n  onFilterFocus(e) {\n    if (this.state.filterText.trim() === 'Filter') {\n      this.setState({ filterText: '' });\n    }\n  }\n\n  onFilterUnfocus(e) {\n    if (this.state.filterText.trim() === '') {\n      this.setState({ filterText: 'Filter' });\n    }\n  }\n\n  canMsgFilter(msg) {\n    const { filterText } = this.state;\n    const msgName = msg.frame ? msg.frame.name : '';\n\n    return (\n      filterText === 'Filter'\n      || filterText === ''\n      || msg.id.toLowerCase().indexOf(filterText.toLowerCase()) !== -1\n      || msgName.toLowerCase().indexOf(filterText.toLowerCase()) !== -1\n    );\n  }\n\n  lastSavedPretty() {\n    const { dbcLastSaved } = this.props;\n    return dbcLastSaved.fromNow();\n  }\n\n  onMessageHover(key) {\n    const { hoveredMessages } = this.state;\n    if (hoveredMessages.indexOf(key) !== -1) return;\n\n    hoveredMessages.push(key);\n    this.setState({ hoveredMessages });\n  }\n\n  onMessageHoverEnd(key) {\n    let { hoveredMessages } = this.state;\n    hoveredMessages = hoveredMessages.filter((m) => m !== key);\n    this.setState({ hoveredMessages });\n  }\n\n  onMsgRemoveClick(key) {\n    let { selectedMessages } = this.state;\n    selectedMessages = selectedMessages.filter((m) => m !== key);\n    this.props.onMessageUnselected(key);\n    this.setState({ selectedMessages });\n  }\n\n  onMessageSelected(key) {\n    // uncomment when we support multiple messages\n    // const selectedMessages = this.state.selectedMessages.filter((m) => m !== key);\n    const selectedMessages = [];\n    selectedMessages.push(key);\n    this.props.updateSelectedMessages(selectedMessages);\n    this.props.onMessageSelected(key);\n  }\n\n  orderedMessages() {\n    const { orderedMessageKeys } = this.state;\n    const { messages } = this.props;\n    return orderedMessageKeys.map((key) => messages[key]);\n  }\n\n  selectedMessageClass(messageId) {\n    return this.props.selectedMessages.includes(messageId)\n      ? 'is-selected'\n      : null;\n  }\n\n  renderMessageBytes(msg) {\n    return (\n      <tr\n        onClick={() => {\n          this.onMessageSelected(msg.id);\n        }}\n        key={msg.id}\n        className={cx(\n          'cabana-meta-messages-list-item',\n          this.selectedMessageClass(msg.id)\n        )}\n      >\n        <td>{msg.frame ? msg.frame.name : 'untitled'}</td>\n        <td>{msg.id}</td>\n        <td>{msg.entries.length}</td>\n        <td>\n          <div className=\"cabana-meta-messages-list-item-bytes\">\n            <MessageBytes\n              key={msg.id}\n              message={msg}\n              seekIndex={this.props.seekIndex}\n              seekTime={this.props.seekTime}\n              live={this.props.live}\n            />\n          </div>\n        </td>\n      </tr>\n    );\n  }\n\n  renderCanMessages() {\n    return this.orderedMessages()\n      .filter(this.canMsgFilter)\n      .map(this.renderMessageBytes);\n  }\n\n  renderAvailableMessagesList() {\n    if (Object.keys(this.props.messages).length === 0) {\n      return <p>Loading messages...</p>;\n    }\n    return (\n      <>\n        <table cellPadding=\"5\">\n          <thead>\n            <tr>\n              <td>Name</td>\n              <td>ID</td>\n              <td>Count</td>\n              <td>Bytes</td>\n            </tr>\n          </thead>\n          <tbody>{this.renderCanMessages()}</tbody>\n        </table>\n      </>\n    );\n  }\n\n  saveable() {\n    try {\n      // eslint-disable-next-line\n      \"serviceWorker\" in navigator &&\n        !!new ReadableStream()\n        && !!new WritableStream(); // eslint-disable-line no-undef\n      return 'saveable';\n    } catch (e) {\n      return false;\n    }\n  }\n\n  render() {\n    return (\n      <div className=\"cabana-meta\">\n        <div className=\"cabana-meta-header\">\n          <h5 className=\"cabana-meta-header-label t-capline\">\n            Currently editing:\n          </h5>\n          <strong className=\"cabana-meta-header-filename\">\n            {this.props.dbcFilename}\n          </strong>\n          {this.props.dbcLastSaved !== null ? (\n            <div className=\"cabana-meta-header-last-saved\">\n              <p>\n                Last saved:\n                {this.lastSavedPretty()}\n              </p>\n            </div>\n          ) : null}\n          <div className={`cabana-meta-header-actions ${this.saveable()}`}>\n            <div className=\"cabana-meta-header-action\">\n              <button onClick={this.props.showLoadDbc}>Load DBC</button>\n            </div>\n            {this.saveable() && (\n              <div className=\"cabana-meta-header-action\">\n                <button onClick={this.props.saveLog}>Save Log</button>\n              </div>\n            )}\n            {this.props.shareUrl ? (\n              <div\n                className=\"cabana-meta-header-action special-wide\"\n                data-clipboard-text={this.props.shareUrl}\n                data-clipboard-action=\"copy\"\n                ref={(ref) => (ref ? new Clipboard(ref) : null)}\n              >\n                <a\n                  className=\"button\"\n                  href={this.props.shareUrl}\n                  onClick={(e) => e.preventDefault()}\n                >\n                  Copy Share Link\n                </a>\n              </div>\n            ) : null}\n            <div className=\"cabana-meta-header-action\">\n              <button onClick={this.props.showSaveDbc}>Save DBC</button>\n            </div>\n          </div>\n        </div>\n        <div className=\"cabana-meta-messages-header\">\n          <h5 className=\"t-capline\">Available messages</h5>\n        </div>\n        <div className=\"cabana-meta-messages-filter\">\n          <div className=\"form-field form-field--small\">\n            <input\n              type=\"text\"\n              value={this.state.filterText}\n              onFocus={this.onFilterFocus}\n              onBlur={this.onFilterUnfocus}\n              onChange={this.onFilterChanged}\n            />\n          </div>\n        </div>\n        <div className=\"cabana-meta-messages-list\">\n          {this.renderAvailableMessagesList()}\n        </div>\n      </div>\n    );\n  }\n}\n","function elementWiseEquals(arr1, arr2) {\n  return (\n    arr1.length === arr2.length && arr1.every((ele, idx) => arr2[idx] === ele)\n  );\n}\n\nfunction findIndexRight(arr, condition) {\n  for (let i = arr.length - 1; i >= 0; i--) {\n    if (condition(arr[i])) {\n      return i;\n    }\n  }\n}\n\nexport default { elementWiseEquals, findIndexRight };\n","import ArrayUtils from '../utils/array';\nimport { CAN_GRAPH_MAX_POINTS } from '../config';\n\nfunction signalColors(signal, msg) {\n  return signal.colors.map((v) => (v ^ msg.address) ^ msg.bus);\n}\n\nfunction _calcGraphData(msg, signalUid, firstCanTime) {\n  if (!msg) return null;\n\n  const signal = Object.values(msg.frame.signals).find(\n    (s) => s.uid === signalUid\n  );\n  if (!signal) {\n    console.warn('_calcGraphData: no signal', signalUid, msg);\n    return null;\n  }\n  let samples = [];\n  const skip = Math.floor(msg.entries.length / CAN_GRAPH_MAX_POINTS);\n\n  if (skip === 0) {\n    samples = msg.entries;\n  } else {\n    for (let i = 0; i < msg.entries.length; i += skip) {\n      samples.push(msg.entries[i]);\n    }\n    // Always include last message entry, which faciliates graphData comparison\n    samples.push(msg.entries[msg.entries.length - 1]);\n  }\n  if (!samples.length) {\n    return [];\n  }\n\n  const colors = signal.getColors(msg.id);\n  signalUid = msg.id + signalUid;\n  // sorting these doesn't fix the phantom lines\n  let lastEntry = samples[0].relTime;\n  return samples\n    .filter((e) => e.signals[signal.name] !== undefined)\n    .map((entry) => {\n      if (entry.relTime < lastEntry) {\n        console.log(msg);\n        console.error('Found out of order messages');\n        debugger;\n      }\n      if (entry.relTime - lastEntry > 2) {\n        signalUid = Math.random().toString(36);\n      }\n      lastEntry = entry.relTime;\n      // console.log(entry.relTime - lastEntry);\n      return {\n        x: entry.time,\n        relTime: entry.relTime,\n        y: parseFloat(entry.signals[signal.name]),\n        unit: signal.unit,\n        color: `rgba(${colors.join(',')}, 0.5)`,\n        signalName: signal.name,\n        signalUid\n      };\n    });\n}\n\nfunction appendNewGraphData(plottedSignals, graphData, messages, firstCanTime) {\n  const messagesPerPlot = plottedSignals.map((plottedMessages) => plottedMessages.reduce((messages, { messageId, signalUid }) => {\n    messages.push(messageId);\n    return messages;\n  }, []));\n\n  const extendedPlots = messagesPerPlot\n    .map((plottedMessageIds, index) => ({ plottedMessageIds, index })) // preserve index so we can look up graphData\n    .filter(({ plottedMessageIds, index }) => {\n      if (index < graphData.length) {\n        let maxGraphTime = 0;\n        const { series } = graphData[index];\n        if (series.length > 0) {\n          maxGraphTime = series[graphData[index].series.length - 1].relTime;\n        }\n\n        return plottedMessageIds.some(\n          (messageId) => (messages[messageId].entries.length > 0 && series.length === 0)\n            || messages[messageId].entries.some((e) => e.relTime > maxGraphTime)\n        );\n      }\n      return false;\n    })\n    .map(({ plottedMessageIds, index }) => {\n      plottedMessageIds = plottedMessageIds.reduce((arr, messageId) => {\n        if (arr.indexOf(messageId) === -1) {\n          arr.push(messageId);\n        }\n        return arr;\n      }, []);\n      return { plottedMessageIds, index };\n    });\n\n  extendedPlots.forEach(({ plottedMessageIds, index }) => {\n    const signalUidsByMessageId = plottedSignals[index].reduce(\n      (obj, { messageId, signalUid }) => {\n        if (!obj[messageId]) {\n          obj[messageId] = [];\n        }\n        obj[messageId].push(signalUid);\n        return obj;\n      },\n      {}\n    );\n    const { series } = graphData[index];\n    const graphDataMaxMessageTimes = plottedMessageIds.reduce(\n      (obj, messageId) => {\n        const signalUids = signalUidsByMessageId[messageId];\n        const maxIndex = ArrayUtils.findIndexRight(\n          series,\n          (entry) => signalUids.indexOf(entry.signalUid) !== -1\n        );\n        if (maxIndex) {\n          obj[messageId] = series[maxIndex].relTime;\n        } else if (series.length > 0) {\n          obj[messageId] = series[series.length - 1].relTime;\n        } else {\n          // Graph data is empty\n          obj[messageId] = -1;\n        }\n\n        return obj;\n      },\n      {}\n    );\n\n    let newGraphData = [];\n    plottedMessageIds\n      .map((messageId) => ({ messageId, entries: messages[messageId].entries }))\n      .filter(\n        (\n          { messageId, entries } // Filter to only messages with stale graphData\n        ) => entries[entries.length - 1].relTime\n          > graphDataMaxMessageTimes[messageId]\n      )\n      .forEach(({ messageId, entries }) => {\n        // Compute and append new graphData\n        const firstNewEntryIdx = entries.findIndex(\n          (entry) => entry.relTime > graphDataMaxMessageTimes[messageId]\n        );\n\n        const newEntries = entries.slice(firstNewEntryIdx);\n        signalUidsByMessageId[messageId].forEach((signalUid) => {\n          const signalGraphData = _calcGraphData(\n            {\n              ...messages[messageId],\n              entries: newEntries\n            },\n            signalUid,\n            firstCanTime\n          );\n\n          newGraphData = newGraphData.concat(signalGraphData);\n        });\n      });\n\n    const messageIdOutOfBounds = series.length > 0\n      && plottedMessageIds.find(\n        (messageId) => messages[messageId].entries.length > 0\n          && series[0].relTime < messages[messageId].entries[0].relTime\n      );\n    graphData[index] = {\n      series: graphData[index].series.concat(newGraphData),\n      updated: Date.now()\n    };\n\n    if (messageIdOutOfBounds) {\n      const graphDataLowerBound = graphData[index].series.findIndex(\n        (e) => e.relTime > messages[messageIdOutOfBounds].entries[0].relTime\n      );\n\n      if (graphDataLowerBound) {\n        graphData[index].series = graphData[index].series.slice(\n          graphDataLowerBound\n        );\n      }\n    }\n  });\n\n  return [...graphData];\n}\n\nexport default { _calcGraphData, appendNewGraphData, signalColors };\n","export default {\n  \"$schema\": \"https://vega.github.io/schema/vega/v5.json\",\n  \"width\": 500,\n  \"height\": 212,\n  \"autosize\": \"none\",\n  \"padding\": {\n    \"top\": 5,\n    \"left\": 70,\n    \"right\": 20,\n    \"bottom\": 20\n  },\n  \"data\": [\n    {\n      \"name\": \"table\"\n    },\n    {\n      \"name\": \"segment\"\n    },\n    {\n      \"name\": \"tooltip\",\n      \"source\": \"table\",\n      \"transform\": [\n        {\n          \"type\": \"filter\",\n          \"expr\": \"abs(datum.relTime - tipTime) <= 0.05\"\n        },\n        {\n          \"type\": \"aggregate\",\n          \"groupby\": [\"color\"],\n          \"fields\": [\n            \"relTime\",\n            \"y\",\n            \"unit\"\n          ],\n          \"ops\": [\n            \"min\",\n            \"argmin\",\n            \"argmin\"\n          ],\n          \"as\": [\n            \"min\",\n            \"argmin\",\n            \"argmin\"\n          ]\n        }\n      ]\n    },\n    {\n      \"name\": \"ySegmentScale\",\n      \"source\": \"table\",\n      \"transform\": [\n        {\n          \"type\": \"filter\",\n          \"expr\": \"length(segment) != 2 || (datum.relTime >= segment[0] && datum.relTime <= segment[1])\"\n        },\n        {\n          \"type\": \"extent\",\n          \"field\": \"y\",\n          \"signal\": \"ySegment\"\n        }\n      ]\n    }\n  ],\n\n  \"scales\": [\n    {\n      \"name\": \"xscale\",\n      \"type\": \"linear\",\n      \"range\": \"width\",\n      \"domain\": {\n        \"data\": \"table\",\n        \"field\": \"x\"\n      },\n      \"zero\": false\n    },\n    {\n      \"name\": \"xrelscale\",\n      \"type\": \"linear\",\n      \"range\": \"width\",\n      \"domain\": {\n        \"data\": \"table\",\n        \"field\": \"relTime\"\n      },\n      \"zero\": false,\n      \"clamp\": true,\n      \"nice\": true,\n      \"domainRaw\": {\n        \"signal\": \"segment\"\n      }\n    },\n    {\n      \"name\": \"yscale\",\n      \"type\": \"linear\",\n      \"range\": \"height\",\n      \"clamp\": true,\n      \"zero\": false,\n      \"nice\": true,\n      \"domain\": {\n        \"signal\": \"ySegment\"\n      }\n    },\n    {\n      \"name\": \"color\",\n      \"type\": \"ordinal\",\n      \"domain\": {\n        \"data\": \"table\",\n        \"field\": \"color\"\n      },\n      \"range\": {\n        \"data\": \"table\",\n        \"field\": \"color\"\n      }\n    }\n  ],\n\n\n  \"axes\": [\n    {\n      \"orient\": \"bottom\",\n      \"scale\": \"xrelscale\",\n      \"labelOverlap\": true\n    },\n    {\n      \"orient\": \"left\",\n      \"scale\": \"yscale\",\n      \"format\": \".6~g\"\n    }\n  ],\n\n  \"signals\": [\n    {\n      \"name\": \"tipTime\",\n      \"on\": [\n        {\n          \"events\": \"mousemove\",\n          \"update\": \"invert('xrelscale', x())\"\n        },\n        {\n          \"events\": \"mouseout\",\n          \"update\": \"null\"\n        }\n      ]\n    },\n    {\n      \"name\": \"clickTime\",\n      \"on\": [\n        {\n          \"events\": \"click\",\n          \"update\": \"invert('xrelscale', x())\"\n        }\n      ]\n    },\n    {\n      \"name\": \"videoTime\"\n    },\n    {\n      \"name\": \"segment\",\n      \"value\": {\n        \"data\": \"table\",\n        \"field\": \"relTime\"\n      }\n    }\n  ],\n\n  \"marks\": [\n    {\n      \"type\": \"group\",\n      \"name\": \"plot\",\n      \"interactive\": true,\n      \"encode\": {\n        \"enter\": {\n          \"width\": {\n            \"signal\": \"width\"\n          },\n          \"height\": {\n            \"signal\": \"height\"\n          },\n          \"fill\": {\n            \"value\": \"transparent\"\n          }\n        }\n      },\n      \"signals\": [\n        {\n          \"name\": \"brush\",\n          \"value\": 0,\n          \"on\": [\n            {\n              \"events\": \"@boundingRect:mousedown\",\n              \"update\": \"[x(), x()]\"\n            },\n            {\n              \"events\": \"[@boundingRect:mousedown, window:mouseup] > window:mousemove!\",\n              \"update\": \"[brush[0], clamp(x(), 0, width)]\"\n            },\n            {\n              \"events\": {\n                \"signal\": \"delta\"\n              },\n              \"update\": \"clampRange([anchor[0] + delta, anchor[1] + delta], 0, width)\"\n            }\n          ]\n        },\n        {\n          \"name\": \"anchor\",\n          \"value\": null,\n          \"on\": [\n            {\n              \"events\": \"@brush:mousedown\",\n              \"update\": \"slice(brush)\"\n            }\n          ]\n        },\n        {\n          \"name\": \"xdown\",\n          \"value\": 0,\n          \"on\": [\n            {\n              \"events\": \"@brush:mousedown\",\n              \"update\": \"x()\"\n            }\n          ]\n        },\n        {\n          \"name\": \"xup\",\n          \"value\": 0,\n          \"on\": [\n            {\n              \"events\": \"@brush:mouseup\",\n              \"update\": \"x()\"\n            }\n          ]\n        },\n        {\n          \"name\": \"delta\",\n          \"value\": 0,\n          \"on\": [\n            {\n              \"events\": \"[@brush:mousedown, window:mouseup] > window:mousemove!\",\n              \"update\": \"x() - xdown\"\n            }\n          ]\n        },\n        {\n          \"name\": \"segment\",\n          \"push\": \"outer\",\n          \"on\": [\n            {\n              \"events\": \"window:mouseup\",\n              \"update\": \"span(brush) && span(brush) > 15 ? invert('xrelscale', brush) : segment\"\n            }\n          ]\n        }\n      ],\n      \"marks\": [\n        {\n          \"type\": \"group\",\n          \"from\": {\n            \"facet\": {\n              \"name\": \"series\",\n              \"data\": \"table\",\n              \"groupby\": \"signalUid\"\n            }\n          },\n          \"marks\": [{\n            \"type\": \"line\",\n            \"name\": \"lineMark\",\n            \"from\": {\n              \"data\": \"series\"\n            },\n            \"interactive\": true,\n            \"encode\": {\n              \"update\": {\n                \"value\": \"natural\",\n                \"tension\": 0,\n                \"x\": {\n                  \"scale\": \"xrelscale\",\n                  \"field\": \"relTime\"\n                },\n                \"y\": {\n                  \"scale\": \"yscale\",\n                  \"field\": \"y\"\n                },\n                \"detail\": {\n                  \"field\": \"signalUid\"\n                }\n              },\n              \"hover\": {\n                \"fillOpacity\": {\n                  \"value\": 0.5\n                }\n              },\n              \"enter\": {\n                \"clip\": {\n                  \"value\": true\n                },\n                \"stroke\": {\n                  \"scale\": \"color\",\n                  \"field\": \"color\"\n                },\n                \"strokeWidth\": {\n                  \"value\": 2\n                }\n              }\n            }\n          }]\n        },\n        {\n          \"type\": \"rect\",\n          \"interactive\": true,\n          \"name\": \"brush\",\n          \"encode\": {\n            \"enter\": {\n              \"y\": {\n                \"value\": 0\n              },\n              \"height\": {\n                \"signal\": \"height\"\n              },\n              \"fill\": {\n                \"value\": \"#333\"\n              },\n              \"fillOpacity\": {\n                \"value\": 0.2\n              }\n            },\n            \"update\": {\n              \"x\": {\n                \"signal\": \"brush[0]\"\n              },\n              \"x2\": {\n                \"signal\": \"brush[1]\"\n              }\n            }\n          }\n        },\n        {\n          \"type\": \"rule\",\n          \"encode\": {\n            \"update\": {\n              \"y\": {\n                \"value\": 0\n              },\n              \"y2\": {\n                \"field\": {\n                  \"group\": \"height\"\n                }\n              },\n              \"stroke\": {\n                \"value\": \"#000\"\n              },\n              \"strokeWidth\": {\n                \"value\": 2\n              },\n              \"x\": {\n                \"scale\": \"xrelscale\",\n                \"signal\": \"videoTime\",\n                \"offset\": 0.5\n              }\n            }\n          }\n        },\n        {\n          \"type\": \"symbol\",\n          \"from\": {\n            \"data\": \"tooltip\"\n          },\n          \"encode\": {\n            \"update\": {\n              \"x\": {\n                \"scale\": \"xrelscale\",\n                \"field\": \"argmin.relTime\"\n              },\n              \"y\": {\n                \"scale\": \"yscale\",\n                \"field\": \"argmin.y\"\n              },\n              \"size\": {\n                \"value\": 50\n              },\n              \"fill\": {\n                \"value\": \"black\"\n              }\n            }\n          }\n        },\n        {\n          \"type\": \"group\",\n          \"from\": {\n            \"data\": \"tooltip\"\n          },\n          \"interactive\": false,\n          \"name\": \"tooltipGroup\",\n          \"encode\": {\n            \"update\": {\n              \"x\": [\n                {\n                  \"test\": \"inrange(datum.argmin.relTime + 80, domain('xrelscale'))\",\n                  \"scale\": \"xrelscale\",\n                  \"field\": \"argmin.relTime\"\n                },\n                {\n                  \"scale\": \"xrelscale\",\n                  \"field\": \"argmin.relTime\",\n                  \"offset\": -80\n                }\n              ],\n              \"y\": {\n                \"scale\": \"yscale\",\n                \"field\": \"argmin.y\"\n              },\n              \"height\": {\n                \"value\": 20\n              },\n              \"width\": {\n                \"value\": 80\n              },\n              \"fill\": {\n                \"value\": \"#fff\"\n              },\n              \"fillOpacity\": {\n                \"value\": 0.85\n              },\n              \"stroke\": {\n                \"value\": \"#aaa\"\n              },\n              \"strokeWidth\": {\n                \"value\": 0.5\n              }\n            }\n          },\n          \"marks\": [\n            {\n              \"type\": \"text\",\n              \"interactive\": false,\n              \"encode\": {\n                \"update\": {\n                  \"text\": {\n                    \"signal\": \"format(parent.argmin.relTime, ',.2f') + ': ' + format(parent.argmin.y, ',.2f') + ' ' + parent.argmin.unit\"\n                  },\n                  \"fill\": {\n                    \"value\": \"black\"\n                  },\n                  \"fontWeight\": {\n                    \"value\": \"bold\"\n                  },\n                  \"y\": {\n                    \"value\": 20\n                  }\n                }\n              }\n            }\n          ]\n        },\n        {\n          \"type\": \"rect\",\n          \"name\": \"boundingRect\",\n          \"interactive\": true,\n          \"encode\": {\n            \"enter\": {\n              \"width\": {\n                \"signal\": \"width\"\n              },\n              \"height\": {\n                \"signal\": \"height\"\n              },\n              \"fill\": {\n                \"value\": \"transparent\"\n              }\n            }\n          }\n        }\n      ]\n    }\n  ]\n};\n","export default function debounce(func, wait, immediate) {\n  let timeout;\n  return function () {\n    const context = this;\n    const args = arguments;\n    const later = function () {\n      timeout = null;\n      if (!immediate) func.apply(context, args);\n    };\n    const callNow = immediate && !timeout;\n    clearTimeout(timeout);\n    timeout = setTimeout(later, wait);\n    if (callNow) func.apply(context, args);\n  };\n}\n","import React, { Component } from 'react';\nimport Measure from 'react-measure';\nimport PropTypes from 'prop-types';\nimport cx from 'classnames';\nimport { Vega } from 'react-vega';\n\nimport Signal from '../models/can/signal';\nimport GraphData from '../models/graph-data';\nimport CanPlotSpec from '../vega/CanPlot';\nimport debounce from '../utils/debounce';\n\nconst DefaultPlotInnerStyle = {\n  position: 'absolute',\n  top: 0,\n  left: 0\n};\n\nexport default class CanGraph extends Component {\n  static emptyTable = [];\n\n  static propTypes = {\n    plottedSignal: PropTypes.string,\n    messages: PropTypes.object,\n    messageId: PropTypes.string,\n    messageName: PropTypes.string,\n    signalSpec: PropTypes.instanceOf(Signal),\n    segment: PropTypes.array,\n    unplot: PropTypes.func,\n    onRelativeTimeClick: PropTypes.func,\n    currentTime: PropTypes.number,\n    onSegmentChanged: PropTypes.func,\n    onDragStart: PropTypes.func,\n    onDragEnd: PropTypes.func,\n    container: PropTypes.object,\n    dragPos: PropTypes.object,\n    canReceiveGraphDrop: PropTypes.bool,\n    onGraphRefAvailable: PropTypes.func,\n    plottedSignals: PropTypes.array\n  };\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      plotInnerStyle: null,\n      shiftX: 0,\n      shiftY: 0,\n      bounds: null,\n      isDataInserted: false,\n      data: this.getGraphData(props),\n      spec: this.getGraphSpec(props)\n    };\n    this.onNewView = this.onNewView.bind(this);\n    this.onSignalClickTime = this.onSignalClickTime.bind(this);\n    this.onSignalSegment = this.onSignalSegment.bind(this);\n    this.onDragAnchorMouseDown = this.onDragAnchorMouseDown.bind(this);\n    this.onDragAnchorMouseUp = this.onDragAnchorMouseUp.bind(this);\n    this.onDragStart = this.onDragStart.bind(this);\n    this.onPlotResize = this.onPlotResize.bind(this);\n    this.insertData = this.insertData.bind(this);\n  }\n\n  getGraphData(props) {\n    let firstRelTime = -1;\n    let lastRelTime = -1;\n    const series = props.plottedSignals\n      .map((signals) => {\n        const { messageId, signalUid } = signals;\n        const { entries } = props.messages[messageId];\n        if (entries.length) {\n          let messageRelTime = entries[0].relTime;\n          if (firstRelTime === -1) {\n            firstRelTime = messageRelTime;\n          } else {\n            firstRelTime = Math.min(firstRelTime, messageRelTime);\n          }\n          messageRelTime = entries[entries.length - 1].relTime;\n          lastRelTime = Math.max(lastRelTime, messageRelTime);\n        }\n        return GraphData._calcGraphData(\n          props.messages[messageId],\n          signalUid,\n          0\n        );\n      })\n      .reduce((m, v) => m.concat(v), []);\n\n    return {\n      updated: Date.now(),\n      series,\n      firstRelTime,\n      lastRelTime\n    };\n  }\n\n  getGraphSpec(props) {\n    return {\n      ...CanPlotSpec,\n      scales: [\n        {\n          ...CanPlotSpec.scales[0],\n          domainMin: props.segment[0],\n          domainMax: props.segment[1]\n        },\n        ...CanPlotSpec.scales.slice(1)\n      ]\n    };\n  }\n\n  segmentIsNew(newSegment) {\n    return (\n      newSegment.length !== this.props.segment.length\n      || !newSegment.every((val, idx) => this.props.segment[idx] === val)\n    );\n  }\n\n  visualChanged(prevProps, nextProps) {\n    return (\n      prevProps.canReceiveGraphDrop !== nextProps.canReceiveGraphDrop\n      || JSON.stringify(prevProps.dragPos) !== JSON.stringify(nextProps.dragPos)\n    );\n  }\n\n  onPlotResize(options) {\n    if (!this.view) {\n      return;\n    }\n\n    let bounds = null; // eslint-disable-line no-unused-vars\n    if (options && options.bounds) {\n      this.setState({ bounds: options.bounds });\n      bounds = options.bounds;\n    } else {\n      bounds = this.state.bounds;\n    }\n\n    this.view.runAfter(this.updateBounds);\n  }\n\n  updateBounds = debounce(() => {\n    this.view.signal('width', this.state.bounds.width - 90);\n    this.view.signal('height', 0.4 * (this.state.bounds.width - 40)); // 5:2 aspect ratio\n\n    this.view.run();\n  }, 100);\n\n  insertData = debounce(() => {\n    if (!this.view) {\n      console.log('Cannot insertData');\n      return;\n    }\n\n    // adding plot points by diff isn't faster since it basically has to be n^2\n    // out-of-order events make it so that you can't just check the bounds\n    const { series } = this.state.data;\n    const changeset = this.view\n      .changeset()\n      .remove((v) => true)\n      .insert(series);\n    this.view.change('table', changeset);\n    this.view.run();\n  }, 250);\n\n  componentDidUpdate(prevProps) {\n    if (this.props.dragPos && JSON.stringify(prevProps.dragPos) !== JSON.stringify(this.props.dragPos)) {\n      this.updateStyleFromDragPos(this.props.dragPos);\n    } else if (!this.props.dragPos && this.state.plotInnerStyle !== null) {\n      this.setState({ plotInnerStyle: null });\n    }\n\n    if (prevProps.messages !== this.props.messages || prevProps.plottedSignal !== this.props.plottedSignal) {\n      const data = this.getGraphData(this.props);\n      this.setState({ data });\n    }\n    if (this.segmentIsNew(this.props.segment)) {\n      this.setState({ spec: this.getGraphSpec(this.props) });\n    }\n\n    if (this.view) {\n      if (this.props.segment.length > 0) {\n        // Set segmented domain\n        this.view.signal('segment', this.props.segment);\n      } else {\n        // Reset segment to full domain\n        this.view.signal('segment', 0);\n      }\n      this.view.signal('videoTime', this.props.currentTime);\n      this.view.runAsync();\n    }\n  }\n\n  shouldComponentUpdate(nextProps, nextState) {\n    if (!this.view) {\n      return true;\n    }\n    if (this.props.messages !== nextProps.messages || this.props.plottedSignal !== nextProps.plottedSignal ||\n      this.segmentIsNew(nextProps.segment) || this.state.spec !== nextState.spec)\n    {\n      return true;\n    }\n    if (this.state.data !== nextState.data) {\n      this.insertData();\n    }\n    if (this.props.currentTime !== nextProps.currentTime) {\n      this.view.signal('videoTime', nextProps.currentTime);\n    }\n    if (this.segmentIsNew(nextProps.segment)) {\n      if (nextProps.segment.length > 0) {\n        // Set segmented domain\n        this.view.signal('segment', nextProps.segment);\n      } else {\n        // Reset segment to full domain\n        this.view.signal('segment', 0);\n      }\n    }\n    this.view.runAsync();\n    return false;\n  }\n\n  updateStyleFromDragPos({ left, top }) {\n    const plotInnerStyle = { ...this.state.plotInnerStyle };\n    plotInnerStyle.left = left;\n    plotInnerStyle.top = top;\n    this.setState({ plotInnerStyle });\n  }\n\n  onNewView(view) {\n    this.view = view;\n\n    if (this.state.bounds) {\n      this.onPlotResize();\n    }\n    if (this.props.segment.length > 0) {\n      view.signal('segment', this.props.segment);\n    }\n    view.signal('videoTime', this.props.currentTime);\n\n    this.insertData();\n  }\n\n  onSignalClickTime(signal, clickTime) {\n    // console.log('onSignalClickTime', signal, clickTime);\n    if (clickTime !== undefined) {\n      this.props.onRelativeTimeClick(this.props.messageId, clickTime);\n    }\n  }\n\n  onSignalSegment(signal, segment) {\n    // console.log('onSignalSegment', signal, segment);\n    if (!Array.isArray(segment)) {\n      return;\n    }\n\n    this.props.onSegmentChanged(this.props.messageId, segment);\n\n    if (!this.view) {\n      return;\n    }\n\n    this.view.runAfter(() => {\n      const state = this.view.getState();\n      state.subcontext[0].signals.brush = 0;\n      this.view.setState(state);\n      this.insertData();\n    });\n  }\n\n  plotInnerStyleFromMouseEvent(e) {\n    const { shiftX, shiftY } = this.state;\n    const plotInnerStyle = { ...DefaultPlotInnerStyle };\n    const rect = this.props.container.getBoundingClientRect();\n\n    const x = e.clientX - rect.left - shiftX;\n    const y = e.clientY - rect.top - shiftY;\n    plotInnerStyle.left = x;\n    plotInnerStyle.top = y;\n    return plotInnerStyle;\n  }\n\n  onDragAnchorMouseDown(e) {\n    e.persist();\n    const shiftX = e.clientX - e.target.getBoundingClientRect().left;\n    const shiftY = e.clientY - e.target.getBoundingClientRect().top;\n    this.setState({ shiftX, shiftY }, () => {\n      this.setState({ plotInnerStyle: this.plotInnerStyleFromMouseEvent(e) });\n    });\n    this.props.onDragStart(\n      this.props.messageId,\n      this.props.signalSpec.uid,\n      shiftX,\n      shiftY\n    );\n  }\n\n  onDragAnchorMouseUp(e) {\n    this.props.onDragEnd();\n    this.setState({\n      plotInnerStyle: null,\n      shiftX: 0,\n      shiftY: 0\n    });\n  }\n\n  onDragStart(e) {\n    e.preventDefault();\n    return false;\n  }\n\n  render() {\n    const { plotInnerStyle } = this.state;\n    const canReceiveDropClass = this.props.canReceiveGraphDrop\n      ? 'is-droppable'\n      : null;\n\n    return (\n      <div\n        className=\"cabana-explorer-visuals-plot\"\n        ref={this.props.onGraphRefAvailable}\n      >\n        <div\n          className={cx(\n            'cabana-explorer-visuals-plot-inner',\n            canReceiveDropClass\n          )}\n          style={plotInnerStyle || null}\n        >\n          <div\n            className=\"cabana-explorer-visuals-plot-draganchor\"\n            onMouseDown={this.onDragAnchorMouseDown}\n          >\n            <span className=\"fa fa-bars\" />\n          </div>\n          {this.props.plottedSignals.map(\n            ({ messageId, signalUid, messageName }) => {\n              const signal = Object.values(\n                this.props.messages[messageId].frame.signals\n              ).find((s) => s.uid === signalUid);\n              const colors = signal.getColors(messageId);\n\n              return (\n                <div\n                  className=\"cabana-explorer-visuals-plot-header\"\n                  key={`${messageId}_${signal.uid}`}\n                >\n                  <div className=\"cabana-explorer-visuals-plot-header-toggle\">\n                    <button\n                      className=\"button--tiny\"\n                      onClick={() => this.props.unplot(messageId, signalUid)}\n                    >\n                      <span>Hide Plot</span>\n                    </button>\n                  </div>\n                  <div className=\"cabana-explorer-visuals-plot-header-copy\">\n                    <div className=\"cabana-explorer-visuals-plot-message\">\n                      <span>\n                        {messageName}\n                        {' '}\n                        {messageId}\n                      </span>\n                    </div>\n                    <div className=\"cabana-explorer-visuals-plot-signal\">\n                      <div\n                        className=\"cabana-explorer-visuals-plot-signal-color\"\n                        style={{ background: `rgb(${colors}` }}\n                      />\n                      <strong>{signal.name}</strong>\n                    </div>\n                  </div>\n                </div>\n              );\n            }\n          )}\n          <Measure bounds onResize={this.onPlotResize}>\n            {({ measureRef }) => (\n              <div\n                ref={measureRef}\n                className=\"cabana-explorer-visuals-plot-container\"\n              >\n                <Vega\n                  onNewView={this.onNewView}\n                  logLevel={1}\n                  signalListeners={{\n                    clickTime: this.onSignalClickTime,\n                    segment: this.onSignalSegment\n                  }}\n                  renderer=\"canvas\"\n                  spec={this.state.spec}\n                  actions={false}\n                  data={{\n                    table: this.state.data.series\n                  }}\n                />\n              </div>\n            )}\n          </Measure>\n        </div>\n      </div>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\n\nimport CanGraph from './CanGraph';\n\nexport default class CanGraphList extends Component {\n  static propTypes = {\n    plottedSignals: PropTypes.array.isRequired,\n    messages: PropTypes.object.isRequired,\n    onGraphTimeClick: PropTypes.func.isRequired,\n    seekTime: PropTypes.number.isRequired,\n    onSegmentChanged: PropTypes.func.isRequired,\n    onSignalUnplotPressed: PropTypes.func.isRequired,\n    segment: PropTypes.array.isRequired,\n    mergePlots: PropTypes.func.isRequired\n  };\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      draggingSignal: {},\n      dragPos: null,\n      dragShift: null,\n      graphToReceiveDrop: null\n    };\n\n    this.plotListRef = React.createRef();\n    this.plotRefs = [];\n    this.renderSignalPlot = this.renderSignalPlot.bind(this);\n    this.onGraphDragStart = this.onGraphDragStart.bind(this);\n    this.onGraphDragEnd = this.onGraphDragEnd.bind(this);\n    this.onMouseMove = this.onMouseMove.bind(this);\n  }\n\n  onGraphDragStart(messageId, signalUid, shiftX, shiftY) {\n    this.setState({\n      draggingSignal: { messageId, signalUid },\n      dragShift: { x: shiftX, y: shiftY }\n    });\n  }\n\n  determineDraggingGraph() {\n    const { draggingSignal } = this.state;\n    return this.plotRefs.find(\n      ({ messageId, signalUid }) => draggingSignal.messageId === messageId\n        && draggingSignal.signalUid === signalUid\n    );\n  }\n\n  onMouseMove(e) {\n    const { dragShift } = this.state;\n    if (dragShift === null) {\n      if (this.state.graphToReceiveDrop !== null) {\n        this.setState({ graphToReceiveDrop: null });\n      }\n      return;\n    }\n    const rect = this.plotListRef.current.getBoundingClientRect();\n    const draggingGraph = this.determineDraggingGraph();\n    if (draggingGraph) {\n      draggingGraph.ref.hidden = true;\n      const ele = document.elementFromPoint(e.clientX, e.clientY);\n      draggingGraph.ref.hidden = false;\n      const closestPlot = ele.closest('.cabana-explorer-visuals-plot');\n      const closestPlotRef = this.plotRefs.find(\n        ({ ref, messageId, signalUid }) => !(\n          messageId === draggingGraph.messageId\n            && signalUid === draggingGraph.signalUid\n        ) && ref.isEqualNode(closestPlot)\n      );\n      if (closestPlotRef) {\n        this.setState({ graphToReceiveDrop: closestPlotRef });\n      } else {\n        this.setState({ graphToReceiveDrop: null });\n      }\n    }\n    const left = e.clientX - rect.left - dragShift.x;\n    const top = e.clientY - rect.top - dragShift.y;\n\n    this.setState({ dragPos: { left, top } });\n  }\n\n  onGraphDragEnd() {\n    if (this.state.graphToReceiveDrop !== null) {\n      this.props.mergePlots({\n        fromPlot: this.state.draggingSignal,\n        toPlot: this.state.graphToReceiveDrop\n      });\n    }\n\n    this.setState({\n      draggingSignal: {},\n      dragShift: null,\n      dragPos: null,\n      graphToReceiveDrop: null\n    });\n  }\n\n  addCanGraphRef(ref, messageId, signalUid) {\n    if (ref) {\n      let { plotRefs } = this;\n      plotRefs = plotRefs\n        .filter(\n          (ref) => !(ref.messageId === messageId && ref.signalUid === signalUid)\n        )\n        .concat([{ messageId, signalUid, ref }]);\n      this.plotRefs = plotRefs;\n    }\n  }\n\n  renderSignalPlot(plottedSignals, index) {\n    const { draggingSignal, graphToReceiveDrop } = this.state;\n    const { messageId, signalUid } = plottedSignals[0];\n    const msg = this.props.messages[messageId];\n    if (!this.plotListRef.current || !msg) {\n      return [];\n    }\n\n    const signal = Object.values(msg.frame.signals).find(\n      (s) => s.uid === signalUid\n    );\n\n    if (!signal) {\n      return null;\n    }\n\n    const isDragging = draggingSignal.signalUid === signalUid\n      && draggingSignal.messageId === messageId;\n    const canReceiveGraphDrop = graphToReceiveDrop\n      && graphToReceiveDrop.signalUid === signalUid\n      && graphToReceiveDrop.messageId === messageId;\n    plottedSignals = plottedSignals.map((plottedSignal) => ({\n      messageName: this.props.messages[plottedSignal.messageId].frame.name,\n      ...plottedSignal\n    }));\n    const key = plottedSignals.reduce(\n      (key, { messageId, signalUid }) => `${key + messageId}_${signalUid}`,\n      ''\n    );\n    return (\n      <CanGraph\n        onGraphRefAvailable={(ref) => {\n          this.addCanGraphRef(ref, messageId, signalUid);\n        }}\n        key={key}\n        unplot={this.props.onSignalUnplotPressed}\n        messages={this.props.messages}\n        messageId={messageId}\n        messageName={msg.frame ? msg.frame.name : null}\n        signalSpec={Object.assign(Object.create(signal), signal)}\n        onSegmentChanged={this.props.onSegmentChanged}\n        segment={this.props.segment}\n        onRelativeTimeClick={this.props.onGraphTimeClick}\n        currentTime={this.props.seekTime}\n        onDragStart={this.onGraphDragStart}\n        onDragEnd={this.onGraphDragEnd}\n        container={this.plotListRef.current}\n        dragPos={isDragging ? this.state.dragPos : null}\n        canReceiveGraphDrop={canReceiveGraphDrop}\n        plottedSignals={plottedSignals}\n        live={this.props.live}\n      />\n    );\n  }\n\n  render() {\n    return (\n      <div\n        className=\"cabana-explorer-visuals-plots\"\n        ref={ this.plotListRef }\n        onMouseMove={this.onMouseMove}\n        onMouseLeave={this.onGraphDragEnd}\n        onMouseUp={this.onGraphDragEnd}\n      >\n        {this.props.plottedSignals.map(this.renderSignalPlot)}\n      </div>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport Hls from '@commaai/hls.js';\n\nexport default class HLS extends Component {\n  static propTypes = {\n    source: PropTypes.string.isRequired,\n    startTime: PropTypes.number.isRequired,\n    playbackSpeed: PropTypes.number.isRequired,\n    playing: PropTypes.bool.isRequired,\n    onVideoElementAvailable: PropTypes.func,\n    onClick: PropTypes.func,\n    onLoadStart: PropTypes.func,\n    onLoadEnd: PropTypes.func,\n    onPlaySeek: PropTypes.func,\n    onRestart: PropTypes.func\n  };\n\n  componentDidUpdate(prevProps) {\n    this.videoElement.playbackRate = this.props.playbackSpeed;\n\n    if (prevProps.source !== this.props.source) {\n      this.loadSource(this.props.source);\n    }\n    if (this.props.playing) {\n      if (this.videoElement && (this.videoElement.paused || this.videoElement.currentTime < 0.01)) {\n        this.videoElement.play();\n      }\n    } else {\n      this.videoElement.pause();\n    }\n  }\n\n  componentDidMount() {\n    this.player = new Hls({\n      enableWorker: false,\n      disablePtsDtsCorrectionInMp4Remux: false,\n    });\n    this.player.on(Hls.Events.ERROR, (event, data) => {\n      if (data.fatal) {\n        switch (data.type) {\n          case Hls.ErrorTypes.NETWORK_ERROR:\n          // try to recover network error\n            console.log('fatal network error encountered, try to recover');\n            this.player.startLoad();\n            break;\n          case Hls.ErrorTypes.MEDIA_ERROR:\n            console.log('fatal media error encountered, try to recover');\n            this.player.recoverMediaError();\n            break;\n          default:\n          // cannot recover\n            this.player.destroy();\n            this.player = null;\n            break;\n        }\n      }\n    });\n    this.loadSource();\n  }\n\n  onSeeking = () => {\n    if (!this.props.playing) {\n      this.props.onLoadStart();\n      this.props.onPlaySeek(this.videoElement.currentTime);\n    }\n  };\n\n  // legacy outer scope variable. Revisit this to see if putting in state\n  // makes more sense\n  shouldInitVideoTime = true;\n\n  onSeeked = () => {\n    if (!this.props.playing) {\n      this.props.onLoadEnd();\n    }\n  };\n\n  onLoadedData = () => {\n    if (this.shouldInitVideoTime) {\n      this.videoElement.currentTime = this.props.startTime;\n      this.shouldInitVideoTime = false;\n    }\n  };\n\n  loadSource(source = this.props.source) {\n    if (this.videoElement) {\n      this.player.loadSource(source);\n      this.player.attachMedia(this.videoElement);\n      this.props.onVideoElementAvailable(this.videoElement);\n    }\n  }\n\n  componentWillUnmount() {\n    // destroy hls video source\n    if (this.player) {\n      this.player.destroy();\n      this.player = null;\n    }\n  }\n\n  render() {\n    return (\n      <div\n        className=\"cabana-explorer-visuals-camera-wrapper\"\n        onClick={this.props.onClick}\n      >\n        <video\n          ref={(video) => {\n            this.videoElement = video;\n          }}\n          autoPlay={this.props.playing}\n          muted\n          onWaiting={this.props.onLoadStart}\n          onPlaying={this.props.onLoadEnd}\n          onSeeking={this.onSeeking}\n          onSeeked={this.onSeeked}\n          onLoadedData={this.onLoadedData}\n        />\n      </div>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\n\nexport default class PlayButton extends Component {\n  static propTypes = {\n    onPlay: PropTypes.func,\n    onPause: PropTypes.func,\n    isPlaying: PropTypes.bool,\n    className: PropTypes.string\n  };\n\n  constructor(props) {\n    super(props);\n    this.state = { hover: false };\n\n    this.onClick = this.onClick.bind(this);\n  }\n\n  imageSource() {\n    const { hover } = this.state;\n    const { isPlaying } = this.props;\n    if (isPlaying) {\n      if (hover) {\n        return `${process.env.PUBLIC_URL}/img/ic_pause_circle_filled_white_24px.svg`;\n      }\n      return `${process.env.PUBLIC_URL}/img/ic_pause_circle_outline_white_24px.svg`;\n    }\n    if (hover) {\n      return `${process.env.PUBLIC_URL}/img/ic_play_circle_filled_white_24px.svg`;\n    }\n    return `${process.env.PUBLIC_URL}/img/ic_play_circle_outline_white_24px.svg`;\n  }\n\n  onClick(e) {\n    const { isPlaying } = this.props;\n\n    if (!isPlaying) {\n      this.props.onPlay();\n    } else {\n      this.props.onPause();\n    }\n  }\n\n  render() {\n    return (\n      <img\n        src={this.imageSource()}\n        alt={this.props.isPlaying ? 'Pause' : 'Play'}\n        className={this.props.className}\n        onClick={this.onClick}\n        onMouseOver={() => this.setState({ hover: true })}\n        onMouseLeave={() => this.setState({ hover: false })}\n      />\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport PlayButton from '../PlayButton';\nimport debounce from '../../utils/debounce';\n\nexport default class RouteSeeker extends Component {\n  static propTypes = {\n    videoLength: PropTypes.number.isRequired,\n    segmentIndices: PropTypes.arrayOf(PropTypes.number),\n    segment: PropTypes.arrayOf(PropTypes.number),\n    onUserSeek: PropTypes.func,\n    onPlaySeek: PropTypes.func,\n    video: PropTypes.node,\n    onPause: PropTypes.func,\n    onPlay: PropTypes.func,\n    playing: PropTypes.bool,\n    segmentProgress: PropTypes.func,\n    ratioTime: PropTypes.func,\n    nearestFrameTime: PropTypes.number\n  };\n\n  static hiddenMarkerStyle = { display: 'none', left: 0 };\n\n  static zeroSeekedBarStyle = { width: 0 };\n\n  static hiddenTooltipStyle = { display: 'none', left: 0 };\n\n  static markerWidth = 20;\n\n  static tooltipWidth = 50;\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      seekedBarStyle: RouteSeeker.zeroSeekedBarStyle,\n      markerStyle: RouteSeeker.hiddenMarkerStyle,\n      tooltipStyle: RouteSeeker.hiddenTooltipStyle,\n      ratio: 0,\n      tooltipTime: '0:00',\n      isPlaying: false,\n      isDragging: false\n    };\n\n    this.onMouseMove = this.onMouseMove.bind(this);\n    this.onMouseLeave = this.onMouseLeave.bind(this);\n    this.onMouseDown = this.onMouseDown.bind(this);\n    this.onMouseUp = this.onMouseUp.bind(this);\n    this.onClick = this.onClick.bind(this);\n    this.onPlay = this.onPlay.bind(this);\n    this.onPause = this.onPause.bind(this);\n    this.executePlayTimer = this.executePlayTimer.bind(this);\n  }\n\n  componentDidUpdate(prevProps) {\n    if (JSON.stringify(prevProps.segmentIndices) !== JSON.stringify(this.props.segmentIndices)) {\n      this.setState({\n        seekedBarStyle: RouteSeeker.zeroSeekedBarStyle,\n        markerStyle: RouteSeeker.hiddenMarkerStyle,\n        ratio: 0\n      });\n    } else if (this.props.videoLength && prevProps.videoLength !== this.props.videoLength) {\n      // adjust ratio in line with new videoLength\n      const secondsSeeked = this.state.ratio * prevProps.videoLength;\n      const newRatio = secondsSeeked / this.props.videoLength;\n      this.updateSeekedBar(newRatio);\n    }\n\n    if (prevProps.nearestFrameTime !== this.props.nearestFrameTime) {\n      const newRatio = this.props.segmentProgress(this.props.nearestFrameTime);\n      this.updateSeekedBar(newRatio);\n    }\n\n    if (prevProps.playing !== this.props.isPlaying) {\n      if (this.props.playing && !this.state.isPlaying) {\n        this.onPlay();\n      } else if (!this.props.playing && this.state.isPlaying) {\n        this.onPause();\n      }\n    }\n  }\n\n  componentWillUnmount() {\n    window.cancelAnimationFrame(this.playTimer);\n  }\n\n  mouseEventXOffsetPercent(e) {\n    const rect = this.progressBar.getBoundingClientRect();\n    const x = e.clientX - rect.left;\n\n    return 100 * (x / this.progressBar.offsetWidth);\n  }\n\n  updateDraggingSeek = debounce((ratio) => this.props.onUserSeek(ratio), 250);\n\n  onMouseMove(e) {\n    const markerOffsetPct = this.mouseEventXOffsetPercent(e);\n    if (markerOffsetPct < 0) {\n      this.onMouseLeave();\n      return;\n    }\n    const { markerWidth } = RouteSeeker;\n\n    const markerLeft = `calc(${markerOffsetPct}% - ${markerWidth / 2}px)`;\n    const markerStyle = {\n      display: '',\n      left: markerLeft\n    };\n    const { tooltipWidth } = RouteSeeker;\n    const tooltipLeft = `calc(${markerOffsetPct}% - ${tooltipWidth / 2}px)`;\n\n    const tooltipStyle = { display: 'flex', left: tooltipLeft };\n    const ratio = Math.max(0, markerOffsetPct / 100);\n    if (this.state.isDragging) {\n      this.updateSeekedBar(ratio);\n      this.updateDraggingSeek(ratio);\n    }\n\n    this.setState({\n      markerStyle,\n      tooltipStyle,\n      tooltipTime: this.props.ratioTime(ratio).toFixed(3)\n    });\n  }\n\n  onMouseLeave(e) {\n    this.setState({\n      markerStyle: RouteSeeker.hiddenMarkerStyle,\n      tooltipStyle: RouteSeeker.hiddenTooltipStyle,\n      isDragging: false\n    });\n  }\n\n  updateSeekedBar(ratio) {\n    const seekedBarStyle = { width: `${100 * ratio}%` };\n    this.setState({ seekedBarStyle, ratio });\n  }\n\n  onClick(e) {\n    let ratio = this.mouseEventXOffsetPercent(e) / 100;\n    ratio = Math.min(1, Math.max(0, ratio));\n    this.updateSeekedBar(ratio);\n    this.props.onUserSeek(ratio);\n  }\n\n  onPlay() {\n    this.playTimer = window.requestAnimationFrame(this.executePlayTimer);\n    let { ratio } = this.state;\n    if (ratio >= 1) {\n      ratio = 0;\n    }\n    this.setState({ isPlaying: true, ratio });\n    this.props.onPlay();\n  }\n\n  executePlayTimer() {\n    const { videoElement } = this.props;\n    if (videoElement === null) {\n      this.playTimer = window.requestAnimationFrame(this.executePlayTimer);\n      return;\n    }\n\n    let { videoLength, startTime } = this.props;\n    let { currentTime } = videoElement;\n\n    currentTime = roundTime(currentTime);\n    startTime = roundTime(startTime);\n    videoLength = roundTime(videoLength);\n\n    let newRatio = (currentTime - startTime) / videoLength;\n\n    if (newRatio === this.state.ratio) {\n      this.playTimer = window.requestAnimationFrame(this.executePlayTimer);\n      return;\n    }\n\n    if ((newRatio >= 1 && this.props.segment && this.props.segment.length) || newRatio < 0) {\n      newRatio = 0;\n      currentTime = startTime;\n      this.props.onUserSeek(newRatio);\n    } else if (newRatio >= 1) {\n      videoElement.pause();\n      this.onPause();\n    }\n\n    if (newRatio >= 0) {\n      this.updateSeekedBar(newRatio);\n      this.props.onPlaySeek(currentTime);\n    }\n\n    this.playTimer = window.requestAnimationFrame(this.executePlayTimer);\n  }\n\n  onPause() {\n    window.cancelAnimationFrame(this.playTimer);\n    this.setState({ isPlaying: false });\n    this.props.onPause();\n  }\n\n  onMouseDown() {\n    if (!this.state.isDragging) {\n      this.setState({ isDragging: true });\n    }\n  }\n\n  onMouseUp() {\n    if (this.state.isDragging) {\n      this.setState({ isDragging: false });\n    }\n  }\n\n  render() {\n    const { seekedBarStyle, markerStyle, tooltipStyle } = this.state;\n    return (\n      <div className=\"cabana-explorer-visuals-camera-seeker\">\n        <PlayButton\n          className=\"cabana-explorer-visuals-camera-seeker-playbutton\"\n          onPlay={this.onPlay}\n          onPause={this.onPause}\n          isPlaying={this.state.isPlaying}\n        />\n        <div\n          className=\"cabana-explorer-visuals-camera-seeker-progress\"\n          onMouseMove={this.onMouseMove}\n          onMouseLeave={this.onMouseLeave}\n          onMouseDown={this.onMouseDown}\n          onMouseUp={this.onMouseUp}\n          onClick={this.onClick}\n          ref={(ref) => (this.progressBar = ref)}\n        >\n          <div\n            className=\"cabana-explorer-visuals-camera-seeker-progress-tooltip\"\n            style={tooltipStyle}\n          >\n            {this.state.tooltipTime}\n          </div>\n          <div\n            className=\"cabana-explorer-visuals-camera-seeker-progress-marker\"\n            style={markerStyle}\n          />\n          <div\n            className=\"cabana-explorer-visuals-camera-seeker-progress-inner\"\n            style={seekedBarStyle}\n          />\n        </div>\n      </div>\n    );\n  }\n}\n\nfunction roundTime(time) {\n  return Math.round(time * 1000) / 1000;\n}\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { StyleSheet, css } from 'aphrodite/no-important';\nimport { video as VideoApi } from '@commaai/comma-api';\n\nimport HLS from './HLS';\nimport RouteSeeker from './RouteSeeker/RouteSeeker';\n\nconst Styles = StyleSheet.create({\n  loadingOverlay: {\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    width: '100%',\n    height: '100%',\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n    zIndex: 3\n  },\n  loadingSpinner: {\n    width: '25%',\n    height: '25%',\n    display: 'block'\n  },\n  img: {\n    height: 480,\n    display: 'block',\n    position: 'absolute',\n    zIndex: 2\n  },\n  hls: {\n    zIndex: 1,\n    height: 480,\n    backgroundColor: 'rgba(0,0,0,0.9)'\n  },\n  seekBar: {\n    position: 'absolute',\n    bottom: 0,\n    left: 0,\n    width: '100%',\n    zIndex: 4\n  }\n});\n\nexport default class RouteVideoSync extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isLoading: true,\n      videoElement: null,\n      source: null,\n    };\n\n    this.onLoadStart = this.onLoadStart.bind(this);\n    this.onLoadEnd = this.onLoadEnd.bind(this);\n    this.segmentProgress = this.segmentProgress.bind(this);\n    this.onVideoElementAvailable = this.onVideoElementAvailable.bind(this);\n    this.onUserSeek = this.onUserSeek.bind(this);\n    this.onPlaySeek = this.onPlaySeek.bind(this);\n    this.ratioTime = this.ratioTime.bind(this);\n  }\n\n  componentDidMount() {\n    this.componentDidUpdate({}, {});\n  }\n\n  componentDidUpdate(prevProps) {\n    const { userSeekTime, route, share } = this.props;\n    const { videoElement } = this.state;\n\n    if (\n      prevProps.userSeekTime\n      && userSeekTime !== prevProps.userSeekTime\n    ) {\n      if (videoElement) {\n        videoElement.currentTime = userSeekTime - this.props.videoOffset;\n      }\n    }\n\n    if (route && (prevProps.route?.fullname !== route.fullname || prevProps.share !== share)) {\n      const src = VideoApi.getQcameraStreamUrl(route.fullname, share?.exp, share?.sig);\n      this.setState({ source: src });\n    }\n  }\n\n  onVideoElementAvailable(videoElement) {\n    this.setState({ videoElement });\n  }\n\n  onUserSeek(ratio) {\n    /* ratio in [0,1] */\n\n    const { videoElement } = this.state;\n    const { onUserSeek } = this.props;\n    const seekTime = this.ratioTime(ratio);\n    const funcSeekToRatio = () => onUserSeek(seekTime);\n\n    if (Number.isNaN(videoElement.duration)) {\n      return;\n    }\n    videoElement.currentTime = seekTime - this.props.videoOffset;\n\n    if (ratio !== 0) {\n      funcSeekToRatio();\n    }\n  }\n\n  onPlaySeek(offset) {\n    this.seekTime = offset + this.props.videoOffset;\n    this.props.onPlaySeek(this.seekTime);\n  }\n\n  onLoadStart() {\n    this.setState({\n      isLoading: true\n    });\n  }\n\n  onLoadEnd() {\n    this.setState({\n      isLoading: false\n    });\n  }\n\n  loadingOverlay() {\n    return (\n      <div className={css(Styles.loadingOverlay)}>\n        <img\n          className={css(Styles.loadingSpinner)}\n          src={`${process.env.PUBLIC_URL}/img/loading.svg`}\n          alt=\"Loading video\"\n        />\n      </div>\n    );\n  }\n\n  videoLength() {\n    if (this.props.segment.length) {\n      return this.props.segment[1] - this.props.segment[0];\n    }\n\n    if (this.state.videoElement) {\n      return this.state.videoElement.duration;\n    }\n\n    return 0;\n  }\n\n  startTime() {\n    if (this.props.segment.length) {\n      return this.props.segment[0];\n    }\n\n    return 0;\n  }\n\n  segmentProgress(currentTime) {\n    // returns progress as number in [0,1]\n    const startTime = this.startTime();\n\n    if (currentTime < startTime) {\n      currentTime = startTime;\n    }\n\n    const ratio = (currentTime - startTime) / this.videoLength();\n    return Math.max(0, Math.min(1, ratio));\n  }\n\n  ratioTime(ratio) {\n    return ratio * this.videoLength() + this.startTime();\n  }\n\n  render() {\n    const {\n      isLoading,\n      videoElement,\n    } = this.state;\n    const {\n      userSeekTime,\n      playSpeed,\n      playing,\n      onVideoClick,\n      segmentIndices,\n      startTime,\n      segment\n    } = this.props;\n\n    return (\n      <div className=\"cabana-explorer-visuals-camera\">\n        {isLoading ? this.loadingOverlay() : null}\n        {this.state.source && <HLS\n          className={css(Styles.hls)}\n          source={this.state.source}\n          startTime={(startTime || 0) - this.props.videoOffset}\n          videoLength={this.videoLength()}\n          playbackSpeed={playSpeed}\n          onVideoElementAvailable={this.onVideoElementAvailable}\n          playing={playing}\n          onClick={onVideoClick}\n          onLoadStart={this.onLoadStart}\n          onLoadEnd={this.onLoadEnd}\n          onUserSeek={this.onUserSeek}\n          onPlaySeek={this.onPlaySeek}\n        />}\n        <RouteSeeker\n          className={css(Styles.seekBar)}\n          nearestFrameTime={userSeekTime}\n          segmentProgress={this.segmentProgress}\n          startTime={this.startTime() - this.props.videoOffset}\n          videoLength={this.videoLength()}\n          segmentIndices={segmentIndices}\n          onUserSeek={this.onUserSeek}\n          onPlaySeek={this.onPlaySeek}\n          videoElement={videoElement}\n          onPlay={this.props.onPlay}\n          onPause={this.props.onPause}\n          playing={this.props.playing}\n          ratioTime={this.ratioTime}\n          segment={segment}\n        />\n      </div>\n    );\n  }\n}\n\nRouteVideoSync.propTypes = {\n  segment: PropTypes.array.isRequired,\n  maxqcamera: PropTypes.number,\n  thumbnails: PropTypes.array,\n  url: PropTypes.string.isRequired,\n  playing: PropTypes.bool.isRequired,\n  onPlaySeek: PropTypes.func.isRequired,\n  onUserSeek: PropTypes.func.isRequired,\n  onPlay: PropTypes.func.isRequired,\n  onPause: PropTypes.func.isRequired,\n  userSeekTime: PropTypes.number.isRequired,\n  playSpeed: PropTypes.number.isRequired,\n  onVideoClick: PropTypes.func,\n  segmentIndices: PropTypes.array,\n  startTime: PropTypes.number,\n  route: PropTypes.object,\n  share: PropTypes.object,\n};\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport ReactList from 'react-list';\n\nimport cx from 'classnames';\n\nexport default class CanLog extends Component {\n  static ITEMS_PER_PAGE = 50;\n\n  static propTypes = {\n    plottedSignals: PropTypes.array,\n    segmentIndices: PropTypes.array,\n    onSignalUnplotPressed: PropTypes.func,\n    onSignalPlotPressed: PropTypes.func,\n    message: PropTypes.object,\n    messageIndex: PropTypes.number,\n    onMessageExpanded: PropTypes.func\n  };\n\n  constructor(props) {\n    super(props);\n    // only want to display up to length elements at a time\n    // offset, length\n\n    this.state = {\n      length: 0,\n      expandedMessages: [],\n      messageHeights: [],\n      allPacketsExpanded: false\n    };\n\n    this.renderLogListItemMessage = this.renderLogListItemMessage.bind(this);\n    this.addDisplayedMessages = this.addDisplayedMessages.bind(this);\n    this.renderLogListItem = this.renderLogListItem.bind(this);\n    this.renderLogList = this.renderLogList.bind(this);\n    this.onExpandAllChanged = this.onExpandAllChanged.bind(this);\n    this.toggleExpandAllPackets = this.toggleExpandAllPackets.bind(this);\n    this.toggleSignalPlot = this.toggleSignalPlot.bind(this);\n  }\n\n  componentDidUpdate(prevProps) {\n    if (!prevProps.message && this.props.message) {\n      this.addDisplayedMessages();\n    }\n  }\n\n  shouldComponentUpdate(nextProps, nextState) {\n    const curMessageLength = this.props.message\n      ? this.props.message.entries.length\n      : 0;\n    const nextMessageLength = nextProps.message\n      ? nextProps.message.entries.length\n      : 0;\n\n    const shouldUpdate = this.props.message !== nextProps.message\n      || nextMessageLength !== curMessageLength\n      || nextProps.messageIndex !== this.props.messageIndex\n      || nextProps.plottedSignals.length !== this.props.plottedSignals.length\n      || JSON.stringify(nextProps.segmentIndices)\n        !== JSON.stringify(this.props.segmentIndices)\n      || JSON.stringify(nextState) !== JSON.stringify(this.state)\n      || this.props.message !== nextProps.message\n      || (this.props.message !== undefined\n        && nextProps.message !== undefined\n        && this.props.message.frame !== undefined\n        && nextProps.message.frame !== undefined\n        && JSON.stringify(this.props.message.frame)\n          !== JSON.stringify(nextProps.message.frame));\n\n    return shouldUpdate;\n  }\n\n  addDisplayedMessages() {\n    const { length } = this.state;\n    const newLength = length + CanLog.ITEMS_PER_PAGE;\n\n    this.setState({ length: newLength });\n  }\n\n  expandMessage(msg, msgIdx) {\n    this.setState({\n      expandedMessages: this.state.expandedMessages.concat([msg.time])\n    });\n    this.props.onMessageExpanded();\n  }\n\n  collapseMessage(msg, msgIdx) {\n    this.setState({\n      expandedMessages: this.state.expandedMessages.filter(\n        (expMsgTime) => expMsgTime !== msg.time\n      )\n    });\n  }\n\n  isSignalPlotted(msgId, signalUid) {\n    const plottedSignal = this.props.plottedSignals.find((plot) => plot.some(\n      (signal) => signal.messageId === msgId && signal.signalUid === signalUid\n    ));\n    return plottedSignal !== undefined;\n  }\n\n  signalValuePretty(signal, value) {\n    if (signal.isFloat) {\n      return value.toFixed(3);\n    }\n    if (typeof value === 'bigint') {\n      return value.toString();\n    }\n    return value;\n  }\n\n  isMessageExpanded(msg) {\n    return this.state.expandedMessages.indexOf(msg.time) !== -1;\n  }\n\n  toggleSignalPlot(msg, signalUid, plotted) {\n    if (!plotted) {\n      this.props.onSignalPlotPressed(msg, signalUid);\n    } else {\n      this.props.onSignalUnplotPressed(msg, signalUid);\n    }\n  }\n\n  toggleExpandPacketSignals(msgEntry) {\n    if (!this.props.message.frame) {\n      return;\n    }\n    const msgIsExpanded = this.state.allPacketsExpanded || this.isMessageExpanded(msgEntry);\n\n    const msgHasSignals = Object.keys(this.props.message.frame.signals).length > 0;\n    if (msgIsExpanded && msgHasSignals) {\n      this.setState({\n        expandedMessages: this.state.expandedMessages.filter(\n          (expMsgTime) => expMsgTime !== msgEntry.time\n        )\n      });\n    } else if (msgHasSignals) {\n      this.setState({\n        expandedMessages: this.state.expandedMessages.concat([msgEntry.time])\n      });\n      this.props.onMessageExpanded();\n    } else {\n    }\n  }\n\n  renderLogListItemSignals(msgEntry) {\n    const { message } = this.props;\n    return (\n      <div className=\"signals-log-list-signals\">\n        {Object.entries(msgEntry.signals).map(([name, value]) => {\n          const signal = message.frame.signals[name];\n          if (signal === undefined) {\n            // Signal removed?\n            return null;\n          }\n          const unit = signal.unit.length > 0 ? signal.unit : 'units';\n          const isPlotted = this.isSignalPlotted(message.id, signal.uid);\n          const plottedButtonClass = isPlotted ? null : 'button--alpha';\n          const plottedButtonText = isPlotted ? 'Hide Plot' : 'Show Plot';\n          return (\n            <div key={name} className=\"signals-log-list-signal\">\n              <div className=\"signals-log-list-signal-message\">\n                <span>{name}</span>\n              </div>\n              <div className=\"signals-log-list-signal-value\">\n                <span>\n                  (\n                  <strong>{this.signalValuePretty(signal, value)}</strong>\n                  {' '}\n                  {unit}\n)\n                </span>\n              </div>\n              <div\n                className=\"signals-log-list-signal-action\"\n                onClick={() => {\n                  this.toggleSignalPlot(message.id, signal.uid, isPlotted);\n                }}\n              >\n                <button className={cx('button--tiny', plottedButtonClass)}>\n                  <span>{plottedButtonText}</span>\n                </button>\n              </div>\n            </div>\n          );\n        })}\n      </div>\n    );\n  }\n\n  renderLogListItemMessage(msgEntry, key) {\n    const { message } = this.props;\n    const msgIsExpanded = this.state.allPacketsExpanded || this.isMessageExpanded(msgEntry);\n    const msgHasSignals = Object.keys(msgEntry.signals).length > 0;\n    const hasSignalsClass = msgHasSignals ? 'has-signals' : null;\n    const expandedClass = msgIsExpanded ? 'is-expanded' : null;\n\n    const msgHexs = [];\n    for (let i = 0; i < msgEntry.data.length; i += 8) {\n      msgHexs.push(msgEntry.hexData.substring(2 * i, 2 * Math.min(i + 8, msgEntry.data.length)));\n    }\n\n    const row = (\n      <div\n        key={key}\n        className={cx('signals-log-list-item', hasSignalsClass, expandedClass)}\n      >\n        <div\n          className=\"signals-log-list-item-header\"\n          onClick={() => {\n            this.toggleExpandPacketSignals(msgEntry);\n          }}\n        >\n          <div className=\"signals-log-list-message\">\n            <strong>\n              {(message.frame ? message.frame.name : null) || message.id}\n            </strong>\n          </div>\n          <div className=\"signals-log-list-time\">\n            <span>[{msgEntry.relTime.toFixed(3)}]</span>\n          </div>\n          <div className=\"signals-log-list-bytes\">\n            { msgHexs.map((hx, i) => <span key={ i } className=\"t-mono\">{ hx }</span> )}\n          </div>\n        </div>\n        <div className=\"signals-log-list-item-body\">\n          {msgIsExpanded ? this.renderLogListItemSignals(msgEntry) : null}\n        </div>\n      </div>\n    );\n\n    return row;\n  }\n\n  renderLogListItem(index, key) {\n    let offset = this.props.messageIndex;\n    if (offset === 0 && this.props.segmentIndices.length === 2) {\n      offset = this.props.segmentIndices[0];\n    }\n    if (offset + index < 0) {\n      debugger;\n    }\n    if (offset + index < this.props.message.entries.length) {\n      return this.renderLogListItemMessage(\n        this.props.message.entries[offset + index],\n        key\n      );\n    }\n    return null;\n  }\n\n  renderLogList(items, ref) {\n    return (\n      <div className=\"signals-log-list\">\n        <div className=\"signals-log-list-header\">\n          <div className=\"signals-log-list-message\">Message</div>\n          <div className=\"signals-log-list-time\">Time</div>\n          <div className=\"signals-log-list-bytes\">Bytes</div>\n        </div>\n        <div className=\"signals-log-list-items\" ref={ref}>\n          {items}\n        </div>\n      </div>\n    );\n  }\n\n  listLength() {\n    const { segmentIndices, messageIndex } = this.props;\n    if (messageIndex > 0) {\n      return this.props.message.entries.length - messageIndex;\n    }\n    if (segmentIndices.length === 2) {\n      return segmentIndices[1] - segmentIndices[0];\n    }\n    if (this.props.message) {\n      return this.props.message.entries.length;\n    }\n    // no message yet\n    return 0;\n  }\n\n  onExpandAllChanged(e) {\n    this.setState({ allPacketsExpanded: e.target.checked });\n  }\n\n  toggleExpandAllPackets() {\n    this.setState({ allPacketsExpanded: !this.state.allPacketsExpanded });\n  }\n\n  render() {\n    const expandAllText = this.state.allPacketsExpanded\n      ? 'Collapse All'\n      : 'Expand All';\n    const expandAllClass = this.state.allPacketsExpanded\n      ? null\n      : 'button--alpha';\n    return (\n      <div className=\"cabana-explorer-signals-log\">\n        <div className=\"cabana-explorer-signals-log-header\">\n          <strong>Message Packets</strong>\n          <button\n            className={cx('button--tiny', expandAllClass)}\n            onClick={this.toggleExpandAllPackets}\n          >\n            {expandAllText}\n          </button>\n        </div>\n        <div className=\"cabana-explorer-signals-log-body\">\n          <ReactList\n            itemRenderer={this.renderLogListItem}\n            itemsRenderer={this.renderLogList}\n            length={this.listLength()}\n            pageSize={50}\n            updateWhenThisValueChanges={this.props.messageIndex}\n            type=\"variable\"\n          />\n        </div>\n      </div>\n    );\n  }\n}\n","function findTimeIndex(entries, time) {\n  return entries.findIndex((e) => e.time >= time);\n}\n\nfunction findRelativeTimeIndex(entries, relTime) {\n  return entries.findIndex((e) => e.relTime >= relTime);\n}\n\nfunction findSegmentIndices(\n  entries,\n  [segmentTimeLow, segmentTimeHi],\n  isRelative\n) {\n  /*\n    Finds pair of indices (inclusive, exclusive) within entries array\n    whose timestamps match segmentTimeLow and segmentTimeHi.\n    if isRelative === true, then the segment times\n    are assumed to correspond to the `relTime` field of each entry.\n\n    Returns `[segmentIdxLow, segmentIdxHigh]`\n             (inclusive, exclusive)\n    */\n  const timeIndexFunc = isRelative === true ? findRelativeTimeIndex : findTimeIndex;\n\n  const segmentIdxLow = Math.max(0, timeIndexFunc(entries, segmentTimeLow));\n\n  const upperSegments = entries.slice(segmentIdxLow);\n  const upperSegmentIdxHi = timeIndexFunc(upperSegments, segmentTimeHi);\n  const segmentIdxHi = upperSegmentIdxHi >= 0\n    ? upperSegmentIdxHi + segmentIdxLow + 1\n    : entries.length - 1;\n\n  return [\n    segmentIdxLow,\n    Math.max(0, Math.min(segmentIdxHi, entries.length - 1))\n  ];\n}\n\nexport default { findTimeIndex, findRelativeTimeIndex, findSegmentIndices };\n","import React, { Component } from 'react';\n\nexport default class PlaySpeedSelector extends Component {\n  constructor(props) {\n    super(props);\n    this.onChange = this.onChange.bind(this);\n  }\n\n  onChange(value) {\n    if (this.props.onPlaySpeedChanged) {\n      this.props.onPlaySpeedChanged(Number(value.currentTarget.value));\n    }\n  }\n\n  render() {\n    return (\n      <div\n        style={{\n          display: 'inline-block',\n          float: 'right',\n          margin: 10\n        }}\n      >\n        <label>Play speed:&nbsp;</label>\n        <select\n          id=\"playSpeed\"\n          style={{\n            width: 70\n          }}\n          onChange={this.onChange}\n          value={this.props.playSpeed}\n        >\n          <option value=\"0.1\">0.1x</option>\n          <option value=\"0.5\">0.5x</option>\n          <option value=\"1\">1x</option>\n          <option value=\"2\">2x</option>\n        </select>\n      </div>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\n\nimport cx from 'classnames';\n\nimport AddSignals from './AddSignals';\nimport CanGraphList from './CanGraphList';\nimport RouteVideoSync from './RouteVideoSync';\nimport CanLog from './CanLog';\nimport Entries from '../models/can/entries';\nimport debounce from '../utils/debounce';\nimport PlaySpeedSelector from './PlaySpeedSelector';\n\nfunction clipSegment(_segment, _segmentIndices, nextMessage) {\n  let segment = _segment;\n  let segmentIndices = _segmentIndices;\n  if (segment.length === 2) {\n    const segmentStartIdx = nextMessage.entries.findIndex(\n      (e) => e.relTime >= segment[0]\n    );\n    let segmentEndIdx = nextMessage.entries.findIndex(\n      (e) => e.relTime >= segment[1]\n    );\n    if (segmentStartIdx !== -1) {\n      if (segmentEndIdx === -1) {\n        // previous segment end is past bounds of this message\n        segmentEndIdx = nextMessage.entries.length - 1;\n      }\n      const segmentStartTime = nextMessage.entries[segmentStartIdx].relTime;\n      const segmentEndTime = nextMessage.entries[segmentEndIdx].relTime;\n\n      segment = [segmentStartTime, segmentEndTime];\n      segmentIndices = [segmentStartIdx, segmentEndIdx];\n    } else {\n      // segment times are out of boudns for this message\n      segment = [];\n      segmentIndices = [];\n    }\n  }\n\n  return { segment, segmentIndices };\n}\n\nexport default class Explorer extends Component {\n  updateSegment = debounce((messageId, _segment) => {\n    let segment = _segment;\n    const { messages, selectedMessage, currentParts } = this.props;\n    const { entries } = messages[selectedMessage];\n    let segmentIndices = Entries.findSegmentIndices(entries, segment, true);\n\n    // console.log(this.state.segment, '->', segment, segmentIndices);\n    if (\n      segment[0] === currentParts[0] * 60\n      && segment[1] === (currentParts[1] + 1) * 60\n    ) {\n      segment = [];\n      segmentIndices = [];\n    }\n    let { userSeekTime } = this.state;\n    if (segment.length) {\n      userSeekTime = Math.max(segment[0], userSeekTime);\n      userSeekTime = Math.min(segment[1], userSeekTime);\n    } else {\n      userSeekTime = Math.max(currentParts[0] * 60, userSeekTime);\n      userSeekTime = Math.min(currentParts[1] * 60, userSeekTime);\n    }\n    this.setState({\n      segment,\n      segmentIndices,\n      userSeekIndex: segmentIndices[0],\n      userSeekTime\n    });\n  }, 250);\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      plottedSignals: [],\n      segment: props.startSegments || [],\n      segmentIndices: [],\n      shouldShowAddSignal: true,\n      userSeekIndex: 0,\n      userSeekTime: 0,\n      playing: props.autoplay,\n      playSpeed: 1\n    };\n\n    this.onSignalPlotPressed = this.onSignalPlotPressed.bind(this);\n    this.onSignalUnplotPressed = this.onSignalUnplotPressed.bind(this);\n    this.onSegmentChanged = this.onSegmentChanged.bind(this);\n    this.showAddSignal = this.showAddSignal.bind(this);\n    this.onGraphTimeClick = this.onGraphTimeClick.bind(this);\n    this.onUserSeek = this.onUserSeek.bind(this);\n    this.onPlaySeek = this.onPlaySeek.bind(this);\n    this.onPlay = this.onPlay.bind(this);\n    this.onPause = this.onPause.bind(this);\n    this.onVideoClick = this.onVideoClick.bind(this);\n    this.onSignalPlotChange = this.onSignalPlotChange.bind(this);\n    this.onKeyDown = this.onKeyDown.bind(this);\n    this.mergePlots = this.mergePlots.bind(this);\n    this.toggleShouldShowAddSignal = this.toggleShouldShowAddSignal.bind(this);\n    this.changePlaySpeed = this.changePlaySpeed.bind(this);\n  }\n\n  componentDidMount() {\n    document.addEventListener('keydown', this.onKeyDown);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('keydown', this.onKeyDown);\n  }\n\n  onKeyDown(e) {\n    if (e.keyCode === 27) {\n      // escape\n      this.resetSegment();\n    }\n  }\n\n  componentDidUpdate(prevProps) {\n    const prevMessage = prevProps.messages[prevProps.selectedMessage];\n    const curMessage = this.props.messages[this.props.selectedMessage];\n\n    if (Object.keys(prevProps.messages).length === 0 && Object.keys(this.props.messages).length !== 0) {\n      this.resetSegment();\n    }\n\n    if (curMessage && curMessage.frame && prevMessage !== curMessage) {\n      if (Object.keys(curMessage.frame.signals).length === 0) {\n        this.setState({ shouldShowAddSignal: true });\n      }\n    }\n\n    // remove plottedSignals that no longer exist\n    const newPlottedSignals = this.state.plottedSignals\n      .map((plot) => plot.filter(({ messageId, signalUid }) => {\n        const messageExists = Boolean(this.props.messages[messageId]);\n        let signalExists = true;\n        if (messageExists) {\n          signalExists = Object.values(this.props.messages[messageId].frame.signals)\n            .some((signal) => signal.uid === signalUid);\n        }\n\n        return messageExists && signalExists;\n      }))\n      .filter((plot) => plot.length > 0);\n\n    if (this.state.plottedSignals.length !== newPlottedSignals.length) {\n      this.setState({ plottedSignals: newPlottedSignals });\n    }\n\n    if (this.props.selectedMessage && prevProps.selectedMessage !== this.props.selectedMessage) {\n      // Update segment and seek state by finding a entry indices corresponding to old message segment/seek times.\n\n      const { segment, segmentIndices } = clipSegment(\n        this.state.segment,\n        this.state.segmentIndices,\n        curMessage\n      );\n\n      this.setState({\n        segment,\n        segmentIndices,\n        userSeekIndex: this.props.seekIndex,\n      });\n    }\n\n    if (prevMessage && curMessage && prevMessage.entries.length !== curMessage.entries.length) {\n      const { segment, segmentIndices } = clipSegment(\n        this.state.segment,\n        this.state.segmentIndices,\n        curMessage\n      );\n      this.setState({ segment, segmentIndices });\n    }\n  }\n\n  changePlaySpeed(value) {\n    this.setState({\n      playSpeed: value\n    });\n  }\n\n  timeWindow() {\n    const { routeStartTime, currentParts } = this.props;\n\n    if (routeStartTime) {\n      const partStartOffset = currentParts[0] * 60;\n      const partEndOffset = (currentParts[1] + 1) * 60;\n\n      const windowStartTime = routeStartTime\n        .clone()\n        .add(partStartOffset, 's')\n        .format('HH:mm:ss');\n      const windowEndTime = routeStartTime\n        .clone()\n        .add(partEndOffset, 's')\n        .format('HH:mm:ss');\n\n      return `${windowStartTime} - ${windowEndTime}`;\n    }\n    return '';\n  }\n\n  onSignalPlotPressed(messageId, signalUid) {\n    let { plottedSignals } = this.state;\n\n    plottedSignals = [[{ messageId, signalUid }], ...plottedSignals];\n\n    this.setState({ plottedSignals });\n  }\n\n  onSignalUnplotPressed(messageId, signalUid) {\n    const { plottedSignals } = this.state;\n    const newPlottedSignals = plottedSignals\n      .map((plot) => plot.filter(\n        (signal) => !(signal.messageId === messageId && signal.signalUid === signalUid)\n      ))\n      .filter((plot) => plot.length > 0);\n\n    this.setState({ plottedSignals: newPlottedSignals });\n  }\n\n  onSegmentChanged(messageId, segment) {\n    if (Array.isArray(segment)) {\n      this.updateSegment(messageId, segment);\n    }\n  }\n\n  resetSegment() {\n    const { segment, segmentIndices } = this.state;\n    if (segment.length > 0 || segmentIndices.length > 0) {\n      // console.log(this.state.segment, '->', segment, segmentIndices);\n      this.setState({\n        segment: [],\n        segmentIndices: [],\n        userSeekIndex: 0\n      });\n    }\n  }\n\n  showAddSignal() {\n    this.setState({ shouldShowAddSignal: true });\n  }\n\n  toggleShouldShowAddSignal() {\n    this.setState({ shouldShowAddSignal: !this.state.shouldShowAddSignal });\n  }\n\n  indexFromSeekTime(time) {\n    // returns index guaranteed to be in [0, entries.length - 1]\n\n    const { entries } = this.props.messages[this.props.selectedMessage];\n    if (entries.length === 0) return null;\n\n    const { segmentIndices } = this.state;\n    if (segmentIndices.length === 2 && segmentIndices[0] >= 0) {\n      for (\n        let i = segmentIndices[0],\n          l = Math.min(entries.length - 1, segmentIndices[1]);\n        i <= l;\n        i++\n      ) {\n        if (entries[i].relTime >= time) {\n          return i;\n        }\n      }\n      return segmentIndices[1];\n    }\n    for (let i = 0; i < entries.length; i++) {\n      if (entries[i].relTime >= time) {\n        return i;\n      }\n    }\n    return entries.length - 1;\n  }\n\n  onUserSeek(time) {\n    this.props.onUserSeek(time);\n    this.setState({ userSeekTime: time });\n  }\n\n  onPlaySeek(time) {\n    const message = this.props.messages[this.props.selectedMessage];\n    if (!message || message.entries.length === 0) {\n      this.props.onSeek(0, time);\n      return;\n    }\n\n    const seekIndex = this.indexFromSeekTime(time);\n    const seekTime = time;\n    this.props.onSeek(seekIndex, seekTime);\n  }\n\n  onGraphTimeClick(messageId, time) {\n    this.onUserSeek(time);\n  }\n\n  onPlay() {\n    this.setState({ playing: true });\n  }\n\n  onPause() {\n    this.setState({ playing: false });\n  }\n\n  secondsLoadedRouteRelative(currentParts) {\n    return (currentParts[1] - currentParts[0] + 1) * 60;\n  }\n\n  secondsLoaded() {\n    return this.props.partsCount * 60;\n  }\n\n  onVideoClick() {\n    const playing = !this.state.playing;\n    this.setState({ playing });\n  }\n\n  seekTime() {\n    const { userSeekIndex } = this.state;\n    const msg = this.props.messages[this.props.selectedMessage];\n    return msg.entries[userSeekIndex].time;\n  }\n\n  onSignalPlotChange(shouldPlot, messageId, signalUid) {\n    if (shouldPlot) {\n      this.onSignalPlotPressed(messageId, signalUid);\n    } else {\n      this.onSignalUnplotPressed(messageId, signalUid);\n    }\n  }\n\n  renderSelectMessagePrompt() {\n    return (\n      <div className=\"cabana-explorer-select-prompt\">\n        <h1>Select a message</h1>\n      </div>\n    );\n  }\n\n  selectedMessagePlottedSignalUids() {\n    const { plottedSignals } = this.state;\n    return plottedSignals\n      .map((plot) => plot\n        .filter(\n          ({ messageId, signalUid }) => messageId === this.props.selectedMessage\n        )\n        .map(({ signalUid }) => signalUid))\n      .reduce((arr, signalUid) => arr.concat(signalUid), []);\n  }\n\n  renderExplorerSignals() {\n    const selectedMessageKey = this.props.selectedMessage;\n    const selectedMessage = this.props.messages[selectedMessageKey];\n    const selectedMessageName = selectedMessage.frame !== undefined\n      ? selectedMessage.frame.name\n      : 'undefined';\n    return (\n      <div className=\"cabana-explorer-signals-wrapper\">\n        <div className=\"cabana-explorer-signals-header\">\n          <div className=\"cabana-explorer-signals-header-context\">\n            <h5 className=\"t-capline\">Selected Message:</h5>\n            <h3>{selectedMessageName}</h3>\n          </div>\n          <div className=\"cabana-explorer-signals-header-action\">\n            <button\n              className=\"button--small\"\n              onClick={() => this.props.showEditMessageModal(selectedMessageKey)}\n            >\n              Edit\n            </button>\n          </div>\n        </div>\n        <div\n          className=\"cabana-explorer-signals-subheader\"\n          onClick={this.toggleShouldShowAddSignal}\n        >\n          <strong>Edit Signals</strong>\n        </div>\n        <div className=\"cabana-explorer-signals-window\">\n          {this.state.shouldShowAddSignal ? (\n            <AddSignals\n              onConfirmedSignalChange={this.props.onConfirmedSignalChange}\n              message={this.props.messages[this.props.selectedMessage]}\n              onClose={() => {\n                this.setState({ shouldShowAddSignal: false });\n              }}\n              messageIndex={this.props.seekIndex}\n              onSignalPlotChange={this.onSignalPlotChange}\n              plottedSignalUids={this.selectedMessagePlottedSignalUids()}\n              selectedMessageKey={selectedMessageKey}\n            />\n          ) : null}\n          <CanLog\n            message={this.props.messages[this.props.selectedMessage]}\n            messageIndex={this.props.seekIndex}\n            segmentIndices={this.state.segmentIndices}\n            plottedSignals={this.state.plottedSignals}\n            onSignalPlotPressed={this.onSignalPlotPressed}\n            onSignalUnplotPressed={this.onSignalUnplotPressed}\n            showAddSignal={this.showAddSignal}\n            onMessageExpanded={this.onPause}\n          />\n        </div>\n      </div>\n    );\n  }\n\n  mergePlots({ fromPlot, toPlot }) {\n    const { plottedSignals } = this.state;\n\n    // remove fromPlot from plottedSignals\n    const fromPlotIdx = plottedSignals.findIndex((plot) => plot.some(\n      (signal) => signal.signalUid === fromPlot.signalUid\n          && signal.messageId === fromPlot.messageId\n    ));\n    plottedSignals.splice(fromPlotIdx, 1);\n\n    const toPlotIdx = plottedSignals.findIndex((plot) => plot.some(\n      (signal) => signal.signalUid === toPlot.signalUid\n          && signal.messageId === toPlot.messageId\n    ));\n    plottedSignals[toPlotIdx] = [fromPlot, toPlot];\n\n    this.setState({ plottedSignals });\n  }\n\n  render() {\n    const signalsExpandedClass = this.state.shouldShowAddSignal\n      ? 'is-expanded'\n      : null;\n\n    const { thumbnails, messages, startTime } = this.props;\n\n    let graphSegment = this.state.segment;\n    if (!graphSegment.length && this.props.currentParts) {\n      graphSegment = [\n        this.props.currentParts[0] * 60,\n        (this.props.currentParts[1] + 1) * 60\n      ];\n    }\n    return (\n      <div className=\"cabana-explorer\">\n        <div className={cx('cabana-explorer-signals', signalsExpandedClass)}>\n          {messages[this.props.selectedMessage]\n            ? this.renderExplorerSignals()\n            : this.renderSelectMessagePrompt()}\n        </div>\n        <div className=\"cabana-explorer-visuals\">\n          {this.props.live === false ? (\n            <div>\n              <div className=\"cabana-explorer-visuals-header g-row\">\n                <PlaySpeedSelector\n                  playSpeed={this.state.playSpeed}\n                  onPlaySpeedChanged={this.changePlaySpeed}\n                />\n              </div>\n              <RouteVideoSync\n                message={messages[this.props.selectedMessage]}\n                segment={this.state.segment}\n                maxqcamera={this.props.maxqcamera}\n                startTime={startTime}\n                seekIndex={this.props.seekIndex}\n                userSeekIndex={this.state.userSeekIndex}\n                playing={this.state.playing}\n                url={this.props.url}\n                firstCanTime={this.props.firstCanTime}\n                videoOffset={this.props.videoOffset}\n                onVideoClick={this.onVideoClick}\n                onPlaySeek={this.onPlaySeek}\n                onUserSeek={this.onUserSeek}\n                onPlay={this.onPlay}\n                onPause={this.onPause}\n                userSeekTime={this.state.userSeekTime}\n                playSpeed={this.state.playSpeed}\n                thumbnails={thumbnails}\n                route={this.props.route}\n                share={this.props.share}\n              />\n            </div>\n          ) : null}\n          {this.state.segment.length > 0 ? (\n            <div\n              className=\"cabana-explorer-visuals-segmentreset\"\n              onClick={() => {\n                this.resetSegment();\n              }}\n            >\n              <p>Reset Segment</p>\n            </div>\n          ) : null}\n          <CanGraphList\n            plottedSignals={this.state.plottedSignals}\n            messages={messages}\n            onGraphTimeClick={this.onGraphTimeClick}\n            seekTime={this.props.seekTime}\n            onSegmentChanged={this.onSegmentChanged}\n            onSignalUnplotPressed={this.onSignalUnplotPressed}\n            segment={graphSegment}\n            mergePlots={this.mergePlots}\n            live={this.props.live}\n          />\n        </div>\n      </div>\n    );\n  }\n}\n\nExplorer.propTypes = {\n  selectedMessage: PropTypes.string,\n  url: PropTypes.string,\n  live: PropTypes.bool.isRequired,\n  messages: PropTypes.objectOf(PropTypes.object),\n  thumbnails: PropTypes.array.isRequired,\n  onConfirmedSignalChange: PropTypes.func.isRequired,\n  canFrameOffset: PropTypes.number,\n  firstCanTime: PropTypes.number,\n  onSeek: PropTypes.func.isRequired,\n  autoplay: PropTypes.bool.isRequired,\n  currentParts: PropTypes.array.isRequired,\n  partsCount: PropTypes.number,\n  maxqcamera: PropTypes.number,\n  startTime: PropTypes.number,\n  startSegments: PropTypes.array,\n  route: PropTypes.object,\n  share: PropTypes.object,\n};\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport cx from 'classnames';\nimport Measure from 'react-measure';\n\nexport default class Modal extends Component {\n  static propTypes = {\n    variations: PropTypes.array,\n    disableClose: PropTypes.bool,\n    handleClose: PropTypes.func,\n    handleSave: PropTypes.func,\n    title: PropTypes.string,\n    subtitle: PropTypes.string,\n    navigation: PropTypes.node,\n    actions: PropTypes.node,\n    footer: PropTypes.node\n  };\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      windowHeight: {},\n      modalHeight: {}\n    };\n\n    this.updateHeights = this.updateHeights.bind(this);\n  }\n\n  updateHeights(contentRect) {\n    this.setState({ windowHeight: window.innerHeight });\n    this.setState({ modalHeight: contentRect.bounds.height });\n  }\n\n  readVariationClasses() {\n    if (this.props.variations) {\n      const { variations } = this.props;\n      const classes = variations.reduce(\n        (classes, variation) => `${classes}cabana-modal--${variation} `,\n        ''\n      );\n      return classes;\n    }\n  }\n\n  checkClosability() {\n    return this.props.disableClose || false;\n  }\n\n  checkYScrollability() {\n    return this.state.modalHeight > this.state.windowHeight;\n  }\n\n  render() {\n    return (\n      <div\n        className={cx('cabana-modal', this.readVariationClasses(), {\n          'cabana-modal--not-closable': this.checkClosability(),\n          'cabana-modal--scrollable-y': this.checkYScrollability()\n        })}\n      >\n        <Measure\n          bounds\n          onResize={(contentRect) => {\n            this.updateHeights(contentRect);\n          }}\n        >\n          {({ measureRef }) => (\n            <div ref={measureRef} className=\"cabana-modal-container\">\n              <div\n                className=\"cabana-modal-close-icon\"\n                onClick={this.props.handleClose}\n              />\n              <div className=\"cabana-modal-header\">\n                <h1>{this.props.title}</h1>\n                <p>{this.props.subtitle}</p>\n              </div>\n              <div className=\"cabana-modal-navigation\">\n                {this.props.navigation}\n              </div>\n              <div className=\"cabana-modal-body\">\n                <div className=\"cabana-modal-body-window\">\n                  {this.props.children}\n                </div>\n                <div className=\"cabana-modal-body-gradient\" />\n              </div>\n              <div className=\"cabana-modal-actions\">{this.props.actions}</div>\n              <div className=\"cabana-modal-footer\">{this.props.footer}</div>\n            </div>\n          )}\n        </Measure>\n        <div\n          className=\"cabana-modal-backdrop\"\n          onClick={this.props.handleClose}\n        />\n      </div>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport cx from 'classnames';\nimport qs from 'query-string';\nimport CommaAuth, { config as AuthConfig } from '@commaai/my-comma-auth';\n\nimport { EXPLORER_URL } from '../../config';\nimport Modal from './baseModal';\n\nexport default class OnboardingModal extends Component {\n  static propTypes = {\n    handlePandaConnect: PropTypes.func,\n    routes: PropTypes.array\n  };\n\n  static instructionalImages = {\n    step2: require('../../images/webusb-enable-experimental-features.png'),\n    step3: require('../../images/webusb-enable-webusb.png')\n  };\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      webUsbEnabled: !!navigator.usb,\n      viewingUsbInstructions: false,\n      pandaConnected: false\n    };\n\n    this.attemptPandaConnection = this.attemptPandaConnection.bind(this);\n    this.toggleUsbInstructions = this.toggleUsbInstructions.bind(this);\n    this.navigateToExplorer = this.navigateToExplorer.bind(this);\n  }\n\n  componentDidMount() {\n    const script = document.createElement(\"script\");\n    document.body.appendChild(script);\n    script.onload = () => {\n      window.AppleID.auth.init({\n        clientId : AuthConfig.APPLE_CLIENT_ID,\n        scope : AuthConfig.APPLE_SCOPES,\n        redirectURI : AuthConfig.APPLE_REDIRECT_URI,\n        state : AuthConfig.APPLE_STATE,\n      });\n    };\n    script.src = \"https://appleid.cdn-apple.com/appleauth/static/jsapi/appleid/1/en_US/appleid.auth.js\";\n    script.async = true;\n    document.addEventListener('AppleIDSignInOnSuccess', (data) => {\n      const { code, state } = data.detail.authorization;\n      window.location = [AuthConfig.APPLE_REDIRECT_PATH, qs.stringify({ code, state })].join('?');\n    });\n    document.addEventListener('AppleIDSignInOnFailure', console.log);\n  }\n\n  attemptPandaConnection() {\n    if (!this.state.webUsbEnabled) {\n      return;\n    }\n    this.props.handlePandaConnect();\n  }\n\n  toggleUsbInstructions() {\n    this.setState({\n      viewingUsbInstructions: !this.state.viewingUsbInstructions\n    });\n  }\n\n  navigateToExplorer() {\n    window.location.href = EXPLORER_URL;\n  }\n\n  filterRoutesWithCan(drive) {\n    return drive.can === true;\n  }\n\n  renderPandaEligibility() {\n    const { webUsbEnabled, pandaConnected } = this.state;\n    const { attemptingPandaConnection } = this.props;\n    if (!webUsbEnabled) {\n      return (\n        <p>\n          <i className=\"fa fa-exclamation-triangle\" />\n          <span onClick={this.toggleUsbInstructions}>\n            <span>WebUSB is not enabled in your Chrome settings</span>\n          </span>\n        </p>\n      );\n    }\n    if (!pandaConnected && attemptingPandaConnection) {\n      return (\n        <p>\n          <i className=\"fa fa-spinner animate-spin\" />\n          <span className=\"animate-pulse-opacity\">\n            Waiting for panda USB connection\n          </span>\n        </p>\n      );\n    }\n  }\n\n  renderLogin() {\n    if (CommaAuth.isAuthenticated()) {\n      return (\n        <button onClick={this.navigateToExplorer} className=\"button--primary button--kiosk\">\n          <i className=\"fa fa-video-camera\" />\n          <strong>Find a drive in connect</strong>\n          <sup>Click \"View in cabana\" while replaying a drive</sup>\n        </button>\n      );\n    } else {\n      return <>\n        <a href={ AuthConfig.GOOGLE_REDIRECT_LINK } className=\"button button--primary button--icon\">\n          <i className=\"fa fa-google\" />\n          <strong>Sign in with Google</strong>\n        </a>\n        <button onClick={ () => window.AppleID.auth.signIn() } className=\"button button--primary button--icon\">\n          <i className=\"fa fa-apple\" />\n          <strong>Sign in with Apple</strong>\n        </button>\n        <a href={ AuthConfig.GITHUB_REDIRECT_LINK } className=\"button button--primary button--icon\">\n          <i className=\"fa fa-github\" />\n          <strong>Sign in with GitHub</strong>\n        </a>\n      </>;\n    }\n  }\n\n  renderOnboardingOptions() {\n    return (\n      <div className=\"cabana-onboarding-modes\">\n        <div className=\"cabana-onboarding-mode\">{this.renderLogin()}</div>\n        <div className=\"cabana-onboarding-mode\">\n          <button\n            className={cx('button--secondary button--kiosk', {\n              'is-disabled':\n                !this.state.webUsbEnabled\n                || this.props.attemptingPandaConnection\n            })}\n            onClick={this.attemptPandaConnection}\n          >\n            <i className=\"fa fa-bolt\" />\n            <strong>Launch Realtime Streaming</strong>\n            <sup>\n              Interactively stream car data over USB with\n              {' '}\n              <em>panda</em>\n            </sup>\n            {this.renderPandaEligibility()}\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  renderUsbInstructions() {\n    return (\n      <div className=\"cabana-onboarding-instructions\">\n        <button\n          className=\"button--small button--inverted\"\n          onClick={this.toggleUsbInstructions}\n        >\n          <i className=\"fa fa-chevron-left\" />\n          <span> Go back</span>\n        </button>\n        <h3>Follow these directions to enable WebUSB:</h3>\n        <ol className=\"cabana-onboarding-instructions-list list--bubbled\">\n          <li>\n            <p>\n              <strong>Open your Chrome settings:</strong>\n            </p>\n            <div className=\"inset\">\n              <span>\n                chrome://flags/#enable-experimental-web-platform-features\n              </span>\n            </div>\n          </li>\n          <li>\n            <p>\n              <strong>Enable Experimental Platform features:</strong>\n            </p>\n            <img\n              alt=\"Screenshot of Google Chrome Experimental Platform features\"\n              src={OnboardingModal.instructionalImages.step2}\n            />\n          </li>\n          <li>\n            <p>\n              <strong>Enable WebUSB:</strong>\n            </p>\n            <img\n              alt=\"Screenshot of Google Chrome enable WebUSB\"\n              src={OnboardingModal.instructionalImages.step3}\n            />\n          </li>\n          <li>\n            <p>\n              <strong>\n                Relaunch your Chrome browser and try enabling live mode again.\n              </strong>\n            </p>\n          </li>\n        </ol>\n      </div>\n    );\n  }\n\n  renderModalContent() {\n    if (this.state.viewingUsbInstructions) {\n      return this.renderUsbInstructions();\n    }\n    return this.renderOnboardingOptions();\n  }\n\n  renderModalFooter() {\n    return (\n      <p>\n        <span>\n          Don't have a\n          {' '}\n          <a\n            href=\"https://comma.ai/shop/products/panda\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n          >\n            panda\n          </a>\n          ?\n          {' '}\n        </span>\n        <span>\n          <a\n            href=\"https://comma.ai/shop/products/panda\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n          >\n            Get one here\n          </a>\n          {' '}\n        </span>\n        <span>\n          or\n          {' '}\n          <a href={`${window.location.href}?demo=1`}>try the demo</a>\n.\n        </span>\n      </p>\n    );\n  }\n\n  render() {\n    return (\n      <Modal\n        title=\"Welcome to Cabana\"\n        subtitle=\"Get started by selecting a drive from connect or enabling live mode\"\n        footer={this.renderModalFooter()}\n        disableClose\n        variations={['wide', 'dark']}\n      >\n        {this.renderModalContent()}\n      </Modal>\n    );\n  }\n}\n","import GitHub from 'github-api';\n\nimport { OPENDBC_SOURCE_REPO } from '../config';\n\nexport default class OpenDBC {\n  constructor(token) {\n    this.token = token;\n    this.github = new GitHub({ token });\n    this.sourceRepo = this.github.getRepo('commaai', 'opendbc');\n    this.githubUsername = null;\n  }\n\n  hasAuth() {\n    return this.token !== null;\n  }\n\n  async getGithubUsername() {\n    if (this.githubUsername) {\n      return this.githubUsername;\n    }\n    const githubUsername = await this.fetchGithubUsername();\n    if (githubUsername) {\n      return githubUsername;\n    }\n  }\n\n  async fetchGithubUsername() {\n    try {\n      const user = await this.github.getUser();\n      if (user) {\n        const profile = await user.getProfile();\n        if (profile) {\n          return profile.data.login;\n        }\n      }\n    } catch (e) {\n      return null;\n    }\n  }\n\n  async list(repoFullName) {\n    /*\n    Lists files in a github repository.\n    If no argument provided, assumes OpenDBC source repo\n    (commaai/opendbc)\n    */\n\n    let repo;\n    if (repoFullName === undefined) {\n      repo = this.sourceRepo;\n    } else {\n      const [username, repoName] = repoFullName.split('/');\n      repo = this.github.getRepo(username, repoName);\n    }\n    try {\n      const response = await repo.getContents('master', '');\n\n      return response.data.map((content) => content.path);\n    } catch (e) {\n      return [];\n    }\n  }\n\n  async getDbcContents(dbcPath, repoFullName) {\n    let repo;\n    if (repoFullName === undefined) {\n      repo = this.sourceRepo;\n    } else {\n      const [username, repoName] = repoFullName.split('/');\n      repo = this.github.getRepo(username, repoName);\n    }\n\n    const fileContents = await repo.getContents('master', dbcPath);\n\n    const rawContentsUrl = fileContents.data.download_url;\n\n    const resp = await fetch(rawContentsUrl, { cache: 'no-cache' });\n\n    return resp.text();\n  }\n\n  repoSourceIsOpenDbc(repoDetails) {\n    return (\n      repoDetails.source && repoDetails.source.full_name === OPENDBC_SOURCE_REPO\n    );\n  }\n\n  async getUserOpenDbcFork() {\n    const githubUsername = await this.getGithubUsername();\n    if (!githubUsername) return null;\n\n    const openDbcFork = this.github.getRepo(githubUsername, 'opendbc');\n    const repoDetailResp = await openDbcFork.getDetails();\n    const repoDetails = repoDetailResp.data;\n\n    if (this.repoSourceIsOpenDbc(repoDetails)) {\n      return repoDetails.full_name;\n    }\n    return null;\n  }\n\n  async fork() {\n    const forkResponse = await this.sourceRepo.fork();\n    if (forkResponse.status === 202) {\n      return true;\n    }\n    return false;\n  }\n\n  async commitFile(repoFullName, path, contents, commitMessage) {\n    /*\n      repo is of format username/reponame\n      authenciated user must have write access to repo\n      */\n    const [user, repoName] = repoFullName.split('/');\n    const repo = this.github.getRepo(user, repoName);\n\n    // get HEAD reference\n    const refResp = await repo.getRef('heads/master');\n    const ref = refResp.data;\n\n    // get HEAD commit sha\n    const headCommitResp = await repo.getCommit(ref.object.sha);\n    const headCommit = headCommitResp.data;\n\n    // get HEAD tree\n    const headTreeResp = await repo.getTree(headCommit.tree.sha);\n    const headTree = headTreeResp.data;\n\n    // create new tree\n    const tree = [\n      {\n        mode: '100644',\n        path,\n        type: 'blob',\n        content: contents\n      }\n    ];\n\n    const createTreeResp = await repo.createTree(tree, headTree.sha);\n    const createdTree = createTreeResp.data;\n\n    // commit\n    const commitResp = await repo.commit(\n      headCommit.sha,\n      createdTree.sha,\n      commitMessage || 'OpenDBC updates'\n    );\n    const commit = commitResp.data;\n\n    // update HEAD\n    const updateHeadResp = await repo.updateHead(\n      'heads/master',\n      commit.sha,\n      false\n    );\n\n    return updateHeadResp.status === 200;\n  }\n}\n","import React, { Component } from 'react';\nimport cx from 'classnames';\nimport PropTypes from 'prop-types';\nimport FileSaver from 'file-saver';\n\nimport OpenDbc from '../api/OpenDbc';\nimport DBC from '../models/can/dbc';\nimport Modal from './Modals/baseModal';\n// import TabStyles from '../styles/modal-tabs';\n\nexport default class SaveDbcModal extends Component {\n  static propTypes = {\n    dbc: PropTypes.instanceOf(DBC).isRequired,\n    sourceDbcFilename: PropTypes.string.isRequired,\n    handleClose: PropTypes.func.isRequired,\n    onDbcSaved: PropTypes.func.isRequired,\n    openDbcClient: PropTypes.instanceOf(OpenDbc).isRequired,\n    hasGithubAuth: PropTypes.bool.isRequired,\n    loginWithGithub: PropTypes.element.isRequired\n  };\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      tab: 'GitHub',\n      openDbcFork: null,\n      dbcFilename: this.props.sourceDbcFilename,\n      tabs: ['GitHub', 'Download'],\n      commitMessage: 'OpenDBC updates'\n    };\n\n    this.commitToGitHub = this.commitToGitHub.bind(this);\n    this.downloadDbcFile = this.downloadDbcFile.bind(this);\n    this.forkOpenDbcAndWait = this.forkOpenDbcAndWait.bind(this);\n    this.renderForkButton = this.renderForkButton.bind(this);\n    this.renderTabNavigation = this.renderTabNavigation.bind(this);\n    this.renderActions = this.renderActions.bind(this);\n  }\n\n  async componentDidMount() {\n    const openDbcFork = await this.props.openDbcClient.getUserOpenDbcFork();\n    this.setState({ openDbcFork });\n  }\n\n  async commitToGitHub() {\n    const { openDbcFork, dbcFilename } = this.state;\n    const filename = `${dbcFilename.replace(/\\.dbc/g, '')}.dbc`;\n    const success = await this.props.openDbcClient.commitFile(\n      openDbcFork,\n      filename,\n      this.props.dbc.text(),\n      this.state.commitMessage\n    );\n    if (success) {\n      this.props.onDbcSaved(filename);\n    }\n  }\n\n  async downloadDbcFile() {\n    const blob = new Blob([this.props.dbc.text()], {\n      type: 'text/plain;charset=utf-8'\n    });\n    const filename = `${this.state.dbcFilename.replace(/\\.dbc/g, '')}.dbc`;\n    FileSaver.saveAs(blob, filename, true);\n  }\n\n  async forkOpenDbcAndWait() {\n    const forkResponseSuccess = await this.props.openDbcClient.fork();\n    if (forkResponseSuccess) {\n      let isTimedOut = false;\n      const timeout = window.setTimeout(() => {\n        isTimedOut = true;\n      }, 30000);\n\n      const interval = window.setInterval(() => {\n        if (!isTimedOut) {\n          this.props.openDbcClient.getUserOpenDbcFork().then((openDbcFork) => {\n            if (openDbcFork !== null) {\n              this.setState({ openDbcFork });\n              window.clearInterval(interval);\n              window.clearTimeout(timeout);\n            }\n          });\n        } else {\n          window.clearInterval(interval);\n        }\n      }, 3000);\n    } else {\n      // fork failed\n    }\n  }\n\n  primaryActionDisabled() {\n    const { tab } = this.state;\n    if (tab === 'GitHub') {\n      return (\n        this.state.openDbcFork != null && this.state.dbcFilename.length > 0\n      );\n    }\n    if (tab === 'Download') {\n      return true;\n    }\n  }\n\n  renderForkButton() {\n    return (\n      <button onClick={this.forkOpenDbcAndWait}>\n        <i className=\"fa fa-code-fork\" />\n        <span> Fork OpenDBC</span>\n      </button>\n    );\n  }\n\n  renderForkStep() {\n    const { openDbcFork } = this.state;\n    let content;\n    if (openDbcFork !== null) {\n      content = (\n        <button disabled>\n          <i className=\"fa fa-code-fork\" />\n          <span>\n            {' '}\n            Forked:\n            {openDbcFork}\n          </span>\n        </button>\n      );\n    } else if (this.props.hasGithubAuth) {\n      content = this.renderForkButton();\n    } else {\n      content = this.props.loginWithGithub;\n    }\n    return (\n      <div>\n        {openDbcFork !== null ? this.renderForkButton() : null}\n        {content}\n        <hr />\n      </div>\n    );\n  }\n\n  renderFilenameField() {\n    return (\n      <div className=\"form-field\" data-extension=\".dbc\">\n        <label htmlFor=\"filename\">\n          <span>Choose a filename:</span>\n          <sup>Pick a unique name for your car DBC file</sup>\n        </label>\n        <input\n          type=\"text\"\n          id=\"filename\"\n          value={this.state.dbcFilename.replace(/\\.dbc/g, '')}\n          size={this.state.dbcFilename.length + 2}\n          onChange={(e) => this.setState({ dbcFilename: e.target.value })}\n        />\n      </div>\n    );\n  }\n\n  renderTabNavigation() {\n    return (\n      <div className=\"cabana-tabs-navigation\">\n        {this.state.tabs.map((tab) => (\n          <button\n            className={cx({ 'is-active': this.state.tab === tab })}\n            onClick={() => {\n              this.setState({ tab });\n            }}\n            key={tab}\n          >\n            <span>{tab}</span>\n          </button>\n        ))}\n      </div>\n    );\n  }\n\n  renderCommitMessage() {\n    return (\n      <div className=\"form-field\">\n        <label htmlFor=\"commit-message\">\n          <span>Commit Message:</span>\n          <sup>Message appears in git logs</sup>\n        </label>\n        <input\n          type=\"text\"\n          id=\"commit-message\"\n          value={this.state.commitMessage}\n          onChange={(e) => this.setState({ commitMessage: e.target.value })}\n        />\n      </div>\n    );\n  }\n\n  renderTabContent() {\n    const { tab } = this.state;\n    if (tab === 'GitHub') {\n      return (\n        <div>\n          {this.renderForkStep()}\n          {this.renderFilenameField()}\n          {this.renderCommitMessage()}\n        </div>\n      );\n    }\n    if (tab === 'Download') {\n      return <div>{this.renderFilenameField()}</div>;\n    }\n  }\n\n  renderActions() {\n    const { tab } = this.state;\n    if (tab === 'GitHub') {\n      return (\n        <div>\n          <button className=\"button--inverted\" onClick={this.props.handleClose}>\n            <span>Cancel</span>\n          </button>\n          <button className=\"button--primary\" onClick={this.commitToGitHub}>\n            <span>Commit to GitHub</span>\n          </button>\n        </div>\n      );\n    }\n    if (tab === 'Download') {\n      return (\n        <div>\n          <button className=\"button--inverted\" onClick={this.props.handleClose}>\n            <span>Cancel</span>\n          </button>\n          <button className=\"button--primary\" onClick={this.downloadDbcFile}>\n            <span>Download</span>\n          </button>\n        </div>\n      );\n    }\n  }\n\n  render() {\n    return (\n      <Modal\n        title=\"Save DBC File\"\n        subtitle=\"Save your progress and output to a DBC file\"\n        handleClose={this.props.handleClose}\n        navigation={this.renderTabNavigation()}\n        actions={this.renderActions()}\n      >\n        {this.renderTabContent()}\n      </Modal>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport cx from 'classnames';\nimport PropTypes from 'prop-types';\n\nimport OpenDbc from '../api/OpenDbc';\n\nexport default class GithubDbcList extends Component {\n  static propTypes = {\n    onDbcLoaded: PropTypes.func.isRequired,\n    repo: PropTypes.string.isRequired,\n    openDbcClient: PropTypes.instanceOf(OpenDbc).isRequired\n  };\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      paths: [],\n      selectedPath: null,\n      pathQuery: ''\n    };\n\n    this.updatePathQuery = this.updatePathQuery.bind(this);\n  }\n\n  componentDidMount() {\n    this.props.openDbcClient.list(this.props.repo).then((paths) => {\n      paths = paths.filter((path) => path.indexOf('.dbc') !== -1);\n      this.setState({ paths });\n    });\n  }\n\n  componentDidUpdate(prevProps) {\n    if (prevProps.repo !== this.props.repo) {\n      this.props.openDbcClient.list(this.props.repo).then((paths) => {\n        this.setState({ paths, selectedPath: null });\n      });\n    }\n  }\n\n  updatePathQuery(e) {\n    this.setState({\n      pathQuery: e.target.value\n    });\n  }\n\n  selectPath(path) {\n    this.setState({ selectedPath: path });\n    this.props.openDbcClient\n      .getDbcContents(path, this.props.repo)\n      .then((dbcContents) => {\n        this.props.onDbcLoaded(path, dbcContents);\n      });\n  }\n\n  render() {\n    return (\n      <div className=\"cabana-dbc-list\">\n        <div className=\"cabana-dbc-list-header\">\n          <a href={`https://github.com/${this.props.repo}`} target=\"_blank\" rel=\"noopener noreferrer\">\n            <i className=\"fa fa-github\" />\n            <span>{this.props.repo}</span>\n          </a>\n          <div className=\"form-field form-field--small\">\n            <input\n              type=\"text\"\n              placeholder=\"Search DBC Files\"\n              onChange={this.updatePathQuery}\n            />\n          </div>\n        </div>\n        <div className=\"cabana-dbc-list-files\">\n          {this.state.paths\n            .filter(\n              (p) => (this.state.pathQuery === '') | p.includes(this.state.pathQuery)\n            )\n            .map((path) => (\n              <div\n                className={cx('cabana-dbc-list-file', {\n                  'is-selected': this.state.selectedPath === path\n                })}\n                onClick={() => {\n                  this.selectPath(path);\n                }}\n                key={path}\n              >\n                <span>{path}</span>\n              </div>\n            ))}\n        </div>\n      </div>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\n\nexport default class DbcUpload extends Component {\n  static propTypes = {\n    onDbcLoaded: PropTypes.func\n  };\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      dbcText: ''\n    };\n\n    this.onTextChanged = this.onTextChanged.bind(this);\n  }\n\n  onTextChanged(e) {\n    const dbcText = e.target.value;\n    this.setState({ dbcText });\n    this.props.onDbcLoaded('from paste', dbcText);\n  }\n\n  render() {\n    return (\n      <div className=\"cabana-dbc-upload-raw\">\n        <div className=\"form-field\">\n          <label htmlFor=\"raw_dbc_upload\">\n            <span>Raw DBC File:</span>\n            <sup>Paste your DBC text output within this box</sup>\n          </label>\n          <textarea\n            value={this.state.dbcText}\n            id=\"raw_dbc_upload\"\n            className=\"t-mono\"\n            placeholder=\"PASTE DBC FILE HERE\"\n            onChange={this.onTextChanged}\n          />\n        </div>\n      </div>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport cx from 'classnames';\n\nimport DBC from '../models/can/dbc';\nimport OpenDbc from '../api/OpenDbc';\nimport Modal from './Modals/baseModal';\nimport GithubDbcList from './GithubDbcList';\nimport DbcUpload from './DbcUpload';\n\nexport default class LoadDbcModal extends Component {\n  static propTypes = {\n    handleClose: PropTypes.func.isRequired,\n    onDbcSelected: PropTypes.func.isRequired,\n    openDbcClient: PropTypes.instanceOf(OpenDbc).isRequired,\n    loginWithGithub: PropTypes.element.isRequired\n  };\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      tab: 'OpenDBC',\n      tabs: ['OpenDBC', 'GitHub', 'Upload'],\n      dbc: null,\n      dbcSource: null,\n      userOpenDbcRepo: null\n    };\n\n    this.onDbcLoaded = this.onDbcLoaded.bind(this);\n    this.handleSave = this.handleSave.bind(this);\n    this.renderTabNavigation = this.renderTabNavigation.bind(this);\n    this.renderTabContent = this.renderTabContent.bind(this);\n    this.renderActions = this.renderActions.bind(this);\n  }\n\n  componentDidMount() {\n    this.props.openDbcClient.getUserOpenDbcFork().then((userOpenDbcRepo) => {\n      this.setState({ userOpenDbcRepo });\n    });\n  }\n\n  onDbcLoaded(dbcSource, dbcText) {\n    const dbc = new DBC(dbcText);\n    this.setState({ dbcSource, dbc });\n  }\n\n  handleSave() {\n    const { dbc, dbcSource } = this.state;\n    this.props.onDbcSelected(dbcSource, dbc);\n  }\n\n  renderTabNavigation() {\n    return (\n      <div className=\"cabana-tabs-navigation\">\n        {this.state.tabs.map((tab) => (\n          <button\n            className={cx({ 'is-active': this.state.tab === tab })}\n            onClick={() => {\n              this.setState({\n                tab,\n                dbc: null,\n                dbcSource: null,\n              });\n            }}\n            key={tab}\n          >\n            <span>{tab}</span>\n          </button>\n        ))}\n      </div>\n    );\n  }\n\n  renderTabContent() {\n    const { tab } = this.state;\n    if (tab === 'OpenDBC') {\n      return (\n        <GithubDbcList\n          onDbcLoaded={this.onDbcLoaded}\n          repo=\"commaai/opendbc\"\n          openDbcClient={this.props.openDbcClient}\n        />\n      );\n    }\n    if (tab === 'GitHub') {\n      if (!this.props.openDbcClient.hasAuth()) {\n        return this.props.loginWithGithub;\n      }\n      if (this.state.userOpenDbcRepo === null) {\n        return <div>Fork it</div>;\n      }\n      return (\n        <GithubDbcList\n          onDbcLoaded={this.onDbcLoaded}\n          repo={this.state.userOpenDbcRepo}\n          openDbcClient={this.props.openDbcClient}\n        />\n      );\n    }\n    if (tab === 'Upload') {\n      return <DbcUpload onDbcLoaded={this.onDbcLoaded} />;\n    }\n  }\n\n  renderActions(disabled) {\n    return (\n      <div>\n        <button className=\"button--inverted\" onClick={this.props.handleClose}>\n          <span>Cancel</span>\n        </button>\n        <button className=\"button--primary\" disabled={ disabled } onClick={ this.handleSave }>\n          <span>Load DBC</span>\n        </button>\n      </div>\n    );\n  }\n\n  render() {\n    return (\n      <Modal\n        title=\"Load DBC File\"\n        subtitle=\"Modify an existing DBC file with Cabana\"\n        handleClose={this.props.handleClose}\n        navigation={this.renderTabNavigation()}\n        actions={this.renderActions(Boolean(this.state.dbc === null))}\n      >\n        {this.renderTabContent()}\n      </Modal>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\n\nimport Modal from './Modals/baseModal';\n\nexport default class EditMessageModal extends Component {\n  static propTypes = {\n    handleClose: PropTypes.func.isRequired,\n    handleSave: PropTypes.func.isRequired,\n    message: PropTypes.object.isRequired\n  };\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      messageFrame: props.message.frame.copy()\n    };\n    this.handleSave = this.handleSave.bind(this);\n    this.editTransmitter = this.editTransmitter.bind(this);\n    this.addTransmitter = this.addTransmitter.bind(this);\n    this.renderActions = this.renderActions.bind(this);\n  }\n\n  handleSave() {\n    this.props.handleSave(this.state.messageFrame);\n  }\n\n  addTransmitter() {\n    const { messageFrame } = this.state;\n    messageFrame.addTransmitter();\n    this.setState({ messageFrame });\n  }\n\n  editTransmitter(transmitter) {}\n\n  renderActions() {\n    return (\n      <div>\n        <button className=\"button--inverted\" onClick={this.props.handleClose}>\n          Cancel\n        </button>\n        <button className=\"button--primary\" onClick={this.handleSave}>\n          Save Message\n        </button>\n      </div>\n    );\n  }\n\n  render() {\n    return (\n      <Modal\n        title={`Edit Message: (${this.props.message.id})`}\n        subtitle=\"Make changes and update defaults of this message\"\n        handleClose={this.props.handleClose}\n        handleSave={this.handleSave}\n        actions={this.renderActions()}\n      >\n        <div className=\"form-field\">\n          <label htmlFor=\"message_name\">\n            <span>Name</span>\n            <sup>Customize the name of this message</sup>\n          </label>\n          <input\n            type=\"text\"\n            id=\"message_name\"\n            value={this.state.messageFrame.name}\n            onChange={(e) => {\n              const { messageFrame } = this.state;\n              messageFrame.name = e.target.value;\n              this.setState({ messageFrame });\n            }}\n          />\n        </div>\n        <div className=\"form-field\">\n          <label htmlFor=\"message_size\">\n            <span>Size</span>\n            <sup>Add a size parameter to this message</sup>\n          </label>\n          <input\n            type=\"number\"\n            id=\"message_size\"\n            value={this.state.messageFrame.size}\n            onChange={(e) => {\n              const { messageFrame } = this.state;\n              messageFrame.size = parseInt(e.target.value, 10);\n              this.setState({ messageFrame });\n            }}\n          />\n        </div>\n        <div className=\"form-field u-hidden\">\n          <label htmlFor=\"message_transmitters\">\n            <span>Transmitters</span>\n            <sup>\n              Add the physical ECU units that this message is coming from.\n            </sup>\n          </label>\n          <div className=\"form-field-inset\">\n            <ul className=\"form-field-inset-list\">\n              {this.state.messageFrame.transmitters.map((transmitter) => (\n                <li className=\"form-field-inset-list-item\" key={transmitter}>\n                  <div className=\"form-field-inset-list-item-title\">\n                    <span>{transmitter}</span>\n                  </div>\n                  <div className=\"form-field-inset-list-item-action\">\n                    <button className=\"button--tiny button--alpha\">Edit</button>\n                  </div>\n                </li>\n              ))}\n              <button className=\"button--tiny button--alpha\">\n                <span>\n                  <i className=\"fa fa-plus\" />\n                  {' '}\nAdd Transmitter\n                </span>\n              </button>\n            </ul>\n          </div>\n        </div>\n      </Modal>\n    );\n  }\n}\n","import DBC from '../models/can/dbc';\n\nexport function fetchPersistedDbc(routeName) {\n  const maybeDbc = window.localStorage.getItem(routeName);\n  if (maybeDbc !== null) {\n    const { dbcFilename, dbcText } = JSON.parse(maybeDbc);\n    const dbc = new DBC(dbcText);\n\n    return { dbc, dbcText, dbcFilename };\n  }\n  return null;\n}\n\nexport function persistDbc(routeName, { dbcFilename, dbc }) {\n  const dbcJson = JSON.stringify({\n    dbcFilename,\n    dbcText: dbc.text()\n  });\n  window.localStorage.setItem(routeName, dbcJson);\n}\n\nconst GITHUB_AUTH_TOKEN_LOCALSTORAGE_KEY = 'gh_auth_token';\nexport function fetchPersistedGithubAuthToken() {\n  return window.localStorage.getItem(GITHUB_AUTH_TOKEN_LOCALSTORAGE_KEY);\n}\n\nexport function unpersistGithubAuthToken() {\n  window.localStorage.removeItem(GITHUB_AUTH_TOKEN_LOCALSTORAGE_KEY);\n}\n\nexport function persistGithubAuthToken(token) {\n  return window.localStorage.setItem(GITHUB_AUTH_TOKEN_LOCALSTORAGE_KEY, token);\n}\n","import SocketIO from 'socket.io-client';\nimport { UNLOGGER_HOST } from '../config';\n\nexport default class UnloggerClient {\n  constructor() {\n    this.socket = SocketIO(UNLOGGER_HOST);\n  }\n\n  seek(dongleId, baseTime, seekSeconds) {\n    this.socket.emit('seek', dongleId, baseTime, seekSeconds);\n  }\n}\n","import React, { Component } from 'react';\nimport Moment from 'moment';\nimport PropTypes from 'prop-types';\nimport cx from 'classnames';\nimport { createWriteStream } from 'streamsaver';\nimport Panda from '@commaai/pandajs';\nimport CommaAuth, { storage as CommaAuthStorage, config as AuthConfig } from '@commaai/my-comma-auth';\nimport { raw as RawDataApi, drives as DrivesApi } from '@commaai/comma-api';\nimport { timeout, interval } from 'thyming';\nimport {\n  USE_UNLOGGER,\n  PART_SEGMENT_LENGTH,\n  STREAMING_WINDOW,\n  GITHUB_AUTH_TOKEN_KEY\n} from './config';\nimport * as GithubAuth from './api/github-auth';\n\nimport DBC from './models/can/dbc';\nimport Meta from './components/Meta';\nimport Explorer from './components/Explorer';\nimport OnboardingModal from './components/Modals/OnboardingModal';\nimport SaveDbcModal from './components/SaveDbcModal';\nimport LoadDbcModal from './components/LoadDbcModal';\nimport debounce from './utils/debounce';\nimport EditMessageModal from './components/EditMessageModal';\nimport {\n  persistDbc,\n  fetchPersistedDbc,\n  unpersistGithubAuthToken\n} from './api/localstorage';\nimport OpenDbc from './api/OpenDbc';\nimport UnloggerClient from './api/unlogger';\nimport { hash } from './utils/string';\nimport { modifyQueryParameters } from './utils/url';\nimport DbcUtils from './utils/dbc';\n\nconst NEW_DBC = 'New_DBC';\n\nconst RLogDownloader = require('./workers/rlog-downloader.worker');\nconst LogCSVDownloader = require('./workers/dbc-csv-downloader.worker');\nconst MessageParser = require('./workers/message-parser.worker');\nconst CanStreamerWorker = require('./workers/CanStreamerWorker.worker');\n\nconst dataCache = {};\n\n\nexport default class CanExplorer extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      messages: {},\n      thumbnails: [],\n      selectedMessages: [],\n      route: null,\n      canFrameOffset: 0,\n      routeInitTime: 0,\n      firstFrameTime: 0,\n      carFingerprint: null,\n      firstCanTime: null,\n      lastBusTime: null,\n      selectedMessage: null,\n      currentParts: [0, 0],\n      currentPart: 0,\n      currentWorkers: {},\n      loadingParts: [],\n      loadedParts: [],\n      showOnboarding: false,\n      showLoadDbc: false,\n      showSaveDbc: false,\n      showEditMessageModal: false,\n      editMessageModalMessage: null,\n      dbc: props.dbc ? props.dbc : new DBC(),\n      dbcText: props.dbc ? props.dbc.text() : new DBC().text(),\n      dbcFilename: props.dbcFilename ? props.dbcFilename : NEW_DBC,\n      dbcLastSaved: null,\n      seekTime: props.seekTime || 0,\n      seekIndex: 0,\n      maxByteStateChangeCount: 0,\n      partsLoaded: 0,\n      spawnWorkerHash: null,\n      attemptingPandaConnection: false,\n      pandaNoDeviceSelected: false,\n      live: false,\n      isGithubAuthenticated:\n        props.githubAuthToken !== null && props.githubAuthToken !== undefined,\n      shareUrl: null,\n      logUrls: null,\n      share: null,\n    };\n\n    this.openDbcClient = new OpenDbc(props.githubAuthToken);\n    if (USE_UNLOGGER) {\n      this.unloggerClient = new UnloggerClient();\n    }\n\n    this.showOnboarding = this.showOnboarding.bind(this);\n    this.hideOnboarding = this.hideOnboarding.bind(this);\n    this.showLoadDbc = this.showLoadDbc.bind(this);\n    this.hideLoadDbc = this.hideLoadDbc.bind(this);\n    this.showSaveDbc = this.showSaveDbc.bind(this);\n    this.hideSaveDbc = this.hideSaveDbc.bind(this);\n    this.showEditMessageModal = this.showEditMessageModal.bind(this);\n    this.hideEditMessageModal = this.hideEditMessageModal.bind(this);\n    this.onDbcSelected = this.onDbcSelected.bind(this);\n    this.onDbcSaved = this.onDbcSaved.bind(this);\n    this.onConfirmedSignalChange = this.onConfirmedSignalChange.bind(this);\n    this.onPartChange = this.onPartChange.bind(this);\n    this.onMessageFrameEdited = this.onMessageFrameEdited.bind(this);\n    this.onSeek = this.onSeek.bind(this);\n    this.onUserSeek = this.onUserSeek.bind(this);\n    this.onMessageSelected = this.onMessageSelected.bind(this);\n    this.onMessageUnselected = this.onMessageUnselected.bind(this);\n    this.initCanData = this.initCanData.bind(this);\n    this.updateSelectedMessages = this.updateSelectedMessages.bind(this);\n    this.handlePandaConnect = this.handlePandaConnect.bind(this);\n    this.processStreamedCanMessages = this.processStreamedCanMessages.bind(\n      this\n    );\n    this.onStreamedCanMessagesProcessed = this.onStreamedCanMessagesProcessed.bind(\n      this\n    );\n    this.showingModal = this.showingModal.bind(this);\n    this.lastMessageEntriesById = this.lastMessageEntriesById.bind(this);\n    this.githubSignOut = this.githubSignOut.bind(this);\n    this.downloadLogAsCSV = this.downloadLogAsCSV.bind(this);\n\n    this.pandaReader = new Panda();\n    this.pandaReader.onMessage(this.processStreamedCanMessages);\n  }\n\n  componentDidMount() {\n    this.dataCacheTimer = interval(() => {\n      const { currentParts } = this.state;\n      let { loadedParts } = this.state;\n      if (this.loadMessagesFromCacheRunning || loadedParts.length < 4) {\n        return;\n      }\n      loadedParts.forEach((part) => {\n        if (part >= currentParts[0] && part <= currentParts[1]) {\n          return;\n        }\n        if (Date.now() - dataCache[part].lastUsed > 3 * 60 * 1000) {\n          console.log('Decaching part', part);\n          loadedParts = loadedParts.filter((p) => p !== part);\n          this.setState({\n            loadedParts\n          }, () => { delete dataCache[part]; });\n        }\n      });\n    }, 10000);\n\n    const { dongleId, name } = this.props;\n    if (CommaAuth.isAuthenticated() && !name) {\n      this.showOnboarding();\n    } else if (\n      this.props.max\n      && this.props.url\n      && !this.props.exp\n      && !this.props.sig\n    ) {\n      // legacy share? maybe dead code\n      const { max, url } = this.props;\n      const startTime = Moment(name, 'YYYY-MM-DD--H-m-s');\n\n      const route = {\n        fullname: `${dongleId}|${name}`,\n        proclog: max,\n        url,\n        start_time: startTime\n      };\n      this.setState(\n        {\n          route,\n          currentParts: [0, Math.min(max, PART_SEGMENT_LENGTH - 1)]\n        },\n        this.initCanData\n      );\n    } else if (dongleId && name) {\n      const routeName = `${dongleId}|${name}`;\n      let routePromise;\n      let logUrlsPromise;\n\n      if (this.props.url) {\n        routePromise = Promise.resolve({\n          maxqcamera: null,\n          url: this.props.url,\n        });\n      } else {\n        routePromise = DrivesApi.getRouteInfo(routeName);\n      }\n\n      if (this.props.sig && this.props.exp) {\n        logUrlsPromise = RawDataApi.getRouteFiles(routeName, false, {\n          sig: this.props.sig,\n          exp: this.props.exp\n        });\n      } else {\n        logUrlsPromise = RawDataApi.getRouteFiles(routeName);\n      }\n      Promise.all([routePromise, logUrlsPromise])\n        .then((initData) => {\n          const [route, logFiles] = initData;\n          const logUrls = logFiles['logs'];\n          const newState = {\n            route: {\n              fullname: routeName,\n              proclog: logUrls.length - 1,\n              start_time: Moment(name, 'YYYY-MM-DD--H-m-s'),\n              url: route.url.replace('chffrprivate.blob.core.windows.net', 'chffrprivate.azureedge.net'),\n              maxqcamera: route.maxqcamera ? route.maxqcamera : logUrls.length - 1,\n            },\n            currentParts: [\n              0,\n              Math.min(logUrls.length - 1, PART_SEGMENT_LENGTH - 1)\n            ],\n            logUrls\n          };\n          this.setState(newState, this.initCanData);\n\n          if (!this.props.sig || !this.props.exp) {\n            DrivesApi.getShareSignature(routeName).then((shareSignature) => this.setState({\n              share: {\n                exp: shareSignature.exp,\n                sig: shareSignature.sig,\n              },\n              shareUrl: modifyQueryParameters({\n                add: {\n                  exp: shareSignature.exp,\n                  sig: shareSignature.sig,\n                  max: logUrls.length - 1,\n                  url: route.url.replace('chffrprivate.blob.core.windows.net', 'chffrprivate.azureedge.net'),\n                },\n                remove: [GITHUB_AUTH_TOKEN_KEY]\n              })\n            }));\n          } else {\n            this.setState({\n              share: {\n                exp: this.props.exp,\n                sig: this.props.sig,\n              },\n            });\n          }\n        })\n        .catch((err) => {\n          console.log(err);\n          CommaAuthStorage.logOut().then(() => {\n            CommaAuthStorage.isAuthed = false;\n            this.showOnboarding();\n          });\n        });\n    } else {\n      this.showOnboarding();\n    }\n  }\n\n  componentWillUnmount() {\n    if (this.dataCacheTimer) {\n      this.dataCacheTimer();\n    }\n  }\n\n  initCanData() {\n    this.spawnWorker(this.state.currentParts);\n  }\n\n  onDbcSelected(dbcFilename, dbc) {\n    const { route } = this.state;\n    this.hideLoadDbc();\n    dbc.lastUpdated = Date.now();\n    this.persistDbc({ dbcFilename, dbc });\n\n    if (route) {\n      this.setState(\n        {\n          dbc,\n          dbcFilename,\n          dbcText: dbc.text(),\n          partsLoaded: 0,\n          selectedMessage: null,\n          messages: {}\n        },\n        () => {\n          this.loadMessagesFromCache();\n        }\n      );\n    } else {\n      this.setState({\n        dbc,\n        dbcFilename,\n        dbcText: dbc.text(),\n        messages: {}\n      });\n    }\n  }\n\n  onDbcSaved(dbcFilename) {\n    const dbcLastSaved = Moment();\n    this.setState({ dbcLastSaved, dbcFilename });\n    this.hideSaveDbc();\n  }\n\n  // async downloadDbcFile() {\n  //   const blob = new Blob([this.props.dbc.text()], {type: \"text/plain;charset=utf-8\"});\n  //   const filename = this.state.dbcFilename.replace(/\\.dbc/g, '') + '.dbc';\n  //   FileSaver.saveAs(blob, filename, true);\n  // }\n\n  downloadLogAsCSV() {\n    console.log('downloadLogAsCSV:start');\n    const { dbcFilename } = this.state;\n    const fileStream = createWriteStream(\n      `${dbcFilename.replace(/\\.dbc/g, '-')}${+new Date()}.csv`\n    );\n    const writer = fileStream.getWriter();\n    const encoder = new TextEncoder();\n\n    if (this.state.live) {\n      return this.downloadLiveLogAsCSV(dataHandler);\n    }\n    return this.downloadRawLogAsCSV(dataHandler);\n\n    function dataHandler(e) {\n      const { logData, shouldClose, progress } = e.data;\n      if (shouldClose) {\n        console.log('downloadLogAsCSV:close');\n        writer.close();\n        return;\n      }\n      console.log('CSV export progress:', progress);\n      const uint8array = encoder.encode(`${logData}\\n`);\n      writer.write(uint8array);\n    }\n  }\n\n  downloadRawLogAsCSV(handler) {\n    return this.downloadLiveLogAsCSV(handler);\n  }\n\n  downloadLiveLogAsCSV(handler) {\n    // Trigger processing of in-memory data in worker\n    // this method *could* just fetch the data needed for the worked, but\n    // eventually this might be in it's own worker instead of the shared one\n    const { firstCanTime, canFrameOffset } = this.state;\n    const worker = new LogCSVDownloader();\n\n    worker.onmessage = handler;\n\n    worker.postMessage({\n      data: Object.keys(this.state.messages).map((sourceId) => {\n        const source = this.state.messages[sourceId];\n        return {\n          id: source.id,\n          bus: source.bus,\n          address: source.address,\n          entries: source.entries.slice()\n        };\n      }),\n      canStartTime: firstCanTime - canFrameOffset\n    });\n  }\n\n  mergeThumbnails(newThumbnails) {\n    const { thumbnails } = this.state;\n    if (!newThumbnails || !newThumbnails.length) {\n      return thumbnails;\n    }\n    if (!thumbnails.length) {\n      return newThumbnails;\n    }\n\n    let oldIndex = 0;\n    let newIndex = 0;\n\n    // is old immediately after new?\n    if (newThumbnails[0].monoTime > thumbnails[thumbnails.length - 1]) {\n      return thumbnails.concat(newThumbnails);\n    }\n    // is new immediately after old?\n    if (newThumbnails[newThumbnails.length - 1] < thumbnails[0]) {\n      return newThumbnails.concat(thumbnails);\n    }\n    let result = [];\n    while (oldIndex < thumbnails.length && newIndex < newThumbnails.length) {\n      if (thumbnails[oldIndex].monoTime < newThumbnails[newIndex].monoTime) {\n        result.push(thumbnails[oldIndex]);\n        oldIndex += 1;\n      } else {\n        result.push(newThumbnails[newIndex]);\n        newIndex += 1;\n      }\n    }\n    if (oldIndex < thumbnails.length) {\n      result = result.concat(thumbnails.slice(oldIndex));\n    } else if (newIndex < newThumbnails.length) {\n      result = result.concat(newThumbnails.slice(newIndex));\n    }\n\n    return result;\n  }\n\n  cancelWorker(workerHash) {\n    // actually don't...\n    return;\n  }\n\n  spawnWorker(options) {\n    let { currentParts, currentWorkers, loadingParts } = this.state;\n    console.log('Checking worker for', currentParts);\n    if (loadingParts.length > 1) {\n      // only 2 workers at a time pls\n      return;\n    }\n    const [minPart, maxPart] = currentParts;\n\n    // updated worker list (post canceling, and this time a copy)\n    currentWorkers = { ...this.state.currentWorkers };\n\n    const { loadedParts, currentPart } = this.state;\n\n    let part = -1;\n    const allWorkerParts = loadingParts.concat(loadedParts);\n\n    for (let partOffset = 0; partOffset <= maxPart - minPart; ++partOffset) {\n      let tempPart = currentPart + partOffset;\n      if (tempPart > maxPart) {\n        tempPart = minPart + ((tempPart - minPart) % (maxPart - minPart + 1));\n      }\n      if (allWorkerParts.indexOf(tempPart) === -1) {\n        part = tempPart;\n        break;\n      }\n    }\n    if (part === -1) {\n      return;\n    }\n\n    console.log('Starting worker for part', part);\n    // options is object of {part, prevMsgEntries, spawnWorkerHash, prepend}\n    options = options || {};\n    let { prevMsgEntries } = options;\n    const prepend = false;\n\n    const {\n      dbc,\n      route,\n      firstCanTime,\n      canFrameOffset\n    } = this.state;\n    let { maxByteStateChangeCount } = this.state;\n\n    if (!prevMsgEntries) {\n      // we have previous messages loaded\n      const { messages } = this.state;\n      prevMsgEntries = {};\n      Object.keys(messages).forEach((key) => {\n        const { entries } = messages[key];\n        prevMsgEntries[key] = entries[entries.length - 1];\n      });\n    }\n\n    // var worker = new CanFetcher();\n    const worker = new RLogDownloader();\n\n    const spawnWorkerHash = hash(Math.random().toString(16));\n    currentWorkers[spawnWorkerHash] = {\n      part,\n      worker\n    };\n\n    loadingParts = [part, ...loadingParts];\n\n    this.setState({\n      currentWorkers,\n      loadingParts\n    });\n\n    worker.onmessage = (e) => {\n      if (this.state.currentWorkers[spawnWorkerHash] === undefined) {\n        console.log('Worker was canceled');\n        return;\n      }\n\n      maxByteStateChangeCount = e.data.maxByteStateChangeCount;\n      const {\n        newMessages,\n        newThumbnails,\n        isFinished,\n        routeInitTime,\n        firstFrameTime,\n        carParams,\n      } = e.data;\n      if (maxByteStateChangeCount > this.state.maxByteStateChangeCount) {\n        this.setState({ maxByteStateChangeCount });\n      } else {\n        maxByteStateChangeCount = this.state.maxByteStateChangeCount;\n      }\n      if (routeInitTime !== this.state.routeInitTime) {\n        this.setState({ routeInitTime });\n      }\n      if (firstFrameTime && firstFrameTime !== this.state.firstFrameTime) {\n        this.setState({ firstFrameTime });\n      }\n      if (carParams && carParams.CarFingerprint !== this.state.carFingerprint) {\n        this.setState({ carFingerprint: carParams.CarFingerprint });\n\n        if (this.state.dbcFilename === NEW_DBC) {\n          const dbcFilename = DbcUtils.findDbcForCar(carParams.CarFingerprint);\n          if (dbcFilename) {\n            this.openDbcClient.getDbcContents(dbcFilename + '.dbc', 'commaai/opendbc').then((dbcText) => {\n              this.onDbcSelected(dbcFilename, new DBC(dbcText));\n            });\n          }\n        }\n      }\n\n      if (newMessages) {\n        this.addMessagesToDataCache(part, newMessages, newThumbnails);\n      }\n\n      // const messages = this.addAndRehydrateMessages(\n      //   newMessages,\n      //   maxByteStateChangeCount\n      // );\n      // const prevMsgEntries = {};\n      // Object.keys(newMessages).forEach((key) => {\n      //   prevMsgEntries[key] = newMessages[key].entries[newMessages[key].entries.length - 1];\n      // });\n\n      // const thumbnails = this.mergeThumbnails(newThumbnails);\n\n      if (isFinished) {\n        const loadingParts = this.state.loadingParts.filter((p) => p !== part);\n        const loadedParts = [part, ...this.state.loadedParts];\n\n        this.setState(\n          {\n            partsLoaded: this.state.partsLoaded + 1,\n            loadingParts,\n            loadedParts\n          },\n          () => {\n            this.spawnWorker({\n              prevMsgEntries,\n              spawnWorkerHash,\n              prepend\n            });\n            if (window.dataCallback) {\n              window.dataCallback();\n              window.dataCallback = null;\n            }\n          }\n        );\n      }\n    };\n\n    worker.postMessage({\n      // old stuff for reverse compatibility for easier testing\n      base: route.url,\n      num: part,\n\n      // so that we don't try to read metadata about it...\n      isLegacyShare: this.props.isLegacyShare,\n      logUrls: this.state.logUrls,\n\n      // data that is used\n      dbcText: dbc.text(),\n      route: route.fullname,\n      part,\n      canStartTime: firstCanTime != null ? firstCanTime - canFrameOffset : null,\n      prevMsgEntries,\n      maxByteStateChangeCount\n    });\n  }\n\n  addAndRehydrateMessages(newMessages, options) {\n    // Adds new message entries to messages state\n    // and \"rehydrates\" ES6 classes (message frame)\n    // lost from JSON serialization in webworker data cloning.\n    // handles merging the data in correct order\n    options = options || {};\n\n    const messages = { ...this.state.messages };\n\n    Object.keys(newMessages).forEach((key) => {\n      // add message\n      if (options.replace !== true && key in messages) {\n        // should merge here instead of concat\n        // assumes messages are always sequential\n        const msgEntries = messages[key].entries;\n        const newMsgEntries = newMessages[key].entries;\n        const msgLength = msgEntries.length;\n        const newMsgLength = newMsgEntries.length;\n        const entryLength = msgLength + newMsgLength;\n        messages[key] = {\n          ...messages[key],\n          entries: Array(entryLength)\n        };\n\n        let msgIndex = 0;\n        let newMsgIndex = 0;\n\n        for (let i = 0; i < entryLength; ++i) {\n          if (newMsgIndex >= newMsgLength) {\n            messages[key].entries[i] = msgEntries[msgIndex++];\n          } else if (msgIndex >= msgLength) {\n            messages[key].entries[i] = newMsgEntries[newMsgIndex++];\n          } else if (\n            msgEntries[msgIndex].relTime <= newMsgEntries[newMsgIndex].relTime\n          ) {\n            messages[key].entries[i] = msgEntries[msgIndex++];\n          } else if (\n            msgEntries[msgIndex].relTime >= newMsgEntries[newMsgIndex].relTime\n          ) {\n            messages[key].entries[i] = newMsgEntries[newMsgIndex++];\n          }\n        }\n        messages[key].byteStateChangeCounts = newMessages[key].byteStateChangeCounts;\n      } else {\n        messages[key] = newMessages[key];\n        messages[key].frame = this.state.dbc.getMessageFrame(\n          messages[key].address\n        );\n      }\n    });\n\n    const maxByteStateChangeCount = DbcUtils.findMaxByteStateChangeCount(\n      messages\n    );\n    this.setState({\n      maxByteStateChangeCount\n    });\n\n    Object.keys(messages).forEach((key) => {\n      // console.log(key);\n      messages[key] = DbcUtils.setMessageByteColors(\n        messages[key],\n        maxByteStateChangeCount\n      );\n    });\n\n    return messages;\n  }\n\n  async addMessagesToDataCache(part, newMessages, newThumbnails) {\n    const { dbc, currentParts } = this.state;\n    const entry = await this.getParseSegment(part);\n    if (!entry) {\n      // first chunk of data returned from this segment\n      Object.keys(newMessages).forEach((key) => {\n        newMessages[key] = this.parseMessageEntry(newMessages[key], dbc);\n      });\n      dataCache[part] = {\n        messages: newMessages,\n        thumbnails: newThumbnails,\n        lastUpdated: Date.now(),\n        lastUsed: Date.now()\n      };\n      if (part >= currentParts[0] && part <= currentParts[1]) {\n        this.setState({\n          messages: this.addAndRehydrateMessages(newMessages)\n        });\n      }\n      return;\n    }\n\n    entry.lastUsed = Date.now();\n\n    // data is always append only, and always per segment\n    Object.keys(newMessages).forEach((key) => {\n      let msgs = newMessages[key];\n      if (!dataCache[part].messages[key]) {\n        msgs = this.parseMessageEntry(msgs, dbc);\n        dataCache[part].messages[key] = msgs;\n      } else {\n        let { entries } = dataCache[part].messages[key];\n        const lastEntry = entries.length ? entries[entries.length - 1] : null;\n        msgs = this.parseMessageEntry(msgs, dbc, lastEntry);\n        entries = entries.concat(msgs.entries);\n        dataCache[part].messages[key].entries = entries;\n      }\n      newMessages[key] = msgs;\n    });\n    dataCache[part].thumbnails = dataCache[part].thumbnails.concat(newThumbnails);\n\n    if (part >= currentParts[0] && part <= currentParts[1]) {\n      this.setState({\n        messages: this.addAndRehydrateMessages(newMessages)\n      });\n    }\n  }\n\n  async loadMessagesFromCache() {\n    // create a new messages object for state\n    if (this.loadMessagesFromCacheRunning) {\n      if (!this.loadMessagesFromCacheTimer) {\n        this.loadMessagesFromCacheTimer = timeout(() => this.loadMessagesFromCache(), 10);\n      }\n      return;\n    }\n    this.loadMessagesFromCacheRunning = true;\n    if (this.loadMessagesFromCacheTimer) {\n      this.loadMessagesFromCacheTimer();\n      this.loadMessagesFromCacheTimer = null;\n    }\n    const { currentParts, dbc } = this.state;\n    const { lastUpdated } = dbc;\n    const [minPart, maxPart] = currentParts;\n    const messages = {};\n    let thumbnails = [];\n    let isCanceled = false;\n\n    let start = performance.now();\n\n    const promises = [];\n\n    for (let i = minPart, l = maxPart; i <= l; ++i) {\n      promises.push(this.getParseSegment(i));\n    }\n    await promises.reduce(async (prev, p) => {\n      await prev;\n      if (isCanceled) {\n        return;\n      }\n      const cacheEntry = await p;\n      if (this.state.dbc.lastUpdated !== lastUpdated) {\n        if (!isCanceled) {\n          isCanceled = true;\n          this.loadMessagesFromCacheRunning = false;\n          console.log('Canceling!');\n          this.loadMessagesFromCache();\n        }\n        return;\n      }\n      if (cacheEntry) {\n        const newMessages = cacheEntry.messages;\n        thumbnails = thumbnails.concat(cacheEntry.thumbnails);\n        Object.keys(newMessages).forEach((key) => {\n          if (!messages[key]) {\n            messages[key] = { ...newMessages[key] };\n          } else {\n            const newMessageEntries = newMessages[key].entries;\n            const messageEntries = messages[key].entries;\n            if (newMessageEntries.length\n              && newMessageEntries[0].relTime < messageEntries[messageEntries.length - 1].relTime) {\n              console.error('Found out of order messages', newMessageEntries[0], messageEntries[messageEntries.length - 1]);\n            }\n            messages[key].entries = messages[key].entries.concat(newMessages[key].entries);\n          }\n        });\n      }\n      console.log('Done with', performance.now() - start);\n      start = performance.now();\n    }, Promise.resolve());\n\n    if (isCanceled) {\n      return;\n    }\n\n    Object.keys(this.state.messages).forEach((key) => {\n      if (!messages[key]) {\n        messages[key] = this.state.messages[key];\n        messages[key].entries = [];\n      }\n    });\n\n    Object.keys(messages).forEach((key) => {\n      messages[key].frame = dbc.getMessageFrame(\n        messages[key].address\n      );\n    });\n\n    const maxByteStateChangeCount = DbcUtils.findMaxByteStateChangeCount(\n      messages\n    );\n\n    this.setState({\n      maxByteStateChangeCount\n    });\n\n    Object.keys(messages).forEach((key) => {\n      // console.log(key);\n      messages[key] = DbcUtils.setMessageByteColors(\n        messages[key],\n        maxByteStateChangeCount\n      );\n    });\n\n    console.log('Done with old messages', performance.now() - start);\n\n    this.setState({ messages, thumbnails });\n\n    this.loadMessagesFromCacheRunning = false;\n  }\n\n  async getParseSegment(part) {\n    if (!dataCache[part]) {\n      return null;\n    }\n    if (dataCache[part].promise) {\n      await dataCache[part].promise;\n    }\n    dataCache[part].promise = this.getParseSegmentInternal(part);\n\n    return dataCache[part].promise;\n  }\n\n  async getParseSegmentInternal(part) {\n    const start = performance.now();\n    const { dbc } = this.state;\n    if (!dbc.lastUpdated) {\n      dbc.lastUpdated = Date.now();\n    }\n    const { lastUpdated } = dbc;\n    let { messages } = dataCache[part];\n\n    let reparseMessages = {};\n\n    // if (lastUpdated > dataCache[part].lastUpdated) {\n    //   dataCache[part].lastUpdated = Date.now();\n    //   return await this.reparseMessages(messages);\n    // }\n\n    Object.keys(messages).forEach((key) => {\n      if (messages[key].lastUpdated >= lastUpdated) {\n        return;\n      }\n      reparseMessages[key] = messages[key];\n    });\n\n    if (Object.keys(reparseMessages).length) {\n      console.log('Reparsing messages!', Object.keys(reparseMessages).length);\n      reparseMessages = await this.reparseMessages(reparseMessages);\n    }\n\n    messages = {\n      ...messages,\n      ...reparseMessages\n    };\n\n    dataCache[part].messages = messages;\n\n    const end = performance.now();\n    if (end - start > 200) {\n      // warn about anything over 200ms\n      console.warn('getParseSegment took', part, end - start, Object.keys(messages).length);\n    }\n\n    return dataCache[part];\n  }\n\n  decacheMessageId(messageId) {\n    Object.keys(dataCache).forEach((part) => {\n      if (dataCache[part].messages[messageId]) {\n        dataCache[part].messages[messageId].lastUpdated = 0;\n      }\n    });\n  }\n\n  async reparseMessages(_messages) {\n    const messages = _messages;\n    const { dbc } = this.state;\n    dbc.lastUpdated = dbc.lastUpdated || Date.now();\n\n    Object.keys(messages).forEach((key) => {\n      messages[key].frame = dbc.getMessageFrame(messages[key].address);\n    });\n\n    return new Promise((resolve, reject) => {\n      const worker = new MessageParser();\n      worker.onmessage = (e) => {\n        const newMessages = e.data.messages;\n        Object.keys(newMessages).forEach((key) => {\n          newMessages[key].lastUpdated = dbc.lastUpdated;\n          newMessages[key].frame = dbc.getMessageFrame(newMessages[key].address);\n        });\n        resolve(newMessages);\n      };\n\n      worker.postMessage({\n        messages,\n        dbcText: dbc.text(),\n        canStartTime: this.state.firstCanTime\n      });\n    });\n  }\n\n  parseMessageEntry(_entry, dbc, lastMsg) {\n    const entry = _entry;\n    dbc.lastUpdated = dbc.lastUpdated || Date.now();\n    entry.lastUpdated = dbc.lastUpdated;\n    entry.frame = dbc.getMessageFrame(\n      entry.address\n    );\n\n    let prevMsgEntry = lastMsg || null;\n    const byteStateChangeCounts = [];\n    // entry.messages[id].byteStateChangeCounts = byteStateChangeCounts.map(\n    //   (count, idx) => entry.messages[id].byteStateChangeCounts[idx] + count\n    // );\n    entry.entries = entry.entries.map((message) => {\n      if (message.hexData) {\n        prevMsgEntry = DbcUtils.reparseMessage(dbc, message, prevMsgEntry);\n      } else {\n        prevMsgEntry = DbcUtils.parseMessage(\n          dbc,\n          message.time,\n          message.address,\n          message.data,\n          message.timeStart,\n          prevMsgEntry\n        );\n      }\n      byteStateChangeCounts.push(prevMsgEntry.byteStateChangeCounts);\n      prevMsgEntry = prevMsgEntry.msgEntry;\n      return prevMsgEntry;\n    });\n    entry.byteStateChangeCounts = byteStateChangeCounts.reduce((memo, val) => {\n      if (!memo) {\n        return val;\n      }\n      return memo.map((count, idx) => val[idx] + count);\n    }, null);\n\n    return entry;\n  }\n\n  showingModal() {\n    const {\n      showOnboarding,\n      showLoadDbc,\n      showSaveDbc,\n      showAddSignal,\n      showEditMessageModal\n    } = this.state;\n    return (\n      showOnboarding\n      || showLoadDbc\n      || showSaveDbc\n      || showAddSignal\n      || showEditMessageModal\n    );\n  }\n\n  showOnboarding() {\n    if (!CommaAuth.isAuthenticated() && window.sessionStorage && window.location &&\n      window.location.pathname !== AuthConfig.AUTH_PATH)\n    {\n      window.sessionStorage.setItem('onboardingPath', window.location.href);\n    }\n    this.setState({ showOnboarding: true });\n  }\n\n  hideOnboarding() {\n    this.setState({ showOnboarding: false });\n  }\n\n  showLoadDbc() {\n    this.setState({ showLoadDbc: true });\n  }\n\n  hideLoadDbc() {\n    this.setState({ showLoadDbc: false });\n  }\n\n  showSaveDbc() {\n    this.setState({ showSaveDbc: true });\n  }\n\n  hideSaveDbc() {\n    this.setState({ showSaveDbc: false });\n  }\n\n  updateMessageFrame(messageId, frame) {\n    const { messages } = this.state;\n\n    messages[messageId].frame = frame;\n    this.setState({ messages });\n  }\n\n  persistDbc({ dbcFilename, dbc }) {\n    const { route } = this.state;\n    if (route) {\n      persistDbc(route.fullname, { dbcFilename, dbc });\n    } else {\n      persistDbc('live', { dbcFilename, dbc });\n    }\n\n    this.loadMessagesFromCache();\n  }\n\n  onConfirmedSignalChange(message, signals) {\n    const { dbc, dbcFilename } = this.state;\n    const frameSize = DbcUtils.maxMessageSize(message);\n    dbc.setSignals(message.address, { ...signals }, frameSize);\n\n    this.persistDbc({ dbcFilename, dbc });\n\n    this.updateMessageFrame(message.id, dbc.getMessageFrame(message.address));\n\n    this.setState({ dbc, dbcText: dbc.text() }, () => {\n      this.decacheMessageId(message.id);\n      this.loadMessagesFromCache();\n    });\n  }\n\n  partChangeDebounced = debounce(() => {\n    this.loadMessagesFromCache();\n\n    this.spawnWorker();\n  }, 500);\n\n  onPartChange(part) {\n    let {\n      currentParts, currentPart, canFrameOffset, route\n    } = this.state;\n    if (canFrameOffset === -1 || part === currentPart) {\n      return;\n    }\n\n    // determine new parts to load, whether to prepend or append\n    let maxPart = Math.min(route.proclog, part + 1);\n    const minPart = Math.max(0, maxPart - PART_SEGMENT_LENGTH + 1);\n    if (minPart === 0) {\n      maxPart = Math.min(route.proclog, 2);\n    }\n\n    // update current parts\n    currentParts = [minPart, maxPart];\n    currentPart = part;\n\n    if (\n      currentPart !== this.state.currentPart\n      || currentParts[0] !== this.state.currentParts[0]\n      || currentParts[1] !== this.state.currentParts[1]\n    ) {\n      // update state then load new parts\n      this.setState({ currentParts, currentPart }, this.partChangeDebounced);\n    }\n  }\n\n  showEditMessageModal(msgKey) {\n    const msg = this.state.messages[msgKey];\n    console.log(msg);\n    if (!msg.frame) {\n      msg.frame = this.state.dbc.createFrame(msg.address);  // TODO frameSize\n    }\n\n    this.setState({\n      showEditMessageModal: true,\n      editMessageModalMessage: msgKey,\n      messages: this.state.messages,\n      dbcText: this.state.dbc.text()\n    });\n  }\n\n  hideEditMessageModal() {\n    this.setState({ showEditMessageModal: false });\n  }\n\n  onMessageFrameEdited(messageFrame) {\n    const {\n      messages, dbcFilename, dbc, editMessageModalMessage\n    } = this.state;\n\n    const message = { ...messages[editMessageModalMessage] };\n    message.frame = messageFrame;\n    dbc.messages.set(messageFrame.id, messageFrame);\n    this.persistDbc({ dbcFilename, dbc });\n\n    messages[editMessageModalMessage] = message;\n    this.setState({ messages, dbc, dbcText: dbc.text() });\n    this.hideEditMessageModal();\n  }\n\n  onSeek(seekIndex, seekTime) {\n    this.setState({ seekIndex, seekTime });\n\n    const { currentPart } = this.state;\n    const part = ~~(seekTime / 60);\n    if (part !== currentPart) {\n      this.onPartChange(part);\n    }\n  }\n\n  onUserSeek(seekTime) {\n    if (USE_UNLOGGER) {\n      this.unloggerClient.seek(this.props.dongleId, this.props.name, seekTime);\n    }\n\n    const msg = this.state.messages[this.state.selectedMessage];\n    let seekIndex;\n    if (msg) {\n      seekIndex = msg.entries.findIndex((e) => e.relTime >= seekTime);\n      if (seekIndex === -1) {\n        seekIndex = 0;\n      }\n    } else {\n      seekIndex = 0;\n    }\n\n    this.onSeek(seekIndex, seekTime);\n  }\n\n  onMessageSelected(msgKey) {\n    let { seekTime, seekIndex, messages } = this.state;\n    const msg = messages[msgKey];\n\n    if (seekTime > 0 && msg.entries.length > 0) {\n      seekIndex = msg.entries.findIndex((e) => e.relTime >= seekTime);\n      if (seekIndex === -1) {\n        seekIndex = 0;\n      }\n\n      seekTime = msg.entries[seekIndex].relTime;\n    }\n\n    this.setState({ seekTime, seekIndex, selectedMessage: msgKey });\n  }\n\n  updateSelectedMessages(selectedMessages) {\n    this.setState({ selectedMessages });\n  }\n\n  onMessageUnselected(msgKey) {\n    this.setState({ selectedMessage: null });\n  }\n\n  loginWithGithub() {\n    const { route } = this.state;\n    return (\n      <a\n        href={GithubAuth.authorizeUrl(\n          route && route.fullname ? route.fullname : ''\n        )}\n        className=\"button button--dark button--inline\"\n      >\n        <i className=\"fa fa-github\" />\n        <span> Log in with Github</span>\n      </a>\n    );\n  }\n\n  lastMessageEntriesById(obj, [msgId, message]) {\n    obj[msgId] = message.entries[message.entries.length - 1];\n    return obj;\n  }\n\n  processStreamedCanMessages(newCanMessages) {\n    const { dbcText } = this.state;\n    const {\n      firstCanTime,\n      lastBusTime,\n      messages,\n      maxByteStateChangeCount\n    } = this.state;\n    // map msg id to arrays\n    const prevMsgEntries = Object.entries(messages).reduce(\n      this.lastMessageEntriesById,\n      {}\n    );\n\n    const byteStateChangeCountsByMessage = Object.entries(messages).reduce(\n      (obj, [msgId, msg]) => {\n        obj[msgId] = msg.byteStateChangeCounts;\n        return obj;\n      },\n      {}\n    );\n\n    this.canStreamerWorker.postMessage({\n      newCanMessages,\n      prevMsgEntries,\n      firstCanTime,\n      dbcText,\n      lastBusTime,\n      byteStateChangeCountsByMessage,\n      maxByteStateChangeCount\n    });\n  }\n\n  firstEntryIndexInsideStreamingWindow(entries) {\n    const lastEntryTime = entries[entries.length - 1].relTime;\n    const windowFloor = lastEntryTime - STREAMING_WINDOW;\n\n    for (let i = 0; i < entries.length; i++) {\n      if (entries[i].relTime > windowFloor) {\n        return i;\n      }\n    }\n\n    return 0;\n  }\n\n  enforceStreamingMessageWindow(messages) {\n    const messageIds = Object.keys(messages);\n    for (let i = 0; i < messageIds.length; i++) {\n      const messageId = messageIds[i];\n      const message = messages[messageId];\n      if (message.entries.length < 2) {\n        continue;\n      }\n\n      const lastEntryTime = message.entries[message.entries.length - 1].relTime;\n      const entrySpan = lastEntryTime - message.entries[0].relTime;\n      if (entrySpan > STREAMING_WINDOW) {\n        const newEntryFloor = this.firstEntryIndexInsideStreamingWindow(\n          message.entries\n        );\n        message.entries = message.entries.slice(newEntryFloor);\n        messages[messageId] = message;\n      }\n    }\n\n    return messages;\n  }\n\n  _onStreamedCanMessagesProcessed(data) {\n    let {\n      newMessages,\n      seekTime,\n      lastBusTime,\n      firstCanTime,\n      maxByteStateChangeCount\n    } = data;\n\n    if (maxByteStateChangeCount < this.state.maxByteStateChangeCount) {\n      maxByteStateChangeCount = this.state.maxByteStateChangeCount;\n    }\n\n    let messages = this.addAndRehydrateMessages(newMessages);\n    messages = this.enforceStreamingMessageWindow(messages);\n    let { seekIndex, selectedMessages } = this.state;\n    if (\n      selectedMessages.length > 0\n      && messages[selectedMessages[0]] !== undefined\n    ) {\n      seekIndex = Math.max(0, messages[selectedMessages[0]].entries.length - 1);\n    }\n    this.setState({\n      messages,\n      seekTime,\n      seekIndex,\n      lastBusTime,\n      firstCanTime,\n      maxByteStateChangeCount\n    });\n  }\n\n  onStreamedCanMessagesProcessed(e) {\n    this._onStreamedCanMessagesProcessed(e.data);\n  }\n\n  async handlePandaConnect(e) {\n    this.setState({ attemptingPandaConnection: true, live: true });\n\n    const persistedDbc = fetchPersistedDbc('live');\n    if (persistedDbc) {\n      const { dbc, dbcText } = persistedDbc;\n      this.setState({ dbc, dbcText });\n    }\n    this.canStreamerWorker = new CanStreamerWorker();\n    this.canStreamerWorker.onmessage = this.onStreamedCanMessagesProcessed;\n\n    // if any errors go off during connection, mark as not trying to connect anymore...\n    const unlisten = this.pandaReader.onError((err) => {\n      console.error(err.stack || err);\n      this.setState({ attemptingPandaConnection: false });\n    });\n    try {\n      await this.pandaReader.start();\n      this.setState({\n        showOnboarding: false,\n        showLoadDbc: true\n      });\n    } catch (e) {}\n    this.setState({ attemptingPandaConnection: false });\n    unlisten();\n  }\n\n  githubSignOut(e, dataArray) {\n    unpersistGithubAuthToken();\n    this.setState({ isGithubAuthenticated: false });\n\n    e.preventDefault();\n  }\n\n  render() {\n    const {\n      route,\n      messages,\n      selectedMessages,\n      currentParts,\n      dbcFilename,\n      dbcLastSaved,\n      seekTime,\n      seekIndex,\n      shareUrl,\n      maxByteStateChangeCount,\n      live,\n      thumbnails,\n      selectedMessage,\n      canFrameOffset,\n      firstCanTime,\n      currentPart,\n      partsLoaded,\n      share,\n    } = this.state;\n\n    const { startTime, segments } = this.props;\n\n    return (\n      <div\n        id=\"cabana\"\n        className={cx({ 'is-showing-modal': this.showingModal() })}\n      >\n        <div className=\"cabana-header\">\n          <a className=\"cabana-header-logo\" href=\"/\">\n            Comma Cabana\n          </a>\n          <div className=\"cabana-header-account\">\n            {this.state.isGithubAuthenticated ? (\n              <div>\n                <p>GitHub Authenticated</p>\n                <p\n                  className=\"cabana-header-account-signout\"\n                  onClick={this.githubSignOut}\n                >\n                  Sign out\n                </p>\n              </div>\n            ) : (\n              this.loginWithGithub()\n            )}\n          </div>\n        </div>\n        <div className=\"cabana-window\">\n          <Meta\n            url={this.state.route ? route.url : null}\n            messages={messages}\n            selectedMessages={selectedMessages}\n            updateSelectedMessages={this.updateSelectedMessages}\n            showEditMessageModal={this.showEditMessageModal}\n            currentParts={currentParts}\n            onMessageSelected={this.onMessageSelected}\n            onMessageUnselected={this.onMessageUnselected}\n            showLoadDbc={this.showLoadDbc}\n            showSaveDbc={this.showSaveDbc}\n            dbcFilename={dbcFilename}\n            dbcLastSaved={dbcLastSaved}\n            dongleId={this.props.dongleId}\n            name={this.props.name}\n            route={route}\n            seekTime={seekTime}\n            seekIndex={seekIndex}\n            shareUrl={shareUrl}\n            maxByteStateChangeCount={maxByteStateChangeCount}\n            live={live}\n            saveLog={debounce(this.downloadLogAsCSV, 500)}\n          />\n          {route || live ? (\n            <Explorer\n              url={route ? route.url : null}\n              live={live}\n              messages={messages}\n              thumbnails={thumbnails}\n              selectedMessage={selectedMessage}\n              onConfirmedSignalChange={this.onConfirmedSignalChange}\n              onSeek={this.onSeek}\n              onUserSeek={this.onUserSeek}\n              canFrameOffset={canFrameOffset}\n              firstCanTime={firstCanTime}\n              seekTime={seekTime}\n              startTime={startTime}\n              startSegments={segments}\n              seekIndex={seekIndex}\n              currentParts={currentParts}\n              selectedPart={currentPart}\n              partsLoaded={partsLoaded}\n              autoplay={this.props.autoplay}\n              showEditMessageModal={this.showEditMessageModal}\n              onPartChange={this.onPartChange}\n              routeStartTime={\n                route ? route.start_time : Moment()\n              }\n              videoOffset={ (this.state.firstFrameTime && this.state.routeInitTime) ? this.state.firstFrameTime - this.state.routeInitTime : 0 }\n              partsCount={route ? route.proclog : 0}\n              maxqcamera={route ? route.maxqcamera : 0}\n              route={route}\n              share={share}\n            />\n          ) : null}\n        </div>\n\n        {this.state.showOnboarding ? (\n          <OnboardingModal\n            handlePandaConnect={this.handlePandaConnect}\n            attemptingPandaConnection={this.state.attemptingPandaConnection}\n            routes={this.state.routes}\n          />\n        ) : null}\n\n        {this.state.showLoadDbc ? (\n          <LoadDbcModal\n            onDbcSelected={this.onDbcSelected}\n            handleClose={this.hideLoadDbc}\n            openDbcClient={this.openDbcClient}\n            loginWithGithub={this.loginWithGithub()}\n          />\n        ) : null}\n\n        {this.state.showSaveDbc ? (\n          <SaveDbcModal\n            dbc={this.state.dbc}\n            sourceDbcFilename={this.state.dbcFilename}\n            onDbcSaved={this.onDbcSaved}\n            handleClose={this.hideSaveDbc}\n            openDbcClient={this.openDbcClient}\n            hasGithubAuth={this.props.githubAuthToken !== null}\n            loginWithGithub={this.loginWithGithub()}\n          />\n        ) : null}\n\n        {this.state.showEditMessageModal ? (\n          <EditMessageModal\n            handleClose={this.hideEditMessageModal}\n            handleSave={this.onMessageFrameEdited}\n            message={this.state.messages[this.state.editMessageModalMessage]}\n          />\n        ) : null}\n      </div>\n    );\n  }\n}\n\nCanExplorer.propTypes = {\n  dongleId: PropTypes.string,\n  name: PropTypes.string,\n  dbc: PropTypes.instanceOf(DBC),\n  dbcFilename: PropTypes.string,\n  githubAuthToken: PropTypes.string,\n  autoplay: PropTypes.bool,\n  max: PropTypes.number,\n  url: PropTypes.string,\n  startTime: PropTypes.number,\n  segments: PropTypes.array\n};\n","export function hash(str) {\n  let hash = 5381;\n  let i = str.length;\n\n  while (i) {\n    hash = (hash * 33) ^ str.charCodeAt(--i);\n  }\n\n  // to positive number\n  return (hash >>> 0).toString(16);\n}\n","import Raven from 'raven-js';\n\nfunction init() {\n  if (process.env.NODE_ENV === 'production') {\n    const opts = {};\n\n    if (typeof __webpack_hash__ !== 'undefined') { // eslint-disable-line camelcase\n      opts.release = __webpack_hash__; // eslint-disable-line no-undef, camelcase\n    }\n\n    Raven.config(\n      'https://50006e5d91894f508dd288bbbf4585a6@sentry.io/185303',\n      opts\n    ).install();\n  }\n}\n\nexport default { init };\n","import CorollaDBC from './corolla-dbc';\n\nexport const demoProps = {\n  max: 10,\n  name: '2021-09-29--13-46-36',\n  dongleId: '4cf7a6ad03080c90',\n  dbc: CorollaDBC,\n  isDemo: true,\n  dbcFilename: 'toyota_new_mc_pt_generated.dbc',\n};\n","import DBC from './models/can/dbc';\n\nconst CorollaDBC = new DBC(`\nCM_ \"AUTOGENERATED FILE, DO NOT EDIT\"\n\n\nCM_ \"Imported file _comma.dbc starts here\"\nBO_ 359 STEERING_IPAS_COMMA: 8 IPAS\n SG_ STATE : 7|4@0+ (1,0) [0|15] \"\" XXX\n SG_ ANGLE : 3|12@0- (1.5,0) [-510|510] \"deg\" XXX\n SG_ SET_ME_X10 : 23|8@0+ (1,0) [0|255] \"\" XXX\n SG_ SET_ME_X00 : 31|8@0+ (1,0) [0|255] \"\" XXX\n SG_ DIRECTION_CMD : 38|2@0+ (1,0) [0|3] \"\" XXX\n SG_ SET_ME_X40 : 47|8@0+ (1,0) [0|255] \"\" XXX\n SG_ SET_ME_X00 : 55|8@0+ (1,0) [0|255] \"\" XXX\n SG_ CHECKSUM : 63|8@0+ (1,0) [0|255] \"\" XXX\n\nCM BO_ STEERING_IPAS_COMMA \"Copy of msg 614 so we can do angle control while the Park Assist ECU is connected (Panda spoofs 614 with 359 on connector J70). Note that addresses 0x266 and 0x167 are checksum-invariant\";\n\n BO_ 512 GAS_COMMAND: 6 EON\n  SG_ GAS_COMMAND : 7|16@0+ (0.159375,-75.555) [0|1] \"\" INTERCEPTOR\n  SG_ GAS_COMMAND2 : 23|16@0+ (0.159375,-151.111) [0|1] \"\" INTERCEPTOR\n  SG_ ENABLE : 39|1@0+ (1,0) [0|1] \"\" INTERCEPTOR\n  SG_ COUNTER_PEDAL : 35|4@0+ (1,0) [0|15] \"\" INTERCEPTOR\n  SG_ CHECKSUM_PEDAL : 47|8@0+ (1,0) [0|255] \"\" INTERCEPTOR\n\n BO_ 513 GAS_SENSOR: 6 INTERCEPTOR\n  SG_ INTERCEPTOR_GAS : 7|16@0+ (0.159375,-75.555) [0|1] \"\" EON\n  SG_ INTERCEPTOR_GAS2 : 23|16@0+ (0.159375,-151.111) [0|1] \"\" EON\n  SG_ STATE : 39|4@0+ (1,0) [0|15] \"\" EON\n  SG_ COUNTER_PEDAL : 35|4@0+ (1,0) [0|15] \"\" EON\n  SG_ CHECKSUM_PEDAL : 47|8@0+ (1,0) [0|255] \"\" EON\n\n VAL_ 513 STATE 5 \"FAULT_TIMEOUT\" 4 \"FAULT_STARTUP\" 3 \"FAULT_SCE\" 2 \"FAULT_SEND\" 1 \"FAULT_BAD_CHECKSUM\" 0 \"NO_FAULT\" ;\n\n\nCM_ \"Imported file _toyota_2017.dbc starts here\"\nVERSION \"\"\n\n\nNS_ :\n    NS_DESC_\n    CM_\n    BA_DEF_\n    BA_\n    VAL_\n    CAT_DEF_\n    CAT_\n    FILTER\n    BA_DEF_DEF_\n    EV_DATA_\n    ENVVAR_DATA_\n    SGTYPE_\n    SGTYPE_VAL_\n    BA_DEF_SGTYPE_\n    BA_SGTYPE_\n    SIG_TYPE_REF_\n    VAL_TABLE_\n    SIG_GROUP_\n    SIG_VALTYPE_\n    SIGTYPE_VALTYPE_\n    BO_TX_BU_\n    BA_DEF_REL_\n    BA_REL_\n    BA_DEF_DEF_REL_\n    BU_SG_REL_\n    BU_EV_REL_\n    BU_BO_REL_\n    SG_MUL_VAL_\n\nBS_:\n\nBU_: XXX DSU HCU EPS IPAS CGW\n\nBO_ 36 KINEMATICS: 8 XXX\n SG_ ACCEL_Y : 33|10@0+ (0.03589,-18.375) [0|65535] \"m/s^2\" XXX\n SG_ YAW_RATE : 1|10@0+ (0.244,-125) [0|65535] \"deg/sec\" XXX\n SG_ STEERING_TORQUE : 17|10@0+ (1,-512) [0|65535] \"\" XXX\n\nBO_ 37 STEER_ANGLE_SENSOR: 8 XXX\n SG_ STEER_ANGLE : 3|12@0- (1.5,0) [-500|500] \"deg\" XXX\n SG_ STEER_FRACTION : 39|4@0- (0.1,0) [-0.7|0.7] \"deg\" XXX\n SG_ STEER_RATE : 35|12@0- (1,0) [-2000|2000] \"deg/s\" XXX\n\nBO_ 166 BRAKE: 8 XXX\n SG_ BRAKE_AMOUNT : 7|8@0+ (1,0) [0|255] \"\" XXX\n SG_ BRAKE_PEDAL : 23|8@0+ (1,0) [0|255] \"\" XXX\n\nBO_ 170 WHEEL_SPEEDS: 8 XXX\n SG_ WHEEL_SPEED_FR : 7|16@0+ (0.01,-67.67) [0|250] \"kph\" XXX\n SG_ WHEEL_SPEED_FL : 23|16@0+ (0.01,-67.67) [0|250] \"kph\" XXX\n SG_ WHEEL_SPEED_RR : 39|16@0+ (0.01,-67.67) [0|250] \"kph\" XXX\n SG_ WHEEL_SPEED_RL : 55|16@0+ (0.01,-67.67) [0|250] \"kph\" XXX\n\nBO_ 180 SPEED: 8 XXX\n SG_ ENCODER : 39|8@0+ (1,0) [0|255] \"\" XXX\n SG_ SPEED : 47|16@0+ (0.01,0) [0|250] \"kph\" XXX\n SG_ CHECKSUM : 63|8@0+ (1,0) [0|255] \"\" XXX\n\nBO_ 353 DSU_SPEED: 8 XXX\n SG_ FORWARD_SPEED : 15|16@0- (0.00390625,-30) [0|255] \"kph\" XXX\n\nBO_ 466 PCM_CRUISE: 8 XXX\n SG_ GAS_RELEASED : 4|1@0+ (1,0) [0|1] \"\" XXX\n SG_ CRUISE_ACTIVE : 5|1@0+ (1,0) [0|1] \"\" XXX\n SG_ STANDSTILL_ON : 12|1@0+ (1,0) [0|1] \"\" XXX\n SG_ ACCEL_NET : 23|16@0- (0.001,0) [-20|20] \"m/s2\" XXX\n SG_ CRUISE_STATE : 55|4@0+ (1,0) [0|15] \"\" XXX\n SG_ CANCEL_REQ : 49|1@1+ (1,0) [0|1] \"\" XXX\n SG_ CHECKSUM : 63|8@0+ (1,0) [0|255] \"\" XXX\n\nBO_ 467 PCM_CRUISE_2: 8 XXX\n SG_ MAIN_ON : 15|1@0+ (1,0) [0|1] \"\" XXX\n SG_ LOW_SPEED_LOCKOUT : 14|2@0+ (1,0) [0|3] \"kph\" XXX\n SG_ SET_SPEED : 23|8@0+ (1,0) [0|255] \"kph\" XXX\n SG_ CHECKSUM : 63|8@0+ (1,0) [0|255] \"\" XXX\n\nBO_ 552 ACCELEROMETER: 8 XXX\n SG_ ACCEL_Z : 22|15@0- (1,0) [0|32767] \"\" XXX\n SG_ ACCEL_X : 6|15@0- (0.001,0) [-20|20] \"m/s2\" XXX\n\nBO_ 560 BRAKE_MODULE2: 7 XXX\n SG_ BRAKE_PRESSED : 26|1@0+ (1,0) [0|1] \"\" XXX\n\nBO_ 614 STEERING_IPAS: 8 IPAS\n SG_ STATE : 7|4@0+ (1,0) [0|15] \"\" XXX\n SG_ ANGLE : 3|12@0- (1.5,0) [-510|510] \"deg\" XXX\n SG_ SET_ME_X10 : 23|8@0+ (1,0) [0|255] \"\" XXX\n SG_ SET_ME_X00 : 31|8@0+ (1,0) [0|255] \"\" XXX\n SG_ DIRECTION_CMD : 38|2@0+ (1,0) [0|3] \"\" XXX\n SG_ SET_ME_X40 : 47|8@0+ (1,0) [0|255] \"\" XXX\n SG_ SET_ME_X00_1 : 55|8@0+ (1,0) [0|255] \"\" XXX\n SG_ CHECKSUM : 63|8@0+ (1,0) [0|255] \"\" XXX\n\nBO_ 643 PRE_COLLISION: 7 DSU\n SG_ COUNTER : 7|8@0+ (1,0) [0|255] \"\" XXX\n SG_ SET_ME_X00 : 15|8@0+ (1,0) [0|255] \"\" XXX\n SG_ FORCE : 23|16@0- (2,0) [0|255] \"N\" XXX\n SG_ SET_ME_X002 : 33|8@0+ (1,0) [0|3] \"\" XXX\n SG_ BRAKE_STATUS : 39|3@0+ (1,0) [0|255] \"\" XXX\n SG_ STATE : 36|3@0+ (1,0) [0|255] \"\" XXX\n SG_ SET_ME_X003 : 40|1@0+ (1,0) [0|1] \"\" XXX\n SG_ PRECOLLISION_ACTIVE : 41|1@0+ (1,0) [0|255] \"\" XXX\n SG_ CHECKSUM : 55|8@0+ (1,0) [0|255] \"\" XXX\n\nBO_ 740 STEERING_LKA: 5 XXX\n SG_ LKA_STATE : 31|8@0+ (1,0) [0|255] \"\" XXX\n SG_ STEER_REQUEST : 0|1@0+ (1,0) [0|1] \"\" XXX\n SG_ COUNTER : 6|6@0+ (1,0) [0|63] \"\" XXX\n SG_ SET_ME_1 : 7|1@0+ (1,0) [0|1] \"\" XXX\n SG_ STEER_TORQUE_CMD : 15|16@0- (1,0) [0|65535] \"\" XXX\n SG_ CHECKSUM : 39|8@0+ (1,0) [0|255] \"\" XXX\n\nBO_ 742 LEAD_INFO: 8 DSU\n SG_ CHECKSUM : 63|8@0+ (1,0) [0|255] \"\" HCU\n SG_ LEAD_REL_SPEED : 23|12@0- (0.025,0) [-100|100] \"m/s\" HCU\n SG_ LEAD_LONG_DIST : 7|13@0+ (0.05,0) [0|300] \"m\" HCU\n\nBO_ 835 ACC_CONTROL: 8 DSU\n SG_ ACCEL_CMD : 7|16@0- (0.001,0) [-20|20] \"m/s2\" HCU\n SG_ SET_ME_X01 : 23|2@0+ (1,0) [0|3] \"\" HCU\n SG_ DISTANCE : 20|1@0+ (1,0) [0|1] \"\" XXX\n SG_ MINI_CAR : 21|1@0+ (1,0) [0|1] \"\" XXX\n SG_ SET_ME_X3 : 19|4@0+ (1,0) [0|15] \"\" XXX\n SG_ SET_ME_1 : 30|1@0+ (1,0) [0|1] \"\" HCU\n SG_ RELEASE_STANDSTILL : 31|1@0+ (1,0) [0|1] \"\" HCU\n SG_ CANCEL_REQ : 24|1@0+ (1,0) [0|1] \"\" HCU\n SG_ CHECKSUM : 63|8@0+ (1,0) [0|255] \"\" XXX\n\nBO_ 836 PRE_COLLISION_2: 8 DSU\n SG_ CHECKSUM : 63|8@0+ (1,0) [0|0] \"\" XXX\n\nBO_ 869 DSU_CRUISE : 7 DSU\n SG_ RES_BTN : 3|1@0+ (1,0) [0|0] \"\" XXX\n SG_ SET_BTN : 2|1@0+ (1,0) [0|0] \"\" XXX\n SG_ CANCEL_BTN : 1|1@0+ (1,0) [0|0] \"\" XXX\n SG_ MAIN_ON : 0|1@0+ (1,0) [0|0] \"\" XXX\n SG_ SET_SPEED : 15|8@0+ (1,0) [0|0] \"km/h\" XXX\n SG_ CRUISE_REQUEST : 31|8@0+ (100,-12800) [0|0] \"N\" XXX\n SG_ LEAD_DISTANCE : 39|8@0+ (1,0) [0|0] \"m\" XXX\n\nBO_ 921 PCM_CRUISE_SM: 8 XXX\n SG_ MAIN_ON : 4|1@0+ (1,0) [0|1] \"\" XXX\n SG_ CRUISE_CONTROL_STATE : 11|4@0+ (1,0) [0|15] \"\" XXX\n SG_ DISTANCE_LINES : 14|2@0+ (1,0) [0|3] \"\" XXX\n SG_ UI_SET_SPEED : 31|8@0+ (1,0) [0|255] \"\" XXX\n\nBO_ 951 ESP_CONTROL: 8 ESP\n SG_ TC_DISABLED : 13|1@0+ (1,0) [0|1] \"\" XXX\n SG_ VSC_DISABLED : 12|2@0+ (1,0) [0|1] \"\" XXX\n SG_ BRAKE_LIGHTS_ACC : 18|1@0+ (1,0) [0|1] \"\" XXX\n\nBO_ 1041 ACC_HUD: 8 DSU\n SG_ FCW : 4|1@0+ (1,0) [0|1] \"\" XXX\n SG_ SET_ME_X20 : 15|8@0+ (1,0) [0|1] \"\" XXX\n SG_ SET_ME_X10 : 39|8@0+ (1,0) [0|1] \"\" XXX\n SG_ SET_ME_X80 : 55|8@0+ (1,0) [0|1] \"\" XXX\n\nBO_ 1042 LKAS_HUD: 8 XXX\n SG_ BARRIERS : 1|2@0+ (1,0) [0|3] \"\" XXX\n SG_ RIGHT_LINE : 3|2@0+ (1,0) [0|3] \"\" XXX\n SG_ LEFT_LINE : 5|2@0+ (1,0) [0|3] \"\" XXX\n SG_ SET_ME_X01 : 7|2@0+ (1,0) [0|3] \"\" XXX\n SG_ SET_ME_X01_2 : 11|2@0+ (1,0) [0|3] \"\" XXX\n SG_ LDA_ALERT : 9|2@0+ (1,0) [0|3] \"\" XXX\n SG_ TWO_BEEPS : 12|1@0+ (1,0) [0|1] \"\" XXX\n SG_ ADJUSTING_CAMERA : 13|1@0+ (1,0) [0|1] \"\" XXX\n SG_ LDA_MALFUNCTION : 15|1@0+ (1,0) [0|1] \"\" XXX\n SG_ REPEATED_BEEPS : 32|1@0+ (1,0) [0|1] \"\" XXX\n SG_ SET_ME_X0C : 23|8@0+ (1,0) [0|1] \"\" XXX\n SG_ SET_ME_X2C : 47|8@0+ (1,0) [0|1] \"\" XXX\n SG_ SET_ME_X38 : 55|8@0+ (1,0) [0|1] \"\" XXX\n SG_ SET_ME_X02 : 63|8@0+ (1,0) [0|1] \"\" XXX\n\nBO_ 1043 TIME : 8 CGW\n SG_ YEAR : 7|8@0+ (1,0) [0|0] \"year\" XXX\n SG_ MONTH : 15|8@0+ (1,0) [0|0] \"month\" XXX\n SG_ DAY : 23|8@0+ (1,0) [0|0] \"day\" XXX\n SG_ HOUR : 31|8@0+ (1,0) [0|0] \"hour\" XXX\n SG_ MINUTE : 39|8@0+ (1,0) [0|0] \"minute\" XXX\n SG_ GMT_DIFF : 55|1@0+ (1,0) [0|0] \"\" XXX\n SG_ GMTDIFF_HOURS : 54|4@0+ (1,0) [0|0] \"hours\" XXX\n SG_ GMTDIFF_MINUTES : 50|6@0+ (1,0) [0|0] \"minutes\" XXX\n SG_ SUMMER : 60|1@0+ (1,0) [0|0] \"\" XXX\n\nBO_ 1408 VIN_PART_1: 8 CGW\n SG_ VIN_1 : 7|8@0+ (1,0) [0|0] \"\" XXX\n SG_ VIN_2 : 15|8@0+ (1,0) [0|0] \"\" XXX\n SG_ VIN_3 : 23|8@0+ (1,0) [0|0] \"\" XXX\n SG_ VIN_4 : 31|8@0+ (1,0) [0|0] \"\" XXX\n SG_ VIN_5 : 39|8@0+ (1,0) [0|0] \"\" XXX\n SG_ VIN_6 : 47|8@0+ (1,0) [0|0] \"\" XXX\n SG_ VIN_7 : 55|8@0+ (1,0) [0|0] \"\" XXX\n SG_ VIN_8 : 63|8@0+ (1,0) [0|0] \"\" XXX\n\nBO_ 1409 VIN_PART_2: 8 CGW\n SG_ VIN_9 : 7|8@0+ (1,0) [0|0] \"\" XXX\n SG_ VIN_10 : 15|8@0+ (1,0) [0|0] \"\" XXX\n SG_ VIN_11 : 23|8@0+ (1,0) [0|0] \"\" XXX\n SG_ VIN_12 : 31|8@0+ (1,0) [0|0] \"\" XXX\n SG_ VIN_13 : 39|8@0+ (1,0) [0|0] \"\" XXX\n SG_ VIN_14 : 47|8@0+ (1,0) [0|0] \"\" XXX\n SG_ VIN_15 : 55|8@0+ (1,0) [0|0] \"\" XXX\n SG_ VIN_16 : 63|8@0+ (1,0) [0|0] \"\" XXX\n\nBO_ 1410 VIN_PART_3: 8 CGW\n SG_ VIN_17 : 7|8@0+ (1,0) [0|0] \"\" XXX\n\nBO_ 1553 UI_SETTING: 8 XXX\n SG_ UNITS : 26|2@0+ (1,0) [0|3] \"\" XXX\n\nBO_ 1556 STEERING_LEVERS: 8 XXX\n SG_ TURN_SIGNALS : 29|2@0+ (1,0) [0|3] \"\" XXX\n\nBO_ 1568 SEATS_DOORS: 8 XXX\n SG_ SEATBELT_DRIVER_UNLATCHED : 62|1@0+ (1,0) [0|1] \"\" XXX\n SG_ DOOR_OPEN_FL : 45|1@0+ (1,0) [0|1] \"\" XXX\n SG_ DOOR_OPEN_RL : 42|1@0+ (1,0) [0|1] \"\" XXX\n SG_ DOOR_OPEN_RR : 43|1@0+ (1,0) [0|1] \"\" XXX\n SG_ DOOR_OPEN_FR : 44|1@0+ (1,0) [0|1] \"\" XXX\n\nBO_ 1570 LIGHT_STALK: 8 SCM\n SG_ AUTO_HIGH_BEAM : 37|1@0+ (1,0) [0|1] \"\" XXX\n\nBO_ 1161 RSA1: 8 FCM\n SG_ TSGN1 : 7|8@0+ (1,0) [0|0] \"\" XXX\n SG_ TSGNGRY1 : 12|3@0+ (1,0) [0|0] \"\" XXX\n SG_ TSGNHLT1 : 9|2@0+ (1,0) [0|0] \"\" XXX\n SG_ SPDVAL1 : 23|8@0+ (1,0) [0|0] \"kph\" XXX\n SG_ SPLSGN1 : 31|4@0+ (1,0) [0|0] \"\" XXX\n SG_ SPLSGN2 : 27|4@0+ (1,0) [0|0] \"\" XXX\n SG_ TSGN2 : 39|8@0+ (1,0) [0|0] \"\" XXX\n SG_ TSGNGRY2 : 44|3@0+ (1,0) [0|0] \"\" XXX\n SG_ TSGNHLT2 : 41|2@0+ (1,0) [0|0] \"\" XXX\n SG_ SPDVAL2 : 55|8@0+ (1,0) [0|0] \"\" XXX\n SG_ BZRRQ_P : 63|2@0+ (1,0) [0|0] \"\" XXX\n SG_ BZRRQ_A : 61|2@0+ (1,0) [0|0] \"\" XXX\n SG_ SYNCID1 : 59|4@0+ (1,0) [0|0] \"\" XXX\n\nBO_ 1162 RSA2: 8 FCM\n SG_ TSGN3 : 7|8@0+ (1,0) [0|0] \"\" XXX\n SG_ TSGNGRY3 : 12|3@0+ (1,0) [0|0] \"\" XXX\n SG_ TSGNHLT3 : 9|2@0+ (1,0) [0|0] \"\" XXX\n SG_ SPLSGN3 : 31|4@0+ (1,0) [0|0] \"\" XXX\n SG_ SPLSGN4 : 27|4@0+ (1,0) [0|0] \"\" XXX\n SG_ TSGN4 : 39|8@0+ (1,0) [0|0] \"\" XXX\n SG_ TSGNGRY4 : 44|3@0+ (1,0) [0|0] \"\" XXX\n SG_ TSGNHLT4 : 41|2@0+ (1,0) [0|0] \"\" XXX\n SG_ DPSGNREQ : 54|1@0+ (1,0) [0|0] \"\" XXX\n SG_ SGNNUMP : 53|3@0+ (1,0) [0|0] \"\" XXX\n SG_ SGNNUMA : 50|3@0+ (1,0) [0|0] \"\" XXX\n SG_ SPDUNT : 63|2@0+ (1,0) [0|0] \"\" XXX\n SG_ TSRWMSG : 61|2@0+ (1,0) [0|0] \"\" XXX\n SG_ SYNCID2 : 59|4@0+ (1,0) [0|0] \"\" XXX\n\nBO_ 1163 RSA3: 8 FCM\n SG_ TSREQPD : 7|1@0+ (1,0) [0|0] \"\" XXX\n SG_ TSRMSW : 6|1@0+ (1,0) [0|0] \"\" XXX\n SG_ OTSGNNTM : 5|2@0+ (1,0) [0|0] \"\" XXX\n SG_ NTLVLSPD : 3|2@0+ (1,0) [0|0] \"\" XXX\n SG_ OVSPNTM : 1|2@0+ (1,0) [0|0] \"\" XXX\n SG_ OVSPVALL : 11|4@0+ (1,-5) [0|0] \"\" XXX\n SG_ OVSPVALM : 19|4@0+ (1,-5) [0|0] \"\" XXX\n SG_ OVSPVALH : 27|4@0+ (1,-5) [0|0] \"\" XXX\n SG_ TSRSPU : 33|2@0+ (1,0) [0|0] \"\" XXX\n\nCM_ SG_ 36 ACCEL_Y \"unit is tbd\";\nCM_ SG_ 36 YAW_RATE \"verify\";\nCM_ SG_ 36 STEERING_TORQUE \"does not seem the steer torque, tbd\";\nCM_ SG_ 37 STEER_FRACTION \"1/15th of the signal STEER_ANGLE, which is 1.5 deg; note that 0x8 is never set\";\nCM_ SG_ 37 STEER_RATE \"factor is tbd\";\nCM_ SG_ 466 ACCEL_NET \"net acceleration produced by the system, given ACCEL_CMD, road grade and other factors\";\nCM_ SG_ 467 SET_SPEED \"43 kph are shown as 28mph, so conversion isnt perfect\";\nCM_ SG_ 467 LOW_SPEED_LOCKOUT \"in low speed lockout, system would always disengage below 28mph\";\nCM_ SG_ 560 BRAKE_PRESSED \"another brake pressed?\";\nCM_ SG_ 608 STEER_TORQUE_DRIVER \"driver torque\";\nCM_ SG_ 608 STEER_OVERRIDE \"set when driver torque exceeds a certain value\";\nCM_ SG_ 614 ANGLE \"set to measured angle when ipas control isn't active\";\nCM_ SG_ 643 COUNTER \"only used on cars that use this msg for cruise control\";\nCM_ SG_ 643 BRAKE_STATUS \"only used on cars that use this msg for cruise control\";\nCM_ SG_ 643 PRECOLLISION_ACTIVE \"set 0.5s before any braking\";\nCM_ SG_ 921 UI_SET_SPEED \"set speed shown in UI with user set unit\";\nCM_ SG_ 951 BRAKE_LIGHTS_ACC \"brake lights when ACC commands decel\";\nCM_ SG_ 1042 SET_ME_1 \"unclear what this is, but it's always 1 in drive traces\";\nCM_ SG_ 1042 REPEATED_BEEPS \"recommended for fcw and other important alerts\";\nCM_ SG_ 1161 SPDVAL1 \"Numbers 0-199 is displayed, 200-254 displays circle without number and 255 is for no limit.\";\nCM_ SG_ 1161 SYNCID1 \"counter from 1 to f at 1 Hz\";\nCM_ SG_ 1161 SPDVAL2 \"conditional speed value 70\"\nCM_ SG_ 1162 SGNNUMP \"1 if SPDVAL1 is set, otherwise 0\";\nCM_ SG_ 1162 SYNCID2 \"counter from 1 to f at 1 Hz\";\nCM_ SG_ 1163 TSREQPD \"always 1\";\nCM_ SG_ 1163 TSRMSW \"always 1\";\nCM_ SG_ 1163 OTSGNNTM \"always 3\";\nCM_ SG_ 1163 NTLVLSPD \"always 3\";\nCM_ SG_ 1163 OVSPNTM \"always 3\";\nCM_ SG_ 1163 OVSPVALL \"-5 at start then 2 after 2 seconds\";\nCM_ SG_ 1163 OVSPVALM \"-5 at start then 5 after 2 seconds\";\nCM_ SG_ 1163 OVSPVALH \"-5 at start then 10 after 2 seconds\";\nCM_ SG_ 1163 TSRSPU \"always 1\";\n\nVAL_ 466 CRUISE_STATE 8 \"active\" 7 \"standstill\" 1 \"off\";\nVAL_ 467 LOW_SPEED_LOCKOUT 2 \"low speed locked\" 1 \"ok\";\nVAL_ 614 STATE 3 \"enabled\" 1 \"disabled\";\nVAL_ 614 DIRECTION_CMD 3 \"right\" 2 \"center\" 1 \"left\";\nVAL_ 643 STATE 0 \"normal\" 1 \"adaptive_cruise_control\" 3 \"emergency_braking\";\nVAL_ 921 CRUISE_CONTROL_STATE 2 \"disabled\" 11 \"hold\" 10 \"hold_waiting_user_cmd\" 6 \"enabled\" 5 \"faulted\";\nVAL_ 1042 LDA_ALERT 3 \"hold with continuous beep\" 2 \"LDA unavailable\" 1 \"hold\" 0 \"none\";\nVAL_ 1042 BARRIERS 3 \"both\" 2 \"right\" 1 \"left\" 0 \"none\";\nVAL_ 1042 RIGHT_LINE 3 \"orange\" 2 \"faded\" 1 \"solid\" 0 \"none\";\nVAL_ 1042 LEFT_LINE 3 \"orange\" 2 \"faded\" 1 \"solid\" 0 \"none\";\nVAL_ 1553 UNITS 1 \"km\" 2 \"miles\";\nVAL_ 1556 TURN_SIGNALS 3 \"none\" 2 \"right\" 1 \"left\";\nVAL_ 1161 TSGN1 1 \"speed sign\" 0 \"none\";\nVAL_ 1161 TSGN2 1 \"speed sign\" 0 \"none\";\nVAL_ 1161 SPLSGN2 15 \"conditional blank\" 4 \"wet road\" 5 \"rain\" 0 \"none\";\nVAL_ 1162 TSGN3 0 \"none\" 1 \"speed sign\" 2 \"0 unlimited\" 7 \"unlimited\" 16 \"highway\" 17 \"no highway\" 18 \"motorway\" 19 \"no motorway\" 20 \"in city\" 21 \"outside city\" 22 \"pedestrian area\" 23 \"no pedestrian area\" 65 \"no overtaking left\" 66 \"no overtaking right\" 67 \"overtaking allowed again\" 129 \"no entry\";\nVAL_ 1162 SPLSGN3 15 \"conditional blank\" 4 \"wet road\" 5 \"rain\" 0 \"none\";\n\n\nCM_ \"CHFFR_METRIC 37 STEER_ANGLE STEER_ANGLE 0.36 180\";\n\nCM_ \"toyota_nodsu_pt.dbc starts here\"\n\n\n\nBO_ 401 STEERING_LTA: 8 XXX\n SG_ COUNTER : 7|8@0+ (1,0) [0|255] \"\" XXX\n SG_ CHECKSUM : 63|8@0+ (1,0) [0|255] \"\" XXX\n SG_ SETME_X3 : 29|2@0+ (1,0) [0|3] \"\" XXX\n SG_ PERCENTAGE : 39|8@0+ (1,0) [0|255] \"\" XXX\n SG_ SETME_X64 : 47|8@0+ (1,0) [0|255] \"\" XXX\n SG_ ANGLE : 55|8@0- (0.5,0) [0|255] \"\" XXX\n SG_ STEER_ANGLE_CMD : 15|16@0- (0.0573,0) [-540|540] \"\" XXX\n SG_ STEER_REQUEST : 25|1@0+ (1,0) [0|1] \"\" XXX\n SG_ BIT : 30|1@0+ (1,0) [0|1] \"\" XXX\n\nBO_ 550 BRAKE_MODULE: 8 XXX\n SG_ BRAKE_PRESSURE : 0|9@0+ (1,0) [0|511] \"\" XXX\n SG_ BRAKE_POSITION : 16|9@0+ (1,0) [0|511] \"\" XXX\n SG_ BRAKE_PRESSED : 37|1@0+ (1,0) [0|1] \"\" XXX\n\nBO_ 705 GAS_PEDAL: 8 XXX\n SG_ GAS_RELEASED : 3|1@0+ (1,0) [0|1] \"\" XXX\n SG_ GAS_PEDAL : 55|8@0+ (0.005,0) [0|1] \"\" XXX\n\nBO_ 608 STEER_TORQUE_SENSOR: 8 XXX\n SG_ STEER_TORQUE_EPS : 47|16@0- (0.73,0) [-20000|20000] \"\" XXX\n SG_ STEER_TORQUE_DRIVER : 15|16@0- (1,0) [-32768|32767] \"\" XXX\n SG_ STEER_OVERRIDE : 0|1@0+ (1,0) [0|1] \"\" XXX\n SG_ CHECKSUM : 63|8@0+ (1,0) [0|255] \"\" XXX\n SG_ STEER_ANGLE : 31|16@0- (0.0573,0) [-500|500] \"\" XXX\n\nBO_ 610 EPS_STATUS: 8 EPS\n SG_ IPAS_STATE : 3|4@0+ (1,0) [0|15] \"\" XXX\n SG_ LKA_STATE : 31|7@0+ (1,0) [0|127] \"\" XXX\n SG_ TYPE : 24|1@0+ (1,0) [0|1] \"\" XXX\n SG_ CHECKSUM : 63|8@0+ (1,0) [0|255] \"\" XXX\n\nBO_ 956 GEAR_PACKET: 8 XXX\n SG_ SPORT_ON : 2|1@0+ (1,0) [0|1] \"\" XXX\n SG_ GEAR : 13|6@0+ (1,0) [0|63] \"\" XXX\n SG_ ECON_ON : 40|1@0+ (1,0) [0|1] \"\" XXX\n\nCM_ SG_ 548 BRAKE_PRESSURE \"seems prop to pedal force\";\nCM_ SG_ 548 BRAKE_POSITION \"seems proportional to pedal displacement, unclear the max value of 0x1c8\";\nCM_ SG_ 610 TYPE \"seems 1 on Corolla, 0 on all others\";\nVAL_ 610 IPAS_STATE 5 \"override\" 3 \"enabled\" 1 \"disabled\";\nVAL_ 610 LKA_STATE 25 \"temporary_fault\" 9 \"temporary_fault2\" 5 \"active\" 1 \"standby\";\nVAL_ 956 GEAR 0 \"D\" 1 \"S\" 8 \"N\" 16 \"R\" 32 \"P\";\nVAL_ 956 SPORT_ON 0 \"off\" 1 \"on\";\nVAL_ 956 ECON_ON 0 \"off\" 1 \"on\";\n`);\n\nexport default CorollaDBC;\n","import qs from 'query-string';\nimport CommaAuth, { config as AuthConfig, storage as AuthStorage } from '@commaai/my-comma-auth';\nimport { auth as AuthApi, request as Request } from '@commaai/comma-api';\nimport Sentry from './logging/Sentry';\nimport { getUrlParameter, modifyQueryParameters } from './utils/url';\nimport { GITHUB_AUTH_TOKEN_KEY } from './config';\nimport {\n  fetchPersistedDbc,\n  fetchPersistedGithubAuthToken,\n  persistGithubAuthToken\n} from './api/localstorage';\nimport { demoProps } from './demo';\n\nasync function authenticate() {\n  if (window.location && window.location.pathname === AuthConfig.AUTH_PATH) {\n    try {\n      const { code, provider } = qs.parse(window.location.search);\n      const token = await AuthApi.refreshAccessToken(code, provider);\n      if (token) {\n        AuthStorage.setCommaAccessToken(token);\n\n        // reset stored path\n        if (window.sessionStorage) {\n          const onboardingPath = window.sessionStorage.getItem('onboardingPath');\n          if (onboardingPath) {\n            window.sessionStorage.removeItem('onboardingPath');\n            window.location = onboardingPath;\n          }\n        }\n      }\n    } catch (err) {\n      console.log(err);\n    }\n  }\n\n  const token = await CommaAuth.init();\n  if (token) {\n    Request.configure(token);\n  }\n}\n\nexport default function init() {\n  Sentry.init();\n\n  const routeFullName = getUrlParameter('route');\n  const isDemo = !!getUrlParameter('demo');\n  let segments = getUrlParameter('segments');\n  if (segments && segments.length) {\n    segments = segments.split(',').map(Number);\n\n    if (segments.length !== 2) {\n      segments = undefined;\n    }\n  }\n\n  let props = {\n    autoplay: true,\n    startTime: Number(getUrlParameter('seekTime') || 0),\n    segments,\n    isDemo\n  };\n  let persistedDbc = null;\n\n  if (routeFullName) {\n    const [dongleId, route] = routeFullName.split('|');\n    props.dongleId = dongleId;\n    props.name = route;\n\n    persistedDbc = fetchPersistedDbc(routeFullName);\n\n    const max = getUrlParameter('max');\n    const url = getUrlParameter('url');\n    const exp = getUrlParameter('exp');\n    const sig = getUrlParameter('sig');\n\n    if (max) {\n      props.max = parseInt(max);\n    }\n    if (url) {\n      props.url = url;\n    }\n    if (exp) {\n      props.exp = exp;\n    }\n    if (sig) {\n      props.sig = sig;\n    }\n    props.isLegacyShare = max && url && !exp && !sig;\n    props.isShare = max && url && exp && sig;\n  } else if (isDemo) {\n    props = { ...props, ...demoProps };\n  }\n\n  if (persistedDbc) {\n    const { dbcFilename, dbc } = persistedDbc;\n    props.dbc = dbc;\n    props.dbcFilename = dbcFilename;\n  }\n\n  const authTokenQueryParam = getUrlParameter(GITHUB_AUTH_TOKEN_KEY);\n  if (authTokenQueryParam !== null) {\n    props.githubAuthToken = authTokenQueryParam;\n    persistGithubAuthToken(authTokenQueryParam);\n    const urlNoAuthToken = modifyQueryParameters({\n      remove: [GITHUB_AUTH_TOKEN_KEY]\n    });\n    window.location.href = urlNoAuthToken;\n  } else {\n    props.githubAuthToken = fetchPersistedGithubAuthToken();\n  }\n\n  return new Promise((resolve) => {\n    authenticate().then(() => {\n      resolve(props);\n    });\n  });\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport CanExplorer from './CanExplorer';\nimport init from './init';\nimport './index.css';\n\ninit().then((props) => {\n  ReactDOM.render(<CanExplorer {...props} />, document.getElementById('root')); // eslint-disable-line react/jsx-props-no-spreading\n});\n","import randomcolor from 'randomcolor';\nimport DbcUtils from '../../utils/dbc';\n\nexport default class Signal {\n  constructor({\n    name,\n    startBit = 0,\n    size = 0,\n    isLittleEndian = true,\n    isSigned = false,\n    isFloat = false,\n    factor = 1,\n    offset = 0,\n    unit = '',\n    receiver = ['XXX'],\n    comment = null,\n    multiplex = null,\n    min = null,\n    max = null,\n    valueDescriptions = new Map()\n  }) {\n    Object.assign(this, {\n      name,\n      startBit,\n      size,\n      isLittleEndian,\n      isSigned,\n      isFloat,\n      factor,\n      offset,\n      unit,\n      receiver,\n      comment,\n      multiplex,\n      valueDescriptions\n    });\n\n    const uid = Math.random().toString(36);\n\n    if (min == null) {\n      min = this.calculateMin();\n    }\n    if (max == null) {\n      max = this.calculateMax();\n    }\n\n    const colors = this.generateColors();\n\n    Object.assign(this, {\n      min,\n      max,\n      uid,\n      _colors: colors\n    });\n\n    Object.defineProperty(this, 'colors', {\n      get() {\n        console.error('Something is still using the old colors');\n        debugger;\n        return colors;\n      },\n      enumberable: false\n    });\n  }\n\n  text() {\n    const multiplex = this.multiplex ? ` ${this.multiplex}` : '';\n    const byteOrder = this.isLittleEndian ? 1 : 0;\n    const signedChar = this.isSigned ? '-' : '+';\n\n    return (\n      `SG_ ${this.name}${multiplex} : `\n      + `${this.startBit}|${this.size}@${byteOrder}${signedChar}`\n      + ` (${this.factor},${this.offset})`\n      + ` [${this.min}|${this.max}]`\n      + ` \"${this.unit}\" ${this.receiver}`\n    );\n  }\n\n  valueDescriptionText(msgId) {\n    const entryPairs = Array.from(this.valueDescriptions.entries());\n    const values = entryPairs.reduce(\n      (str, [value, desc]) => `${str + value} \"${desc}\" `,\n      ''\n    );\n    return `VAL_ ${msgId} ${this.name} ${values};`;\n  }\n\n  lsbBitIndex() {\n    // Returns LSB bit index in matrix order (see AddSignals.js)\n\n    if (this.isLittleEndian) {\n      return this.startBit;\n    }\n    const lsbBitNumber = this.lsbBitNumber();\n\n    return DbcUtils.matrixBitNumber(lsbBitNumber);\n  }\n\n  lsbBitNumber() {\n    // Returns LSB bit number in big endian ordering\n\n    return DbcUtils.bigEndianBitIndex(this.startBit) + this.size - 1;\n  }\n\n  msbBitIndex() {\n    if (this.isLittleEndian) {\n      return this.startBit + this.size - 1;\n    }\n    return this.startBit;\n  }\n\n  littleEndianBitDescription(bitIndex) {\n    const bitRange = [this.startBit, this.startBit + this.size - 1];\n    if (bitIndex < bitRange[0] || bitIndex > bitRange[1]) {\n      return null;\n    }\n    const bitNumber = bitIndex - bitRange[0];\n    const isLsb = bitIndex === bitRange[0];\n    const isMsb = bitIndex === bitRange[1];\n    return { bitNumber, isLsb, isMsb };\n  }\n\n  bigEndianBitDescription(bitIndex) {\n    const start = DbcUtils.bigEndianBitIndex(this.startBit);\n    const range = [start, start + this.size - 1];\n    const bitNumber = DbcUtils.bigEndianBitIndex(bitIndex);\n\n    if (bitNumber < range[0] || bitNumber > range[1]) {\n      return null;\n    }\n\n    const isLsb = bitNumber === range[1];\n    const isMsb = bitIndex === this.startBit;\n    return {\n      bitNumber,\n      isLsb,\n      isMsb,\n      range\n    };\n  }\n\n  bitDescription(bitIndex) {\n    if (this.isLittleEndian) {\n      return this.littleEndianBitDescription(bitIndex);\n    }\n    return this.bigEndianBitDescription(bitIndex);\n  }\n\n  calculateRawRange() {\n    let rawRange = Math.pow(2, this.size);\n    if (this.isSigned) {\n      rawRange /= 2;\n    }\n    return [this.isSigned ? -1 * rawRange : 0, rawRange - 1];\n  }\n\n  calculateMin() {\n    const rawMin = this.calculateRawRange()[0];\n    return this.offset + rawMin * this.factor;\n  }\n\n  calculateMax() {\n    const rawMax = this.calculateRawRange()[1];\n    return this.offset + rawMax * this.factor;\n  }\n\n  getColors(messageId) {\n    let parts = messageId.split(':').map((p) => ((3 + Number.parseInt(p, 16)) * 3) % 253);\n    const colors = this._colors || this.generateColors();\n\n    let lastColor = 0;\n\n    return colors.map((c) => {\n      parts = parts.map(p => p ^ lastColor);\n      lastColor = parts.reduce((m, v) => m ^ v, c);\n      return lastColor;\n    });\n  }\n\n  generateColors() {\n    const colors = randomcolor({ format: 'rgbArray' });\n\n    return colors;\n  }\n\n  equals(otherSignal) {\n    return (\n      otherSignal.name === this.name\n      && otherSignal.startBit === this.startBit\n      && otherSignal.size === this.size\n      && otherSignal.isLittleEndian === this.isLittleEndian\n      && otherSignal.isSigned === this.isSigned\n      && otherSignal.isFloat === this.isFloat\n      && otherSignal.factor === this.factor\n      && otherSignal.offset === this.offset\n      && otherSignal.unit === this.unit\n      && otherSignal.receiver.length === this.receiver.length\n      && otherSignal.receiver.every((v, i) => v === this.receiver[i])\n      && otherSignal.comment === this.comment\n      && otherSignal.multiplex === this.multiplex\n    );\n  }\n}\n","// Vendored from https://github.com/rapid7/le_js, which is broken with webpack.\n/* eslint-disable */\n\nif (typeof window === \"undefined\") {\n  // eslint-disable-line no-use-before-define\n  var window = self;\n}\nvar _indexOf = function(array, obj) {\n  for (var i = 0; i < array.length; i++) {\n    if (obj === array[i]) {\n      return i;\n    }\n  }\n  return -1;\n};\n\n// Obtain a browser-specific XHR object\nvar _getAjaxObject = function() {\n  if (typeof XDomainRequest !== \"undefined\") {\n    // We're using IE8/9\n    return new XDomainRequest();\n  }\n  return new XMLHttpRequest();\n};\n\n/**\n * A single log event stream.\n * @constructor\n * @param {Object} options\n */\nfunction LogStream(options) {\n  /**\n   * @const\n   * @type {string} */\n  var _traceCode = options.trace\n    ? (Math.random() + Math.PI).toString(36).substring(2, 10)\n    : null;\n  /** @type {string} */\n  var _pageInfo = options.page_info;\n  /** @type {string} */\n  var _token = options.token;\n  /** @type {boolean} */\n  var _print = options.print;\n  /** @type {boolean} */\n  var _noFormat = options.no_format;\n  /** @type {boolean} */\n  var _SSL = (function() {\n    if (typeof XDomainRequest === \"undefined\") {\n      return options.ssl;\n    }\n    // If we're relying on XDomainRequest, we\n    // must adhere to the page's encryption scheme.\n    return window.location.protocol === \"https:\" ? true : false;\n  })();\n  /** @type {string} */\n  var _endpoint;\n  if (window.LEENDPOINT) {\n    _endpoint = window.LEENDPOINT;\n  } else if (_noFormat) {\n    _endpoint = \"webhook.logentries.com/noformat\";\n  } else {\n    _endpoint = \"js.logentries.com/v1\";\n  }\n  _endpoint = (_SSL ? \"https://\" : \"http://\") + _endpoint + \"/logs/\" + _token;\n\n  /**\n   * Flag to prevent further invocations on network err\n   ** @type {boolean} */\n  var _shouldCall = true;\n  /** @type {Array.<string>} */\n  var _backlog = [];\n  /** @type {boolean} */\n  var _active = false;\n  /** @type {boolean} */\n  var _sentPageInfo = false;\n\n  var _apiCall = function(token, data) {\n    _active = true;\n\n    var request = _getAjaxObject();\n\n    if (_shouldCall) {\n      if (request.constructor === XMLHttpRequest) {\n        // Currently we don't support fine-grained error\n        // handling in older versions of IE\n        request.onreadystatechange = function() {\n          if (request.readyState === 4) {\n            // Handle any errors\n            if (request.status >= 400) {\n              console.error(\"Couldn't submit events.\");\n              if (request.status === 410) {\n                // This API version has been phased out\n                console.warn(\"This version of le_js is no longer supported!\");\n              }\n            } else {\n              if (request.status === 301) {\n                // Server issued a deprecation warning\n                console.warn(\n                  \"This version of le_js is deprecated! Consider upgrading.\"\n                );\n              }\n              if (_backlog.length > 0) {\n                // Submit the next event in the backlog\n                _apiCall(token, _backlog.shift());\n              } else {\n                _active = false;\n              }\n            }\n          }\n        };\n      } else {\n        request.onload = function() {\n          if (_backlog.length > 0) {\n            // Submit the next event in the backlog\n            _apiCall(token, _backlog.shift());\n          } else {\n            _active = false;\n          }\n        };\n      }\n\n      request.open(\"POST\", _endpoint, true);\n      if (request.constructor === XMLHttpRequest) {\n        request.setRequestHeader(\"X-Requested-With\", \"XMLHttpRequest\");\n        request.setRequestHeader(\"Content-type\", \"application/json\");\n      }\n\n      if (request.overrideMimeType) {\n        request.overrideMimeType(\"text\");\n      }\n\n      request.send(data);\n    }\n  };\n\n  var _getEvent = function() {\n    var raw = null;\n    var args = Array.prototype.slice.call(arguments);\n    if (args.length === 0) {\n      throw new Error(\"No arguments!\");\n    } else if (args.length === 1) {\n      raw = args[0];\n    } else {\n      // Handle a variadic overload,\n      // e.g. _rawLog(\"some text \", x, \" ...\", 1);\n      raw = args;\n    }\n    return raw;\n  };\n\n  var _agentInfo = function() {\n    var nav = window.navigator || { doNotTrack: undefined };\n    var screen = window.screen || {};\n    var location = window.location || {};\n\n    return {\n      url: location.pathname,\n      referrer: document.referrer,\n      screen: {\n        width: screen.width,\n        height: screen.height\n      },\n      window: {\n        width: window.innerWidth,\n        height: window.innerHeight\n      },\n      browser: {\n        name: nav.appName,\n        version: nav.appVersion,\n        cookie_enabled: nav.cookieEnabled,\n        do_not_track: nav.doNotTrack\n      },\n      platform: nav.platform\n    };\n  };\n\n  // Single arg stops the compiler arity warning\n  var _rawLog = function(msg) {\n    var event = _getEvent.apply(this, arguments);\n\n    var data = { event: event };\n\n    // Add agent info if required\n    if (_pageInfo !== \"never\") {\n      if (!_sentPageInfo || _pageInfo === \"per-entry\") {\n        _sentPageInfo = true;\n        if (\n          typeof event.screen === \"undefined\" &&\n          typeof event.browser === \"undefined\"\n        )\n          _rawLog(_agentInfo())\n            .level(\"PAGE\")\n            .send();\n      }\n    }\n\n    if (_traceCode) {\n      data.trace = _traceCode;\n    }\n\n    return {\n      level: function(l) {\n        // Don't log PAGE events to console\n        // PAGE events are generated for the agentInfo function\n        if (_print && typeof console !== \"undefined\" && l !== \"PAGE\") {\n          var serialized = null;\n          if (typeof XDomainRequest !== \"undefined\") {\n            // We're using IE8/9\n            serialized = data.trace + \" \" + data.event;\n          }\n          try {\n            console[l.toLowerCase()].call(console, serialized || data);\n          } catch (ex) {\n            // IE compat fix\n            console.log(serialized || data);\n          }\n        }\n        data.level = l;\n\n        return {\n          send: function() {\n            var cache = [];\n            var serialized = JSON.stringify(data, function(key, value) {\n              if (typeof value === \"undefined\") {\n                return \"undefined\";\n              } else if (typeof value === \"object\" && value !== null) {\n                if (_indexOf(cache, value) !== -1) {\n                  // We've seen this object before;\n                  // return a placeholder instead to prevent\n                  // cycles\n                  return \"<?>\";\n                }\n                cache.push(value);\n              }\n              return value;\n            });\n\n            if (_active) {\n              _backlog.push(serialized);\n            } else {\n              _apiCall(_token, serialized);\n            }\n          }\n        };\n      }\n    };\n  };\n\n  if (options.catchall) {\n    var oldHandler = window.onerror;\n    var newHandler = function(msg, url, line) {\n      _rawLog({ error: msg, line: line, location: url })\n        .level(\"ERROR\")\n        .send();\n      if (oldHandler) {\n        return oldHandler(msg, url, line);\n      } else {\n        return false;\n      }\n    };\n    window.onerror = newHandler;\n  }\n\n  /** @expose */\n  this.log = _rawLog;\n}\n\n/**\n * A single log object\n * @constructor\n * @param {Object} options\n */\nfunction Logger(options) {\n  var logger;\n\n  // Default values\n  var dict = {\n    ssl: true,\n    catchall: false,\n    trace: true,\n    page_info: \"never\",\n    print: false,\n    endpoint: null,\n    token: null\n  };\n\n  if (typeof options === \"object\") for (var k in options) dict[k] = options[k];\n  else throw new Error(\"Invalid parameters for createLogStream()\");\n\n  if (dict.token === null) {\n    throw new Error(\"Token not present.\");\n  } else {\n    logger = new LogStream(dict);\n  }\n\n  var _log = function(msg) {\n    if (logger) {\n      return logger.log.apply(this, arguments);\n    } else throw new Error(\"You must call LE.init(...) first.\");\n  };\n\n  // The public interface\n  return {\n    log: function() {\n      _log\n        .apply(this, arguments)\n        .level(\"LOG\")\n        .send();\n    },\n    warn: function() {\n      _log\n        .apply(this, arguments)\n        .level(\"WARN\")\n        .send();\n    },\n    error: function() {\n      _log\n        .apply(this, arguments)\n        .level(\"ERROR\")\n        .send();\n    },\n    info: function() {\n      _log\n        .apply(this, arguments)\n        .level(\"INFO\")\n        .send();\n    }\n  };\n}\n\n// Array of Logger elements\nvar loggers = {};\n\nvar _getLogger = function(name) {\n  if (!loggers.hasOwnProperty(name))\n    throw new Error(\"Invalid name for logStream\");\n\n  return loggers[name];\n};\n\nvar _createLogStream = function(options) {\n  if (typeof options.name !== \"string\") throw new Error(\"Name not present.\");\n  else if (loggers.hasOwnProperty(options.name))\n    throw new Error(\"A logger with that name already exists!\");\n  loggers[options.name] = new Logger(options);\n\n  return true;\n};\n\nvar _deprecatedInit = function(options) {\n  var dict = {\n    name: \"default\"\n  };\n\n  if (typeof options === \"object\") for (var k in options) dict[k] = options[k];\n  else if (typeof options === \"string\") dict.token = options;\n  else throw new Error(\"Invalid parameters for init()\");\n\n  return _createLogStream(dict);\n};\n\nvar _destroyLogStream = function(name) {\n  if (typeof name === \"undefined\") {\n    name = \"default\";\n  }\n\n  delete loggers[name];\n};\n\n// The public interface\nexport default {\n  init: _deprecatedInit,\n  createLogStream: _createLogStream,\n  to: _getLogger,\n  destroy: _destroyLogStream,\n  log: function() {\n    for (var k in loggers) loggers[k].log.apply(this, arguments);\n  },\n  warn: function() {\n    for (var k in loggers) loggers[k].warn.apply(this, arguments);\n  },\n  error: function() {\n    for (var k in loggers) loggers[k].error.apply(this, arguments);\n  },\n  info: function() {\n    for (var k in loggers) loggers[k].info.apply(this, arguments);\n  }\n};\n","// Wrapper of aphrodite css() function\n// that supports string class names in\n// addition to style objects.\n\n// Useful for component testing\n\nimport { css } from 'aphrodite';\nimport classNames from 'classnames';\n\nexport default function () {\n  const styles = [];\n  const classes = [];\n\n  [].forEach.call(arguments, (it) => {\n    if (it && it._definition && it._name) styles.push(it);\n    else classes.push(it);\n  });\n\n  return classNames.apply(null, [...classes, css(styles)]);\n}\n"],"sourceRoot":""}