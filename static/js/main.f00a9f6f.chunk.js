(this["webpackJsonpcan-explorer"]=this["webpackJsonpcan-explorer"]||[]).push([[0],{14:function(e,t,n){"use strict";(function(e){var a=n(2),s=n(16),i=n(373);function createMessageSpec(e,t,n,a){var s=e.getMessageFrame(t),i=s?s.size:8;return{address:t,id:n,bus:a,entries:[],frame:s,byteColors:Array(i).fill(0),byteStateChangeCounts:Array(i).fill(0)}}function determineByteStateChangeTimes(e,t,n,a){var s,i=Array(n).fill(0);if(a){s=a.byteStateChangeTimes;for(var r=0;r<s.length;r++){e.substr(2*r,2)!==a.hexData.substr(2*r,2)&&(s[r]=t,i[r]=1)}}else s=Array(n).fill(t);return{byteStateChangeTimes:s,byteStateChangeCounts:i}}function createMessageEntry(t,n,a,s,i,r){return{signals:t.getSignalValues(n,i),address:n,data:i,time:a,relTime:s,hexData:e.from(i).toString("hex"),byteStateChangeTimes:r,updated:Date.now()}}function parseMessage(t,n,a,s,i,r){var o;"string"===typeof s?(o=s,s=e.from(s,"hex")):o=e.from(s).toString("hex");var l=t.getMessageFrame(a),c=n-i,d=determineByteStateChangeTimes(o,c,l?l.size:Math.max(8,s.length),r),u=d.byteStateChangeTimes,g=d.byteStateChangeCounts;return{msgEntry:createMessageEntry(t,a,n,c,s,u),byteStateChangeCounts:g}}for(var r=[],o=0;o<512;o+=8)for(var l=7;l>-1;l--)r.push(o+l);t.a={bigEndianBitIndex:function bigEndianBitIndex(e){return r.indexOf(e)},addCanMessage:function addCanMessage(e,t,n,a,s,i){var r=e.address,o=e.busTime,l=e.data,c=e.bus,d="".concat(c,":").concat(r.toString(16));void 0===a[d]&&(a[d]=createMessageSpec(t,r,d,c));var u=a[d].entries.length>0?a[d].entries[a[d].entries.length-1]:s[d]||null;i[d]&&a[d].byteStateChangeCounts.every((function(e){return 0===e}))&&(a[d].byteStateChangeCounts=i[d]);var g=parseMessage(t,o,r,l,n,u),h=g.msgEntry,m=g.byteStateChangeCounts;return a[d].byteStateChangeCounts=m.map((function(e,t){return a[d].byteStateChangeCounts[t]+e})),a[d].entries.push(h),h},createMessageSpec:createMessageSpec,matrixBitNumber:function matrixBitNumber(e){return r[e]},parseMessage:parseMessage,reparseMessage:function reparseMessage(e,t,n){var a=e.getMessageFrame(t.address),i=a?a.size:8,r=determineByteStateChangeTimes(t.hexData,t.relTime,i,n),o=r.byteStateChangeTimes,l=r.byteStateChangeCounts;return{msgEntry:Object(s.a)(Object(s.a)({},t),{},{signals:e.getSignalValues(t.address,t.data),byteStateChangeTimes:o,updated:Date.now()}),byteStateChangeCounts:l}},findMaxByteStateChangeCount:function findMaxByteStateChangeCount(e){return Object.values(e).map((function(e){return e.byteStateChangeCounts})).reduce((function(e,t){return e.concat(t)}),[]).reduce((function(e,t){return e>t?e:t}),0)},setMessageByteColors:function setMessageByteColors(e,t){return e.byteColors=e.byteStateChangeCounts.map((function(e){return isNaN(e)?0:Math.min(255,75+e/t*180)})).map((function(e){return"rgb(".concat(Math.round(e),",0,0)")})),e},createMessageEntry:createMessageEntry,maxMessageSize:function maxMessageSize(t){var n,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,i=s,r=Object(a.a)(t.entries);try{for(r.s();!(n=r.n()).done;){var o=n.value,l=e.from(o.hexData,"hex");l.length>i&&(i=l.length)}}catch(c){r.e(c)}finally{r.f()}return i},findDbcForCar:function findDbcForCar(e){return e in i?i[e]:null}}}).call(this,n(36).Buffer)},148:function(e,t,n){"use strict";n.d(t,"a",(function(){return shade}));var a=n(10);function shade(e,t){var n=Object(a.a)(e,3),s=n[0],i=n[1],r=n[2],o=t<0?0:255,l=Math.abs(t);return[Math.round((o-s)*l)+s,Math.round((o-i)*l)+i,Math.round((o-r)*l)+r]}},19:function(e,t,n){"use strict";n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"i",(function(){return o})),n.d(t,"k",(function(){return l})),n.d(t,"j",(function(){return c})),n.d(t,"f",(function(){return d})),n.d(t,"g",(function(){return u})),n.d(t,"a",(function(){return g})),n.d(t,"h",(function(){return h})),n.d(t,"b",(function(){return m}));var a=n(23);const s="4b43250e7499a97d62a5",i="https://api.comma.ai/cabana/ghcallback",r="gh_access_token",o="boggyver/tesladbc",l="undefined"!==typeof window&&null!==Object(a.a)("unlogger"),c="http://localhost:8080/unlogger",d="4bc98019-8277-4fe0-867c-ed21ea843cc5",u=3,g=5e3,h=60,m="https://connect.comma.ai/"},23:function(e,t,n){"use strict";n.d(t,"c",(function(){return objToQuery})),n.d(t,"a",(function(){return getUrlParameter})),n.d(t,"b",(function(){return modifyQueryParameters}));var a=n(16);function objToQuery(e){return Object.keys(e).map((function(t){return"".concat(t,"=").concat(encodeURIComponent(decodeURIComponent(e[t])))})).join("&")}function getUrlParameter(e){var t=window.location;e=e.replace(/[[]/,"\\[").replace(/[\]]/,"\\]");var n=new RegExp("[\\?&]".concat(e,"=([^&#]*)")).exec(t.search);return null===n?null:decodeURIComponent(n[1].replace(/\+/g," "))}function modifyQueryParameters(e){var t=e.add,n=e.remove,s=void 0===n?[]:n,i=new RegExp("[\\?&]([^&#]+)=([^&#]*)").exec(location.search),r={};if(null!=i){for(var o=1;o<i.length-1;o+=2){var l=i[o],c=i[o+1];r[l]=c}for(var d in r)-1!==s.indexOf(d)&&delete r[d];r=Object(a.a)(Object(a.a)({},r),t)}else r=t;return"".concat(location.origin+location.pathname,"?").concat(objToQuery(r))}},234:function(e,t,n){"use strict";(function(e){var a=n(3),s=n(4),i=n(80),r=n(19),o=function(){function CloudLog(){Object(a.a)(this,CloudLog),i.a.init({token:r.f,no_format:!0,catchall:!1}),this.context={}}return Object(s.a)(CloudLog,[{key:"bind",value:function bind(e){this.context.update(e)}},{key:"emit",value:function emit(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"log";if("undefined"===typeof e.__JEST__){var a={ctx:this.context,created:(new Date).getTime()/1e3,msg:t,src:"JSCloudLog"};"log"===n?i.a.log(a):"warn"===n?i.a.warn(a):"error"===n&&i.a.error(a)}}},{key:"log",value:function log(e){this.emit(e)}},{key:"warn",value:function warn(e){this.emit(e,"warn")}},{key:"error",value:function error(e){this.emit(e,"error")}}]),CloudLog}();t.a=new o}).call(this,n(33))},237:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return b}));var a=n(16),s=n(10),i=n(3),r=n(4),o=n(7),l=n(8),c=n(1),d=n.n(c),u=n(47),g=n(81),h=n(251),m=n(69),p=n(148),S=n(14),f=u.StyleSheet.create({bit:{margin:0,padding:9,userSelect:"none",cursor:"pointer",textAlign:"center",position:"relative"},bitSelectedStyle:{backgroundColor:"rgba(0,119,158,0.5)"},byteIndex:{backgroundColor:"#ededed"},bitSignificance:{fontSize:12,display:"block",position:"absolute",bottom:0,left:0,right:0,margin:"0 auto"},highlightedSignalTitle:{backgroundColor:"rgba(0,0,0,0.2)"}}),b=function(t){Object(o.a)(AddSignals,t);var n=Object(l.a)(AddSignals);function AddSignals(e){var t;Object(i.a)(this,AddSignals),(t=n.call(this,e)).updateSignalStyles=function(){var e=t.calcSignalStyles(t.state.signals);t.setState({signalStyles:e}),t.matrixMouseMove()},t.onSignalHover=function(e){e&&t.setState({highlightedSignal:e.name},t.updateSignalStyles)},t.onBitHover=function(e,n){var a=t.state,s=a.dragStartBit,i=a.signals,r=a.dragSignal;if(null!==s)if(null!==r){if(i=t.copySignals(i),s===(r=Object.assign(Object.create(r),r)).startBit&&r.size>1){if(r.isLittleEndian){if(e>r.msbBitIndex())return}else if(S.a.bigEndianBitIndex(e)>r.lsbBitNumber())return;var o=e-s;r.isLittleEndian?r.size-=o:null===r.bitDescription(e)?r.size+=Math.abs(o):r.size-=Math.abs(o),r.startBit+=o,i[r.name]=r,s=r.startBit}else if(1===r.size)Math.floor(e/8)===Math.floor(s/8)&&(e>s?r.isLittleEndian?r.size=e-r.startBit:(r.startBit=e,r.size=e-s+1,s=e):r.isLittleEndian?(r.startBit=e,r.size=s-e+1,s=e):(r.size=s-e+1,s=e)),i[r.name]=r;else if(r.isLittleEndian&&s===r.msbBitIndex()){if(e<r.startBit)return;var l=e-s;null===r.bitDescription(e)?r.size+=Math.abs(l):r.size-=Math.abs(l),i[r.name]=r,s=r.msbBitIndex()}else if(!r.isLittleEndian&&s===r.lsbBitIndex()){var c=e-s;null===r.bitDescription(e)?r.size+=Math.abs(c):r.size-=Math.abs(c),i[r.name]=r,s=r.lsbBitIndex()}t.setState({signals:i,dragSignal:r,dragCurrentBit:e,dragStartBit:s})}else t.setState({dragCurrentBit:e});n&&t.onSignalHover(n)},t.onSignalHoverEnd=function(e){e&&t.setState({highlightedSignal:null},t.updateSignalStyles)},t.resetDragState=function(){t.setState({dragStartBit:null,dragSignal:null,dragCurrentBit:null})},t.matrixMouseMove=function(e){if(t.state.highlightedSignal&&t.highlightedSignalTooltipRef.current){var n=t.highlightedSignalTooltipRef.current,a=t.state.signals[t.state.highlightedSignal];n.innerHTML=a.name,e&&(n.style.left=e.clientX+15+"px",n.style.top=e.clientY+5+"px")}},t.onTentativeSignalChange=function(e){var n=t.state.signals;n[e.name]=e,t.setState({signals:n})},t.onSignalChange=function(e){var n=t.state.signals;if(e.name in n&&n[e.name].uid!==e.uid)return!1;for(var a in n)n[a].uid===e.uid&&delete n[a];return n[e.name]=e,t.setState({signals:n},t.propagateUpSignalChange),!0},t.onSignalRemove=function(e){var n=t.state.signals;delete n[e.name],t.setState({signals:n},t.propagateUpSignalChange)},t.onSignalPlotChange=function(e,n){var a=t.props.message;t.props.onSignalPlotChange(e,a.id,n)};var a={};return e.message&&e.message.frame&&e.message.frame.signals&&(a=t.copySignals(e.message.frame.signals)),t.highlightedSignalTooltipRef=d.a.createRef(),t.state={bits:[],signals:a,signalStyles:t.calcSignalStyles(a),highlightedSignal:null,dragStartBit:null,dragSignal:null,dragCurrentBit:null,maxMessageBytes:8},t}return Object(r.a)(AddSignals,[{key:"copySignals",value:function copySignals(e){return Object.entries(e).reduce((function(e,t){var n=Object(s.a)(t,2),a=n[0],i=n[1];return e[a]=Object.assign(Object.create(i),i),e}),{})}},{key:"componentDidMount",value:function componentDidMount(){this.componentDidUpdate({},{})}},{key:"componentDidUpdate",value:function componentDidUpdate(e){if(!e.message||e.message.address!==this.props.message.address||e.selectedMessageKey!==this.props.selectedMessageKey){var t=this.props.message.frame?this.props.message.frame.signals:{};this.setState({signals:this.copySignals(t),maxMessageBytes:S.a.maxMessageSize(this.props.message)},this.updateSignalStyles)}}},{key:"shouldComponentUpdate",value:function shouldComponentUpdate(e,t){return e.selectedMessageKey!==this.props.selectedMessageKey||e.message.address!==this.props.message.address||e.message.hexData!==this.props.message.hexData||e.messageIndex!==this.props.messageIndex||JSON.stringify(e.plottedSignalUids)!==JSON.stringify(this.props.plottedSignalUids)||JSON.stringify(this.state)!==JSON.stringify(t)}},{key:"signalColorStyle",value:function signalColorStyle(e){var t,n,a=e.getColors(this.props.selectedMessageKey);if(this.state&&this.state.highlightedSignal===e.name){var s=Object(p.a)(a,-.5),i=Object(p.a)(a,.9);t="rgb(".concat(i.join(","),")"),n="rgba(".concat(s.join(","),",0.5)")}else{var r=a.join(",");t="rgb(".concat(r,")"),n="rgba(".concat(r,",0.2)")}return u.StyleSheet.create({signal:{color:t,backgroundColor:n}}).signal}},{key:"calcSignalStyles",value:function calcSignalStyles(e){var t=this,n={};return Object.values(e).forEach((function(e){n[e.name]=t.signalColorStyle(e)})),n}},{key:"signalForBit",value:function signalForBit(e){return Object.values(this.state.signals).filter((function(t){return null!==t.bitDescription(e)}))[0]}},{key:"signalBitIndex",value:function signalBitIndex(e,t){var n=t.startBit;return t.isLittleEndian||(n=S.a.bigEndianBitIndex(n)),e-n}},{key:"nextNewSignalName",value:function nextNewSignalName(){var e,t=Object.keys(this.state.signals),n=1;do{e="NEW_SIGNAL_".concat(n),n++}while(-1!==t.indexOf(e));return e}},{key:"onBitMouseDown",value:function onBitMouseDown(e,t){this.setState({dragStartBit:e,dragSignal:t||null})}},{key:"createSignal",value:function createSignal(e){var t=e.startBit,n=e.size,s=e.isLittleEndian,i=new m.a({name:this.nextNewSignalName(),startBit:t,size:n,isLittleEndian:s}),r=this.state.signals;(r=Object(a.a)({},r))[i.name]=i,this.setState({signals:r},this.propagateUpSignalChange)}},{key:"createSignalIfNotExtendingOne",value:function createSignalIfNotExtendingOne(e,t){if(null===this.state.dragSignal){for(var n=e;n<=t;n++)if(void 0!==this.signalForBit(n))return;var a,s,i=Math.floor(t/8)===Math.floor(e/8);a=i||!(!i&&t<e)?e%8<4:e%8>=4;var r=e;i?s=Math.abs(t-e)+1:a?t>e?(r=e,s=t-e+1):(r=t,s=e-t+1):(t<e&&(r=t),s=Math.abs(S.a.bigEndianBitIndex(t)-S.a.bigEndianBitIndex(e))+1),this.createSignal({startBit:r,size:s,isLittleEndian:a})}}},{key:"onBitMouseUp",value:function onBitMouseUp(e,t){if(null!==this.state.dragStartBit){var n=this.state.dragStartBit;e!==n&&this.createSignalIfNotExtendingOne(n,e),this.propagateUpSignalChange(),this.resetDragState()}}},{key:"byteValueHex",value:function byteValueHex(e){var t=this.props.message.entries;return this.props.messageIndex<t.length?t[this.props.messageIndex].hexData.substr(2*e,2):"--"}},{key:"bitValue",value:function bitValue(t,n){var a=this.props.message.entries;if(this.props.messageIndex<a.length){var s=a[this.props.messageIndex],i=e.from(s.hexData,"hex");return t>=i.length?"-":i.readInt8(t)>>n&1}return"-"}},{key:"bitIsContainedInSelection",value:function bitIsContainedInSelection(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.state,a=n.dragStartBit,s=n.dragCurrentBit;if(t||a%8<4)return null!==a&&null!==s&&e>=a&&e<=s;var i=S.a.bigEndianBitIndex(a),r=S.a.bigEndianBitIndex(s),o=S.a.bigEndianBitIndex(e);return null!==a&&null!==s&&o>=i&&o<=r}},{key:"onBitDoubleClick",value:function onBitDoubleClick(e,t){void 0===t&&this.createSignal({startBit:e,size:1,isLittleEndian:!1})}},{key:"renderBitMatrix",value:function renderBitMatrix(){var e,t=this,n=this.props.message,a=[];e=n.frame&&n.frame.size?Math.floor(8*n.frame.size/8):this.state.maxMessageBytes;for(var s=0;s<e;s++){var i=[];i.push(d.a.createElement("td",{key:"rowIndex".concat(s),className:Object(g.a)(f.bit,f.byteIndex)},s.toString()));for(var r=function _loop(e){var n=8*s+e,a=t.signalForBit(n),r=null,o="";if(a){r=t.state.signalStyles[a.name]||null;var l=a.bitDescription(n);o=l.isMsb?"msb":l.isLsb?"lsb":""}else t.bitIsContainedInSelection(n)&&(r=f.bitSelectedStyle);var c=Object(g.a)("bit",f.bit,r),u=t.bitValue(s,e);i.push(d.a.createElement("td",{key:e.toString(),className:c,onMouseEnter:function onMouseEnter(){return t.onBitHover(n,a)},onMouseLeave:function onMouseLeave(){return t.onSignalHoverEnd(a)},onMouseDown:t.onBitMouseDown.bind(t,n,a),onMouseUp:t.onBitMouseUp.bind(t,n,a),onDoubleClick:t.onBitDoubleClick.bind(t,n,a)},d.a.createElement("span",null,u),d.a.createElement("span",{className:Object(g.a)(f.bitSignificance)},o)))},o=7;o>=0;o--)r(o);i.push(d.a.createElement("td",{key:"hex-repr",className:Object(g.a)(f.bit)},d.a.createElement("b",null,this.byteValueHex(s)))),a.push(d.a.createElement("tr",{key:s.toString()},i))}return d.a.createElement("div",{className:"cabana-explorer-signals-matrix",onMouseMove:this.matrixMouseMove},this.state.highlightedSignal&&d.a.createElement("p",{ref:this.highlightedSignalTooltipRef,className:"cabana-explorer-signals-matrix-tooltip"}),d.a.createElement("table",{cellSpacing:0,onMouseLeave:this.resetDragState},d.a.createElement("tbody",null,a)))}},{key:"propagateUpSignalChange",value:function propagateUpSignalChange(){var e=this.state.signals;this.props.onConfirmedSignalChange(this.props.message,this.copySignals(e))}},{key:"render",value:function render(){var e=this.props.selectedMessageKey;return d.a.createElement("div",{className:"cabana-explorer-signals-controller"},0===Object.keys(this.state.signals).length?d.a.createElement("p",null,"Double click or drag to add a signal"):null,this.props.message.entries[this.props.messageIndex]?d.a.createElement("div",{className:"cabana-explorer-signals-time"},d.a.createElement("p",null,"time:"," ",this.props.message.entries[this.props.messageIndex].relTime.toFixed(3))):null,this.renderBitMatrix(),d.a.createElement(h.a,{signals:this.state.signals,signalStyles:this.state.signalStyles,highlightedSignal:this.state.highlightedSignal,onSignalHover:this.onSignalHover,onSignalHoverEnd:this.onSignalHoverEnd,onTentativeSignalChange:this.onTentativeSignalChange,onSignalChange:this.onSignalChange,onSignalRemove:this.onSignalRemove,onSignalPlotChange:this.onSignalPlotChange,plottedSignalUids:this.props.plottedSignalUids,selectedMessageKey:e}))}}]),AddSignals}(c.Component)}).call(this,n(36).Buffer)},251:function(e,t,n){"use strict";n.d(t,"a",(function(){return _}));var a=n(10),s=n(5),i=n(3),r=n(4),o=n(7),l=n(8),c=n(1),d=n.n(c),u=n(17),g=n.n(u),h=(n(69),n(14)),m=function unsignedTransformation(e){return function(t,n){return""!==t&&(t=Number(t)||0)<0&&(t=0),n[e]=t,n}},p=[{field:"name",title:"Name",type:"string"},{field:"size",title:"Size",type:"number",transform:m("size")},{field:"startBit",title:function title(e){return e.isLittleEndian?"Least significant bit":"Most significant bit"},type:"number",transform:m("startBit")},{field:"isLittleEndian",title:"Endianness",type:"option",options:{options:["Little","Big"],optionValues:{Little:!0,Big:!1}},transform:function transform(e,t){if(t.isLittleEndian!==e){var n=t.startBit;if(e){var a=Math.floor(t.startBit/8),s=Math.floor((t.startBit-t.size+1)/8);t.startBit=a===s?t.startBit-t.size+1:h.a.matrixBitNumber(n)}else{var i=Math.floor(t.startBit/8),r=Math.floor((t.startBit+t.size-1)/8);t.startBit=i===r?t.startBit+t.size-1:h.a.bigEndianBitIndex(n)}t.isLittleEndian=e}return t}},{field:"isSigned",title:"Sign",type:"option",options:{options:["Signed","Unsigned"],optionValues:{Signed:!0,Unsigned:!1}}},{field:"factor",title:"Factor",type:"number"},{field:"offset",title:"Offset",type:"number"},{field:"unit",title:"Unit",type:"string"},{field:"comment",title:"Comment",type:"string"},{field:"min",title:"Minimum value",type:"number"},{field:"max",title:"Maximum value",type:"number"},{field:"valueDescriptions",title:"Value descriptions",type:"map"}],S=function(e){Object(o.a)(Field,e);var t=Object(l.a)(Field);function Field(){return Object(i.a)(this,Field),t.apply(this,arguments)}return Object(r.a)(Field,[{key:"render",value:function render(){var e=this.props,t=e.title,n=e.htmlFor,a=e.children,s=!1===e.valid?" form-field-error":"";return d.a.createElement("div",{className:"form-field form-field--small".concat(s)},d.a.createElement("label",{htmlFor:n},t),a)}}]),Field}(c.Component);n(6);var f=n(9),b={number:function(e){var t,n=e.fieldSpec,a=e.signal,s=e.isExpanded,i=e.signalEdited,r=e.updateField,o=e.valid,l=n.field,c=n.title,u="".concat(a.name,"_").concat(l);if(s){var g=i;if(""!==g){var h=Number(g);g=isNaN(h)?"":h}t=d.a.createElement("input",{id:u,type:"number",value:g,onChange:function onChange(e){r(n,e.target.value)}})}else{var m=a[l];t=d.a.createElement("span",null,m)}return d.a.createElement(S,{title:"function"===typeof c?c(a):c,htmlFor:u,valid:o},t)},option:function(e){var t,n=e.fieldSpec,a=e.signal,s=e.isExpanded,i=e.signalEdited,r=e.updateField,o=e.valid,l=n.field,c=n.title,u="".concat(a.name,"_").concat(l),g=n.options,h=g.options,m=g.optionValues,p=function swapKeysAndValues(e,t){return Object.keys(e).reduce((function(t,n){return t[e[n]]=n,t}),{})}(m);if(s){var f=h.map((function(e){return d.a.createElement("option",{key:e,value:m[e]},e)}));t=d.a.createElement("select",{id:u,defaultValue:i,onChange:function onChange(e){r(n,"true"===e.target.value)}},f)}else t=d.a.createElement("span",null,p[a[l]]);return d.a.createElement(S,{title:"function"===typeof c?c(a):c,htmlFor:u,valid:o},t)},string:function(e){var t,n=e.fieldSpec,a=e.signal,s=e.isExpanded,i=e.signalEdited,r=e.updateField,o=e.valid,l=n.field,c=n.title,u="".concat(a.name,"_").concat(l);return t=s?d.a.createElement("input",{id:u,type:"text",value:i||"",onChange:function onChange(e){r(n,e.target.value)}}):d.a.createElement("span",null,a[l]),d.a.createElement(S,{title:"function"===typeof c?c(a):c,htmlFor:u,valid:o},t)},map:function(e){Object(o.a)(MapField,e);var t=Object(l.a)(MapField);function MapField(e){var n;return Object(i.a)(this,MapField),(n=t.call(this,e)).state={valid:!0,mapString:""},n.onChange=n.onChange.bind(Object(f.a)(n)),n}return Object(r.a)(MapField,[{key:"componentDidMount",value:function componentDidMount(){this.componentDidUpdate({},{})}},{key:"componentDidUpdate",value:function componentDidUpdate(e){if(e.isExpanded!==this.props.isExpanded){var t=Array.from(this.props.signalEdited.entries()).reduce((function(e,t){var n=Object(a.a)(t,2),s=n[0],i=n[1];return"".concat(e+s,' "').concat(i,'" ')}),"").trim();this.setState({mapString:t})}}},{key:"onChange",value:function onChange(e){var t=e.target.value;if(this.setState({mapString:t}),(t.split('"').length-1)%2===0){var n=Array.from(t.matchAll(/[^\s"]+|"([^"]*)"/g));if(n.length%2===0){n=n.map((function(e){var t=Object(a.a)(e,2),n=t[0];return t[1]||n}));for(var s=new Map,i=0;i<n.length;i+=2)s.set(n[i],n[i+1]);this.setState({valid:!0}),this.props.updateField(this.props.fieldSpec,s)}else this.setState({valid:!1})}else this.setState({valid:!1})}},{key:"render",value:function render(){var e,t=this.props,n=t.fieldSpec,a=t.signal,s=t.isExpanded,i="".concat(a.name,"_").concat(n.field);return e=s?d.a.createElement("input",{id:i,type:"text",value:this.state.mapString,onChange:this.onChange}):d.a.createElement("span",null,a[n.field]),d.a.createElement(S,{title:"function"===typeof n.title?n.title(a):n.title,htmlFor:i,valid:this.props.valid&&this.state.valid},e)}}]),MapField}(c.Component)},SignalForm=function(e){var t=e.signal,n=e.onSignalRemove,a=e.isExpanded,s=e.getSignalEdited,i=e.fieldError,r=e.update;return d.a.createElement("div",{className:"signals-legend-entry-form"},p.map((function(e){var n=b[e.type],o=i!==e.field;return d.a.createElement("div",{className:"signals-legend-entry-form-field",key:e.field},d.a.createElement(n,{fieldSpec:e,signal:t,isExpanded:a,signalEdited:s(e.field),updateField:r,valid:o}))})),d.a.createElement("div",{className:"signals-legend-entry-form-remove"},d.a.createElement("button",{className:"button--tiny button--alpha",onClick:function onClick(){return n(t)}},"Remove Signal")))},v=function(e){Object(o.a)(SignalLegendEntry,e);var t=Object(l.a)(SignalLegendEntry);function SignalLegendEntry(e){var n;return Object(i.a)(this,SignalLegendEntry),(n=t.call(this,e)).updateField=function(e,t){var s=n.state.signalEdited,i=n.props.signal;e.transform?s=e.transform(t,s):s[e.field]=t,n.setState({signalEdited:s});var r=Object.assign(Object.create(i),i);Object.entries(s).forEach((function(e){var t=Object(a.a)(e,2),n=t[0],s=t[1];r[n]=s}));var o=n.props.onSignalChange(r);n.setState({fieldError:o?null:e.field})},n.toggleEditing=function(e){var t=n.state.signalEdited,s=n.props,i=s.signal,r=s.isExpanded,o=Object.assign(Object.create(i),i);r?(Object.entries(t).forEach((function(e){var t=Object(a.a)(e,2),n=t[0],s=t[1],i=SignalLegendEntry.fieldSpecForName(n);i&&"number"===i.type&&isNaN(parseInt(s,10))&&(s=0),o[n]=s})),n.props.onSignalChange(o)):t=o,n.setState({fieldError:null,signalEdited:t}),n.props.toggleExpandSignal(i),e.stopPropagation()},n.toggleSignalPlot=function(e){var t=n.props,a=t.signal,s=t.isPlotted;e.preventDefault(),n.props.onSignalPlotChange(!s,a.uid)},n.getSignalEdited=function(e){return n.state.signalEdited[e]},n.state={fieldError:null,signalEdited:Object.assign(Object.create(e.signal),e.signal)},n}return Object(r.a)(SignalLegendEntry,[{key:"componentDidUpdate",value:function componentDidUpdate(e){this.props.signal.equals(e.signal)||this.setState({fieldError:null,signalEdited:Object.assign(Object.create(this.props.signal),this.props.signal)})}},{key:"render",value:function render(){var e=this,t=this.props,n=t.signal,a=t.isHighlighted,s=t.color,i=t.isPlotted,r=t.isExpanded,o=r?"is-expanded":null,l=i?"button":"button--alpha",c={opacity:a?.5:.3,backgroundColor:s?"rgb(".concat(s.join(","),")"):null};return d.a.createElement("div",{className:g()("signals-legend-entry",o),onMouseEnter:function onMouseEnter(){return e.props.onSignalHover(n)},onMouseLeave:function onMouseLeave(){return e.props.onSignalHoverEnd(n)}},d.a.createElement("div",{className:"signals-legend-entry-colorbar",style:c}),d.a.createElement("div",{className:"signals-legend-entry-header"},d.a.createElement("div",{className:"signals-legend-entry-header-name",onClick:this.toggleEditing},d.a.createElement("strong",null,n.name)),d.a.createElement("div",{className:"signals-legend-entry-header-action",onClick:this.toggleSignalPlot},d.a.createElement("button",{className:g()("button--tiny",l)},i?"Hide Plot":"Show Plot"))),d.a.createElement("div",{className:"signals-legend-entry-body"},r&&d.a.createElement(SignalForm,{signal:n,onSignalRemove:this.props.onSignalRemove,isExpanded:r,getSignalEdited:this.getSignalEdited,fieldError:this.state.fieldError,update:this.updateField})))}}]),SignalLegendEntry}(c.Component);v.fieldSpecForName=function(e){return p.find((function(t){return t.field===e}))};var _=function(e){Object(o.a)(SignalLegend,e);var t=Object(l.a)(SignalLegend);function SignalLegend(){var e;Object(i.a)(this,SignalLegend);for(var n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(e=t.call.apply(t,[this].concat(a))).state={expandedSignals:[]},e.toggleExpandSignal=function(t){var n=e.state.expandedSignals;if(n.includes(t.uid)){var a=n.filter((function(e){return e!==t.uid}));e.setState({expandedSignals:a})}else{var i=[].concat(Object(s.a)(n),[t.uid]);e.setState({expandedSignals:i})}},e}return Object(r.a)(SignalLegend,[{key:"checkExpandedSignal",value:function checkExpandedSignal(e){return this.state.expandedSignals.includes(e)}},{key:"render",value:function render(){var e=this,t=this.props,n=t.signals,s=t.highlightedSignal,i=t.selectedMessageKey,r=Object.entries(n).sort((function(e,t){var n=Object(a.a)(e,2),s=(n[0],n[1]),i=Object(a.a)(t,2),r=(i[0],i[1]);return s.startBit<r.startBit?-1:1})).map((function(t){var r=Object(a.a)(t,2),o=r[0],l=r[1],c=n[o].getColors(i),u=s===o;return d.a.createElement(v,{key:l.uid,signal:l,isHighlighted:u,color:c,onSignalHover:e.props.onSignalHover,onSignalHoverEnd:e.props.onSignalHoverEnd,onTentativeSignalChange:e.props.onTentativeSignalChange,onSignalChange:e.props.onSignalChange,onSignalRemove:e.props.onSignalRemove,onSignalPlotChange:e.props.onSignalPlotChange,toggleExpandSignal:e.toggleExpandSignal,isPlotted:-1!==e.props.plottedSignalUids.indexOf(l.uid),isExpanded:e.checkExpandedSignal(l.uid)})})).filter((function(e){return null!=e})).reduce((function(e,t){return e.concat(t)}),[]);return d.a.createElement("div",{className:"cabana-explorer-signals-legend"},r)}}]),SignalLegend}(c.Component)},257:function(e,t,n){e.exports=n(528)},373:function(e){e.exports=JSON.parse('{"ACURA ILX 2016":"acura_ilx_2016_can_generated","ACURA RDX 2018":"acura_rdx_2018_can_generated","ACURA RDX 2020":"acura_rdx_2020_can_generated","AUDI A3 3RD GEN":"vw_mqb_2010","AUDI Q2 1ST GEN":"vw_mqb_2010","AUDI Q3 2ND GEN":"vw_mqb_2010","BUICK REGAL ESSENCE 2018":"gm_global_a_powertrain_generated","CADILLAC ATS Premium Performance 2018":"gm_global_a_powertrain_generated","CADILLAC ESCALADE 2017":"gm_global_a_powertrain_generated","CADILLAC ESCALADE ESV 2016":"gm_global_a_powertrain_generated","CHEVROLET BOLT EUV 2022":"gm_global_a_powertrain_generated","CHEVROLET EQUINOX 2019":"gm_global_a_powertrain_generated","CHEVROLET MALIBU PREMIER 2017":"gm_global_a_powertrain_generated","CHEVROLET SILVERADO 1500 2020":"gm_global_a_powertrain_generated","CHEVROLET VOLT PREMIER 2017":"gm_global_a_powertrain_generated","CHRYSLER PACIFICA 2018":"chrysler_pacifica_2017_hybrid_generated","CHRYSLER PACIFICA 2020":"chrysler_pacifica_2017_hybrid_generated","CHRYSLER PACIFICA HYBRID 2017":"chrysler_pacifica_2017_hybrid_generated","CHRYSLER PACIFICA HYBRID 2018":"chrysler_pacifica_2017_hybrid_generated","CHRYSLER PACIFICA HYBRID 2019":"chrysler_pacifica_2017_hybrid_generated","COMMA BODY":"comma_body","FORD BRONCO SPORT 1ST GEN":"ford_lincoln_base_pt","FORD ESCAPE 4TH GEN":"ford_lincoln_base_pt","FORD EXPLORER 6TH GEN":"ford_lincoln_base_pt","FORD FOCUS 4TH GEN":"ford_lincoln_base_pt","FORD MAVERICK 1ST GEN":"ford_lincoln_base_pt","GENESIS G70 2018":"hyundai_kia_generic","GENESIS G70 2020":"hyundai_kia_generic","GENESIS G80 2017":"hyundai_kia_generic","GENESIS G90 2017":"hyundai_kia_generic","GENESIS GV60 ELECTRIC 1ST GEN":"hyundai_canfd","GENESIS GV70 1ST GEN":"hyundai_canfd","GMC ACADIA DENALI 2018":"gm_global_a_powertrain_generated","HOLDEN ASTRA RS-V BK 2017":"gm_global_a_powertrain_generated","HONDA ACCORD 2018":"honda_accord_2018_can_generated","HONDA ACCORD HYBRID 2018":"honda_accord_2018_can_generated","HONDA CIVIC (BOSCH) 2019":"honda_civic_hatchback_ex_2017_can_generated","HONDA CIVIC 2016":"honda_civic_touring_2016_can_generated","HONDA CIVIC 2022":"honda_civic_ex_2022_can_generated","HONDA CIVIC SEDAN 1.6 DIESEL 2019":"honda_accord_2018_can_generated","HONDA CR-V 2016":"honda_crv_touring_2016_can_generated","HONDA CR-V 2017":"honda_crv_ex_2017_can_generated","HONDA CR-V EU 2016":"honda_crv_executive_2016_can_generated","HONDA CR-V HYBRID 2019":"honda_accord_2018_can_generated","HONDA E 2020":"acura_rdx_2020_can_generated","HONDA FIT 2018":"honda_fit_ex_2018_can_generated","HONDA FREED 2020":"honda_fit_ex_2018_can_generated","HONDA HRV 2019":"honda_fit_ex_2018_can_generated","HONDA INSIGHT 2019":"honda_insight_ex_2019_can_generated","HONDA ODYSSEY 2018":"honda_odyssey_exl_2018_generated","HONDA ODYSSEY CHN 2019":"honda_odyssey_extreme_edition_2018_china_can_generated","HONDA PILOT 2017":"acura_ilx_2016_can_generated","HONDA RIDGELINE 2017":"acura_ilx_2016_can_generated","HYUNDAI ELANTRA 2017":"hyundai_kia_generic","HYUNDAI ELANTRA 2021":"hyundai_kia_generic","HYUNDAI ELANTRA HYBRID 2021":"hyundai_kia_generic","HYUNDAI GENESIS 2015-2016":"hyundai_kia_generic","HYUNDAI IONIQ 5 2022":"hyundai_canfd","HYUNDAI IONIQ ELECTRIC 2020":"hyundai_kia_generic","HYUNDAI IONIQ ELECTRIC LIMITED 2019":"hyundai_kia_generic","HYUNDAI IONIQ HYBRID 2017-2019":"hyundai_kia_generic","HYUNDAI IONIQ HYBRID 2020-2022":"hyundai_kia_generic","HYUNDAI IONIQ PHEV 2020":"hyundai_kia_generic","HYUNDAI IONIQ PLUG-IN HYBRID 2019":"hyundai_kia_generic","HYUNDAI KONA 2020":"hyundai_kia_generic","HYUNDAI KONA ELECTRIC 2019":"hyundai_kia_generic","HYUNDAI KONA ELECTRIC 2022":"hyundai_kia_generic","HYUNDAI KONA HYBRID 2020":"hyundai_kia_generic","HYUNDAI PALISADE 2020":"hyundai_kia_generic","HYUNDAI SANTA CRUZ 1ST GEN":"hyundai_canfd","HYUNDAI SANTA FE 2019":"hyundai_kia_generic","HYUNDAI SANTA FE 2022":"hyundai_kia_generic","HYUNDAI SANTA FE HYBRID 2022":"hyundai_kia_generic","HYUNDAI SANTA FE PlUG-IN HYBRID 2022":"hyundai_kia_generic","HYUNDAI SONATA 2019":"hyundai_kia_generic","HYUNDAI SONATA 2020":"hyundai_kia_generic","HYUNDAI SONATA HYBRID 2021":"hyundai_kia_generic","HYUNDAI TUCSON 2019":"hyundai_kia_generic","HYUNDAI TUCSON 4TH GEN":"hyundai_canfd","HYUNDAI TUCSON HYBRID 4TH GEN":"hyundai_canfd","HYUNDAI VELOSTER 2019":"hyundai_kia_generic","JEEP GRAND CHEROKEE 2019":"chrysler_pacifica_2017_hybrid_generated","JEEP GRAND CHEROKEE V6 2018":"chrysler_pacifica_2017_hybrid_generated","KIA CEED INTRO ED 2019":"hyundai_kia_generic","KIA EV6 2022":"hyundai_canfd","KIA FORTE E 2018 & GT 2021":"hyundai_kia_generic","KIA K5 2021":"hyundai_kia_generic","KIA K5 HYBRID 2020":"hyundai_kia_generic","KIA NIRO EV 2020":"hyundai_kia_generic","KIA NIRO HYBRID 2019":"hyundai_kia_generic","KIA NIRO HYBRID 2021":"hyundai_kia_generic","KIA NIRO HYBRID 2ND GEN":"hyundai_canfd","KIA OPTIMA 4TH GEN":"hyundai_kia_generic","KIA OPTIMA 4TH GEN FACELIFT":"hyundai_kia_generic","KIA OPTIMA HYBRID 2017 & SPORTS 2019":"hyundai_kia_generic","KIA SELTOS 2021":"hyundai_kia_generic","KIA SORENTO 4TH GEN":"hyundai_canfd","KIA SORENTO GT LINE 2018":"hyundai_kia_generic","KIA SORENTO PLUG-IN HYBRID 4TH GEN":"hyundai_canfd","KIA SPORTAGE 5TH GEN":"hyundai_canfd","KIA SPORTAGE HYBRID 5TH GEN":"hyundai_canfd","KIA STINGER 2022":"hyundai_kia_generic","KIA STINGER GT2 2018":"hyundai_kia_generic","LEXUS CT HYBRID 2018":"toyota_new_mc_pt_generated","LEXUS ES 2019":"toyota_nodsu_pt_generated","LEXUS ES HYBRID 2018":"toyota_new_mc_pt_generated","LEXUS ES HYBRID 2019":"toyota_nodsu_pt_generated","LEXUS IS 2018":"toyota_tnga_k_pt_generated","LEXUS NX 2018":"toyota_tnga_k_pt_generated","LEXUS NX 2020":"toyota_nodsu_pt_generated","LEXUS NX HYBRID 2018":"toyota_tnga_k_pt_generated","LEXUS NX HYBRID 2020":"toyota_nodsu_pt_generated","LEXUS RC 2020":"toyota_tnga_k_pt_generated","LEXUS RX 2016":"toyota_tnga_k_pt_generated","LEXUS RX 2020":"toyota_nodsu_pt_generated","LEXUS RX HYBRID 2017":"toyota_tnga_k_pt_generated","LEXUS RX HYBRID 2020":"toyota_nodsu_pt_generated","MAZDA 3":"mazda_2017","MAZDA 6":"mazda_2017","MAZDA CX-5":"mazda_2017","MAZDA CX-5 2022":"mazda_2017","MAZDA CX-9":"mazda_2017","MAZDA CX-9 2021":"mazda_2017","NISSAN ALTIMA 2020":"nissan_x_trail_2017","NISSAN LEAF 2018":"nissan_leaf_2018","NISSAN LEAF 2018 Instrument Cluster":"nissan_leaf_2018","NISSAN ROGUE 2019":"nissan_x_trail_2017","NISSAN X-TRAIL 2017":"nissan_x_trail_2017","RAM 1500 5TH GEN":"chrysler_ram_dt_generated","RAM HD 5TH GEN":"chrysler_ram_hd_generated","SEAT ATECA 1ST GEN":"vw_mqb_2010","SEAT LEON 3RD GEN":"vw_mqb_2010","SKODA FABIA 4TH GEN":"vw_mqb_2010","SKODA KAMIQ 1ST GEN":"vw_mqb_2010","SKODA KAROQ 1ST GEN":"vw_mqb_2010","SKODA KODIAQ 1ST GEN":"vw_mqb_2010","SKODA OCTAVIA 3RD GEN":"vw_mqb_2010","SKODA SCALA 1ST GEN":"vw_mqb_2010","SKODA SUPERB 3RD GEN":"vw_mqb_2010","SUBARU ASCENT LIMITED 2019":"subaru_global_2017_generated","SUBARU FORESTER 2017 - 2018":"subaru_forester_2017_generated","SUBARU FORESTER 2019":"subaru_global_2017_generated","SUBARU IMPREZA LIMITED 2019":"subaru_global_2017_generated","SUBARU IMPREZA SPORT 2020":"subaru_global_2017_generated","SUBARU LEGACY 2015 - 2018":"subaru_outback_2015_generated","SUBARU LEGACY 7TH GEN":"subaru_global_2017_generated","SUBARU OUTBACK 2015 - 2017":"subaru_outback_2015_generated","SUBARU OUTBACK 2018 - 2019":"subaru_outback_2019_generated","SUBARU OUTBACK 6TH GEN":"subaru_global_2017_generated","TESLA AP1 MODEL S":"tesla_powertrain","TESLA AP2 MODEL S":"tesla_powertrain","TOYOTA ALPHARD 2020":"toyota_nodsu_pt_generated","TOYOTA ALPHARD HYBRID 2021":"toyota_nodsu_pt_generated","TOYOTA AVALON 2016":"toyota_tnga_k_pt_generated","TOYOTA AVALON 2019":"toyota_nodsu_pt_generated","TOYOTA AVALON 2022":"toyota_nodsu_pt_generated","TOYOTA AVALON HYBRID 2019":"toyota_nodsu_pt_generated","TOYOTA AVALON HYBRID 2022":"toyota_nodsu_pt_generated","TOYOTA C-HR 2018":"toyota_nodsu_pt_generated","TOYOTA C-HR 2021":"toyota_nodsu_pt_generated","TOYOTA C-HR HYBRID 2018":"toyota_nodsu_pt_generated","TOYOTA C-HR HYBRID 2022":"toyota_nodsu_pt_generated","TOYOTA CAMRY 2018":"toyota_nodsu_pt_generated","TOYOTA CAMRY 2021":"toyota_nodsu_pt_generated","TOYOTA CAMRY HYBRID 2018":"toyota_nodsu_pt_generated","TOYOTA CAMRY HYBRID 2021":"toyota_nodsu_pt_generated","TOYOTA COROLLA 2017":"toyota_new_mc_pt_generated","TOYOTA COROLLA HYBRID TSS2 2019":"toyota_nodsu_pt_generated","TOYOTA COROLLA TSS2 2019":"toyota_nodsu_pt_generated","TOYOTA HIGHLANDER 2017":"toyota_tnga_k_pt_generated","TOYOTA HIGHLANDER 2020":"toyota_nodsu_pt_generated","TOYOTA HIGHLANDER HYBRID 2018":"toyota_tnga_k_pt_generated","TOYOTA HIGHLANDER HYBRID 2020":"toyota_nodsu_pt_generated","TOYOTA MIRAI 2021":"toyota_nodsu_pt_generated","TOYOTA PRIUS 2017":"toyota_nodsu_pt_generated","TOYOTA PRIUS TSS2 2021":"toyota_nodsu_pt_generated","TOYOTA PRIUS v 2017":"toyota_new_mc_pt_generated","TOYOTA RAV4 2017":"toyota_new_mc_pt_generated","TOYOTA RAV4 2019":"toyota_nodsu_pt_generated","TOYOTA RAV4 2022":"toyota_nodsu_pt_generated","TOYOTA RAV4 HYBRID 2017":"toyota_tnga_k_pt_generated","TOYOTA RAV4 HYBRID 2019":"toyota_nodsu_pt_generated","TOYOTA RAV4 HYBRID 2022":"toyota_nodsu_pt_generated","TOYOTA SIENNA 2018":"toyota_tnga_k_pt_generated","VOLKSWAGEN ARTEON 1ST GEN":"vw_mqb_2010","VOLKSWAGEN ATLAS 1ST GEN":"vw_mqb_2010","VOLKSWAGEN CRAFTER 2ND GEN":"vw_mqb_2010","VOLKSWAGEN GOLF 7TH GEN":"vw_mqb_2010","VOLKSWAGEN JETTA 7TH GEN":"vw_mqb_2010","VOLKSWAGEN PASSAT 8TH GEN":"vw_mqb_2010","VOLKSWAGEN PASSAT NMS":"vw_golf_mk4","VOLKSWAGEN POLO 6TH GEN":"vw_mqb_2010","VOLKSWAGEN SHARAN 2ND GEN":"vw_golf_mk4","VOLKSWAGEN T-CROSS 1ST GEN":"vw_mqb_2010","VOLKSWAGEN T-ROC 1ST GEN":"vw_mqb_2010","VOLKSWAGEN TAOS 1ST GEN":"vw_mqb_2010","VOLKSWAGEN TIGUAN 2ND GEN":"vw_mqb_2010","VOLKSWAGEN TOURAN 2ND GEN":"vw_mqb_2010","VOLKSWAGEN TRANSPORTER T6.1":"vw_mqb_2010"}')},457:function(e,t,n){e.exports=n.p+"static/media/webusb-enable-experimental-features.e5a08e76.png"},458:function(e,t,n){e.exports=n.p+"static/media/webusb-enable-webusb.aceef6a0.png"},515:function(e,t){},518:function(e,t,n){e.exports=function(){return new Worker(n.p+"446687357022147ccc5b.worker.js")}},519:function(e,t,n){e.exports=function(){return new Worker(n.p+"6e307d3c0861c64b8219.worker.js")}},520:function(e,t,n){e.exports=function(){return new Worker(n.p+"55009426bccb9ca9494f.worker.js")}},521:function(e,t,n){e.exports=function(){return new Worker(n.p+"0c797d351e8982355390.worker.js")}},527:function(e,t,n){},528:function(e,t,n){"use strict";n.r(t);var a=n(1),s=n.n(a),i=n(231),r=n.n(i),o=n(79),l=n.n(o),c=n(17),d=n.n(c),u=n(232),g=n(233),h=n.n(g),m=n(22),p=n.n(m),S=n(40),f=n(97),b=n(19),v=n(23);function authorizeUrl(e){var t={client_id:b.d,redirect_uri:b.e,scope:"user:email public_repo",state:JSON.stringify({route:e})};return"http://github.com/login/oauth/authorize?".concat(Object(v.c)(t))}var _=n(10),E=n(2),y=n(3),C=n(4),T=n(234),O=n(69),k=function(){function Frame(e){var t=e.name,n=e.id,a=void 0===n?0:n,s=e.size,i=void 0===s?0:s,r=e.transmitters,o=void 0===r?[]:r,l=e.extended,c=void 0===l?0:l,d=e.comment,u=void 0===d?null:d,g=e.signals,h=void 0===g?{}:g;Object(y.a)(this,Frame),Object.assign(this,{name:t,id:a,size:i,transmitters:o,extended:c,comment:u,signals:h})}return Object(C.a)(Frame,[{key:"nextNewTransmitterName",value:function nextNewTransmitterName(){var e,t=1;do{e="NEW_TRANSMITTER_".concat(t),t++}while(-1!==this.transmitters.indexOf(e));return e}},{key:"addTransmitter",value:function addTransmitter(){var e=this.nextNewTransmitterName();return this.transmitters.push(e),e}},{key:"header",value:function header(){return"BO_ ".concat(this.id," ").concat(this.name,": ").concat(this.size," ")+"".concat(this.transmitters[0]||"XXX")}},{key:"text",value:function text(){var e=Object.values(this.signals).map((function(e){return" ".concat(e.text())})).join("\n");return e.length>0?"".concat(this.header(),"\n").concat(e):this.header()}},{key:"copy",value:function copy(){var copy=Object.assign(Object.create(this),this);return copy}}]),Frame}(),M=function(){function BoardUnit(e){Object(y.a)(this,BoardUnit),this.name=e,this.attributes={},this.comment=null}return Object(C.a)(BoardUnit,[{key:"text",value:function text(){return this.name}}]),BoardUnit}(),A=n(14),X=/^CM_ *"(.*)";/,D=/^CM_ *"(.*)/,N=/^BO_ (\w+) (\w+) *: (\w+) (\w+)/,I=/^SG_ (\w+) : (\d+)\|(\d+)@(\d+)([+|-]) \(([0-9.+-eE]+),([0-9.+-eE]+)\) \[([0-9.+-eE]+)\|([0-9.+-eE]+)\] "(.*)" (.*)/,w=/^SG_ (\w+) (\w+) *: (\d+)\|(\d+)@(\d+)([+|-]) \(([0-9.+-eE]+),([0-9.+-eE]+)\) \[([0-9.+-eE]+)\|([0-9.+-eE]+)\] "(.*)" (.*)/,R=/^VAL_ (\w+) (\w+) (.*);/,x=/^VAL_TABLE_ (\w+) (.*);/,L=/^BO_TX_BU_ ([0-9]+) *: *(.+);/,G=/^CM_ SG_ *(\w+) *(\w+) *"(.*)";/,P=/^CM_ SG_ *(\w+) *(\w+) *"(.*)/,U=/^CM_ BO_ *(\w+) *"(.*)";/,B=/^CM_ BO_ *(\w+) *"(.*)/,j=/^BU_:(.*)/,F=/^CM_ BU_ *(\w+) *"(.*)";/,H=/^CM_ BU_ *(\w+) *"(.*)/;function floatOrInt(e){return Number.isInteger(e)?parseInt(e,10):parseFloat(e)}var V=function(){function DBC(e){Object(y.a)(this,DBC),this.boardUnits=[],this.comments=[],this.messages=new Map,void 0!==e&&(this.dbcText=e,this.importDbcString(e))}return Object(C.a)(DBC,[{key:"getMessageFrame",value:function getMessageFrame(e){return this.messages.get(e)}},{key:"nextNewFrameName",value:function nextNewFrameName(){var e,t=[],n=Object(E.a)(this.messages.values());try{for(n.s();!(e=n.n()).done;){var a=e.value;t.push(a.name)}}catch(r){n.e(r)}finally{n.f()}var s,i=1;do{s="NEW_MSG_".concat(i),i++}while(-1!==t.indexOf(s));return s}},{key:"updateBoardUnits",value:function updateBoardUnits(){var e=this.boardUnits.map((function(e){return e.name})),t=Array.from(this.messages.entries()).map((function(e){var t=Object(_.a)(e,2),n=(t[0],t[1]);return Object.values(n.signals)})).reduce((function(e,t){return e.concat(t)}),[]).map((function(e){return e.receiver})).reduce((function(e,t){return e.concat(t)}),[]).filter((function(e,t,n){return n.indexOf(e)===t})).filter((function(t){return-1===e.indexOf(t)})).map((function(e){return new M(e)}));this.boardUnits=this.boardUnits.concat(t)}},{key:"text",value:function text(){this.updateBoardUnits();var e='VERSION ""\n\n\n';e+="NS_ :".concat(this._newSymbols()),e+="\n\nBS_:\n";var t=this.boardUnits.map((function(e){return e.text()})).join(" ");e+="\nBU_: ".concat(t,"\n\n\n");var n,a=[],s=Object(E.a)(this.messages.values());try{for(s.s();!(n=s.n()).done;){var i=n.value;a.push(i)}}catch(l){s.e(l)}finally{s.f()}e+="".concat(a.map((function(e){return e.text()})).join("\n\n"),"\n\n");var r=a.map((function(e){return[e.id,e.transmitters.slice(1)]})).filter((function(e){var t=Object(_.a)(e,2);t[0];return t[1].length>0}));e+="".concat(r.map((function(e){var t=Object(_.a)(e,2),n=t[0],a=t[1];return"BO_TX_BU_ ".concat(n," : ").concat(a.join(","),";")})).join("\n"),"\n\n\n"),e+=this.boardUnits.filter((function(e){return null!==e.comment})).map((function(e){return"CM_ BU_ ".concat(e.name,' "').concat(e.comment,'";')})).join("\n"),e+=a.filter((function(e){return null!==e.comment})).map((function(e){return"CM_ BO_ ".concat(e.address,' "').concat(e.comment,'";')})).join("\n");var o=a.map((function(e){return Object.values(e.signals).map((function(t){return[e.id,t]}))})).reduce((function(e,t){return e.concat(t)}),[]);return e+="".concat(o.filter((function(e){var t=Object(_.a)(e,2);t[0];return null!==t[1].comment})).map((function(e){var t=Object(_.a)(e,2),n=t[0],a=t[1];return"CM_ SG_ ".concat(n," ").concat(a.name,' "').concat(a.comment,'";')})).join("\n"),"\n"),e+="".concat(o.filter((function(e){var t=Object(_.a)(e,2);t[0];return t[1].valueDescriptions.size>0})).map((function(e){var t=Object(_.a)(e,2),n=t[0];return t[1].valueDescriptionText(n)})).join("\n"),"\n"),e+=this.comments.map((function(e){return'CM_ "'.concat(e,'";')})).join("\n"),"".concat(e.trim(),"\n")}},{key:"getMessageName",value:function getMessageName(e){var t=this.getMessageFrame(e);return t&&t.frame?t.frame.name:null}},{key:"getSignals",value:function getSignals(e){var t=this.getMessageFrame(e);return t?t.signals:{}}},{key:"createFrame",value:function createFrame(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:64,n=new k({name:this.nextNewFrameName(),id:e,size:t});return this.messages.set(e,n),n}},{key:"setSignals",value:function setSignals(e,t,n){var a=this.getMessageFrame(e);if(a){var s=Object.assign(Object.create(a),a);s.signals=t,this.messages.set(e,s)}else{var i=this.createFrame(e,n);i.signals=t,this.messages.set(e,i),this.updateBoardUnits()}}},{key:"addSignal",value:function addSignal(e,t){var n=this.getMessageFrame(e);n&&(n.signals[t.name]=t,this.updateBoardUnits())}},{key:"importDbcString",value:function importDbcString(e){for(var t=[],n=new Map,a=[],s=new Map,i=0,r=null,o=e.split("\n"),l=0;l<o.length;l++){var c=o[l].trim();if(0!==c.length){if(null!=r){var d=r,u=d.type,g=d.data;c=c.replace(/" *;/,"");var h="\n".concat(c.substr(0,c.length));if(-1!==c.indexOf('"')&&(r=null,h=h.substr(0,h.length-1)),"FollowUpSignalComment"===u)g.comment+=h;else if("FollowUpMsgComment"===u){g.comment+=h}else if("FollowUpBoardUnitComment"===u){g.comment+=h}else if("FollowUpDbcComment"===u){var m=this.comments[this.comments.length-1];this.comments[this.comments.length-1]=m+h}}if(0===c.indexOf("BO_ ")){var p=c.match(N);if(null===p){t.push("failed to parse message definition on line ".concat(l+1," -- ").concat(c));continue}var S=p.slice(1),f=Object(_.a)(S,4),b=f[0],v=f[1],E=f[2],y=f[3];i=parseInt(b,0),E=parseInt(E,10);var C=new k({name:v,id:i,size:E,transmitters:[y]});n.set(i,C)}else if(0===c.indexOf("SG_")){var A=c.match(I);if(null===A){if(null===(A=c.match(w))){t.push("failed to parse signal definition on line ".concat(l+1," -- ").concat(c));continue}A=A[1]+A.slice(3)}else A=A.slice(1);var V=A,Y=Object(_.a)(V,11),K=Y[0],W=Y[1],z=Y[2],q=Y[3],Q=Y[4],J=Y[5],Z=Y[6],$=Y[7],ee=Y[8],te=Y[9],ne=Y[10],ae={name:K,startBit:W=parseInt(W,10),size:z=parseInt(z,10),isLittleEndian:q=1===parseInt(q,10),isSigned:Q="-"===Q,factor:J=floatOrInt(J),offset:Z=floatOrInt(Z),unit:te,min:$=floatOrInt($),max:ee=floatOrInt(ee),receiver:ne.split(",").map((function(e){return e.trim()}))},se=new O.a(ae);void 0!==n.get(i)?n.get(i).signals[K]=se:T.a.warn("importDbcString: could not add signal: ".concat(K," due to missing message: ").concat(i))}else if(0===c.indexOf("VAL_ ")){var ie=c.match(R);if(null!==ie){var re=ie.slice(1),oe=Object(_.a)(re,3),le=oe[0],ce=oe[1],de=oe[2];de=de.split('"').map((function(e){return e.trim()})).filter((function(e){return e.length>0})),le=parseInt(le,10);var ue=n.get(le).signals[ce];if(void 0===ue){t.push("could not find signal for value description on line ".concat(l+1," -- ").concat(c));continue}for(var ge=0;ge<de.length;ge+=2){var he=de[ge].trim(),me=de[ge+1].trim();ue.valueDescriptions.set(he,me)}}else t.push("failed to parse value description on line ".concat(l+1," -- ").concat(c))}else if(0===c.indexOf("VAL_TABLE_ ")){var pe=c.match(x);if(null!==pe){var Se=new Map,fe=pe.slice(1),be=Object(_.a)(fe,2),ve=be[0],_e=be[1];_e=_e.split('"').map((function(e){return e.trim()})).filter((function(e){return e.length>0}));for(var Ee=0;Ee<_e.length;Ee+=2){var ye=_e[Ee],Ce=_e[Ee+1];Se.set(ye,Ce)}s.set(ve,Se)}else t.push("failed to parse value table on line ".concat(l+1," -- ").concat(c))}else if(0===c.indexOf("BO_TX_BU_ ")){var Te=c.match(L);if(null!==Te){var Oe=Te.slice(1),ke=Object(_.a)(Oe,2),Me=ke[0],Ae=ke[1];Me=parseInt(Me,10);var Xe=n.get(Me);Xe.transmitters.push(Ae),n.set(Me,Xe)}else t.push("failed to parse message transmitter definition on line ".concat(l+1," -- ").concat(c))}else if(0===c.indexOf("CM_ SG_ ")){var De=c.match(G),Ne=!1;if(null===De&&(De=c.match(P),Ne=!0),null===De){t.push("failed to parse signal comment on line ".concat(l+1," -- ").concat(c));continue}var Ie=De.slice(1),we=Object(_.a)(Ie,3),Re=we[0],xe=we[1],Le=we[2];Re=parseInt(Re,10);var Ge=n.get(Re);if(void 0===Ge){t.push("failed to parse signal comment on line ".concat(l+1," -- ").concat(c,":\n                                    message id ").concat(Re," does not exist prior to this line"));continue}var Pe=Ge.signals[xe];if(void 0===Pe){t.push("failed to parse signal comment on line ".concat(l+1," -- ").concat(c));continue}Pe.comment=Le,n.set(Re,Ge),Ne&&(r={type:"FollowUpSignalComment",data:Pe})}else if(0===c.indexOf("CM_ BO_ ")){var Ue=c.match(U),Be=!1;if(null===Ue&&(Be=!0,null===(Ue=c.match(B)))){t.push("failed to message comment on line ".concat(l+1," -- ").concat(c));continue}var je=Ue.slice(1),Fe=Object(_.a)(je,2),He=Fe[0],Ve=Fe[1];He=parseInt(He,10);var Ye=n.get(He);if(void 0===Ye){t.push("failed to find message to add comment to, msg id: ".concat(He));continue}Ye.comment=Ve,Be&&(r={type:"FollowUpMsgComment",data:Ye})}else if(0===c.indexOf("BU_: ")){var Ke=c.match(j);if(null===Ke){t.push("failed to parse board unit definition on line ".concat(l+1," -- ").concat(c));continue}var We=Ke.slice(1),ze=Object(_.a)(We,1)[0].split(" ").map((function(e){return e.trim()})).filter((function(e){return e.length>0})).map((function(e){return new M(e)}));a=a.concat(ze)}else if(0===c.indexOf("CM_ BU_ ")){if("continue"===function(){var e=c.match(F),n=!1;if(null===e&&(n=!0,null===(e=c.match(H))))return t.push("failed to parse board unit comment on line ".concat(l+1," -- ").concat(c)),"continue";var s=e.slice(1),i=Object(_.a)(s,2),o=i[0],d=i[1],u=a.find((function(e){return e.name===o}));u&&(u.comment=d),n&&(r={type:"FollowUpBoardUnitComment",data:u})}())continue}else if(0===c.indexOf("CM_ ")){var qe=c.match(X),Qe=!1;if(null===qe){if(null===(qe=c.match(D))){t.push("failed to parse dbc comment on line ".concat(l+1," -- ").concat(c));continue}Qe=!0}var Je=qe.slice(1),Ze=Object(_.a)(Je,1)[0];this.comments.push(Ze),Qe&&(r={type:"FollowUpDbcComment",data:Ze})}}}t.length,this.messages=n,this.boardUnits=a,this.valueTables=s}},{key:"valueForIntSignal",value:function valueForIntSignal(e,t){var n,a;e.isLittleEndian?(n=e.startBit,a=e.startBit+e.size-1):(n=A.a.matrixBitNumber(A.a.bigEndianBitIndex(e.startBit)+e.size-1),a=e.startBit);for(var s=e.size>32?0n:0,i=Math.floor(a/8),r=e.size;i>=0&&i<t.byteLength&&r>0;){var o=Math.floor(n/8)===i?n:8*i,l=(Math.floor(a/8)===i?a:8*(i+1)-1)-o+1,c=t.getUint8(i)>>>o-8*i&(1<<l)-1;e.size>32?s|=BigInt(c)<<BigInt(r-l):s|=c<<r-l,r-=l,i=e.isLittleEndian?i-1:i+1}return e.size>32?(s=e.isSigned?BigInt.asIntN(64,s):s,Number.isInteger(e.factor)?s*BigInt(e.factor)+BigInt(e.offset):parseFloat(s)*e.factor+e.offset):(e.isSigned&&(s-=s>>e.size-1&1?1<<e.size:0),s*e.factor+e.offset)}},{key:"getSignalValues",value:function getSignalValues(e,t){var n=this;if(!this.messages.has(e))return{};var a=this.getMessageFrame(e),s=new DataView(t.buffer),i={};return Object.values(a.signals).forEach((function(e){isNaN(e.startBit)||(i[e.name]=n.valueForIntSignal(e,s))})),i}},{key:"getChffrMetricMappings",value:function getChffrMetricMappings(){var e=this.comments.find((function(e){return 0===e.indexOf("CHFFR_METRIC")}));return e?e.split(";").map((function(e){return e.trim().split(" ")})).reduce((function(e,t){var n=Object(_.a)(t,6),a=(n[0],n[1]),s=n[2],i=n[3],r=n[4],o=n[5];return e[i]={messageId:parseInt(a,10),signalName:s,factor:parseFloat(r),offset:parseFloat(o)},e}),{}):null}},{key:"_newSymbols",value:function _newSymbols(){return"\n    NS_DESC_\n    CM_\n    BA_DEF_\n    BA_\n    VAL_\n    CAT_DEF_\n    CAT_\n    FILTER\n    BA_DEF_DEF_\n    EV_DATA_\n    ENVVAR_DATA_\n    SGTYPE_\n    SGTYPE_VAL_\n    BA_DEF_SGTYPE_\n    BA_SGTYPE_\n    SIG_TYPE_REF_\n    VAL_TABLE_\n    SIG_GROUP_\n    SIG_VALTYPE_\n    SIGTYPE_VALTYPE_\n    BO_TX_BU_\n    BA_DEF_REL_\n    BA_REL_\n    BA_DEF_DEF_REL_\n    BU_SG_REL_\n    BU_EV_REL_\n    BU_BO_REL_\n    SG_MUL_VAL_"}}]),DBC}(),Y=n(9),K=n(7),W=n(8),z=n(236),q=n.n(z),Q=function(e){Object(K.a)(MessageBytes,e);var t=Object(W.a)(MessageBytes);function MessageBytes(e){var n;return Object(y.a)(this,MessageBytes),(n=t.call(this,e)).state={isVisible:!0,lastMessageIndex:0,lastSeekTime:0},n.onVisibilityChange=n.onVisibilityChange.bind(Object(Y.a)(n)),n.onCanvasRefAvailable=n.onCanvasRefAvailable.bind(Object(Y.a)(n)),n.updateCanvas=n.updateCanvas.bind(Object(Y.a)(n)),n.canvasInView=n.canvasInView.bind(Object(Y.a)(n)),n}return Object(C.a)(MessageBytes,[{key:"componentDidMount",value:function componentDidMount(){this.componentDidUpdate({},{})}},{key:"componentDidUpdate",value:function componentDidUpdate(e){var t;e.message!==this.props.message&&(t=this.props.message.frame&&this.props.message.frame.size?Math.ceil(this.props.message.frame.size/8):Math.ceil(A.a.maxMessageSize(this.props.message,this.state.maxMessageBytes)/8),this.canvas&&(this.canvas.height=15*t));e.seekIndex===this.props.seekIndex&&Math.floor(60*e.seekTime)===Math.floor(60*this.props.seekTime)||this.updateCanvas()}},{key:"canvasInView",value:function canvasInView(){return!window.visualViewport||!this.canvas||this.canvas.getBoundingClientRect().y>=270&&window.visualViewport.height>=this.canvas.getBoundingClientRect().y}},{key:"shouldComponentUpdate",value:function shouldComponentUpdate(e,t){if(e.live&&e.message.entries.length){var n=e.message.entries[e.message.entries.length-1],a=this.props.message.entries[this.props.message.entries.length-1];return!n||!a||n.hexData!==a.hexData}return e.seekTime!==this.props.seekTime}},{key:"findMostRecentMessage",value:function findMostRecentMessage(e){var t=this.props.message,n=this.state,a=n.lastMessageIndex,s=n.lastSeekTime,i=null;if(e>=s)for(var r=a;r<t.entries.length;++r){var o=t.entries[r];if(o&&o.relTime>=e){i=r;break}}if(i||(i=t.entries.findIndex((function(t){return t.relTime>=e}))),i)return this.setState({lastMessageIndex:i,lastSeekTime:e}),t.entries[i]}},{key:"updateCanvas",value:function updateCanvas(){var e=this.props,t=e.message,n=e.live,a=e.seekTime;if(this.canvas&&0!==t.entries.length&&this.canvasInView()){var s=t.entries[t.entries.length-1];n||(s=this.findMostRecentMessage(a))||(s=t.entries[0]);for(var i=this.canvas.getContext("2d"),r=0;r<t.byteStateChangeCounts.length;++r){var o=s.hexData.substr(2*r,2),l=r%8*20,c=15*Math.floor(r/8);i.fillStyle=t.byteColors[r],i.fillRect(l,c,20,15),i.font="12px Courier",i.fillStyle="white",i.fillText(o||"-",l+2,c+12)}}}},{key:"onVisibilityChange",value:function onVisibilityChange(e){e!==this.state.isVisible&&this.setState({isVisible:e})}},{key:"onCanvasRefAvailable",value:function onCanvasRefAvailable(e){var t;e&&(this.canvas=e,this.canvas.width=160,t=this.props.message.frame&&this.props.message.frame.size?Math.ceil(this.props.message.frame.size/8):Math.ceil(A.a.maxMessageSize(this.props.message,this.state.maxMessageBytes)/8),this.canvas.height=15*t,new IntersectionObserver(this.updateCanvas).observe(this.canvas))}},{key:"render",value:function render(){return s.a.createElement("canvas",{ref:this.onCanvasRefAvailable,className:"cabana-meta-messages-list-item-bytes-canvas"})}}]),MessageBytes}(a.Component),J=n(381).ckmeans,Z=function(e){Object(K.a)(Meta,e);var t=Object(W.a)(Meta);function Meta(e){var n;Object(y.a)(this,Meta),(n=t.call(this,e)).onFilterChanged=n.onFilterChanged.bind(Object(Y.a)(n)),n.onFilterFocus=n.onFilterFocus.bind(Object(Y.a)(n)),n.onFilterUnfocus=n.onFilterUnfocus.bind(Object(Y.a)(n)),n.canMsgFilter=n.canMsgFilter.bind(Object(Y.a)(n)),n.renderMessageBytes=n.renderMessageBytes.bind(Object(Y.a)(n));var a=e.dbcLastSaved;return n.state={filterText:"Filter",lastSaved:null!==a?n.props.dbcLastSaved.fromNow():null,hoveredMessages:[],orderedMessageKeys:[]},n}return Object(C.a)(Meta,[{key:"componentDidMount",value:function componentDidMount(){var e=this;this.lastSavedTimer=setInterval((function(){null!==e.props.dbcLastSaved&&e.setState({lastSaved:e.props.dbcLastSaved.fromNow()})}),3e4)}},{key:"componentWillUnmount",value:function componentWillUnmount(){window.clearInterval(this.lastSavedTimer)}},{key:"componentDidUpdate",value:function componentDidUpdate(e){if(e.lastSaved!==this.props.lastSaved&&this.setState({lastSaved:this.props.dbcLastSaved.fromNow()}),JSON.stringify(Object.keys(e.messages))!==JSON.stringify(Object.keys(this.props.messages))){var t=this.sortMessages(this.props.messages);this.setState({hoveredMessages:[],orderedMessageKeys:t})}else if(0===this.state.orderedMessageKeys.length||!this.props.live&&e.messages&&this.props.messages&&this.byteCountsDidUpdate(e.messages,this.props.messages)){var n=this.sortMessages(this.props.messages);n.length>0&&this.setState({orderedMessageKeys:n})}}},{key:"byteCountsDidUpdate",value:function byteCountsDidUpdate(e,t){return Object.entries(t).some((function(t){var n=Object(_.a)(t,2),a=n[0],s=n[1];return JSON.stringify(s.byteStateChangeCounts)!==JSON.stringify(e[a].byteStateChangeCounts)}))}},{key:"sortMessages",value:function sortMessages(e){if(0===Object.keys(e).length)return[];var t=Object.entries(e).reduce((function(e,t){var n=Object(_.a)(t,2),a=(n[0],n[1]),s=a.entries.length.toString();return e[s]?e[s].push(a):e[s]=[a],e}),{}),n=Object.keys(t).map((function(e){return parseInt(e,10)}));return J(n,Math.min(n.length,10)).map((function(e){return e.map((function(e){return t[e.toString()]})).reduce((function(e,t){return e.concat(t)}),[]).sort((function(e,t){return e.address<t.address?1:-1})).map((function(e){return e.id}))})).reduce((function(e,t){return e.concat(t)}),[]).reverse()}},{key:"onFilterChanged",value:function onFilterChanged(e){var t=e.target.value;"Filter"===t.trim()&&(t=""),this.setState({filterText:t})}},{key:"onFilterFocus",value:function onFilterFocus(e){"Filter"===this.state.filterText.trim()&&this.setState({filterText:""})}},{key:"onFilterUnfocus",value:function onFilterUnfocus(e){""===this.state.filterText.trim()&&this.setState({filterText:"Filter"})}},{key:"canMsgFilter",value:function canMsgFilter(e){var t=this.state.filterText,n=e.frame?e.frame.name:"";return"Filter"===t||""===t||-1!==e.id.toLowerCase().indexOf(t.toLowerCase())||-1!==n.toLowerCase().indexOf(t.toLowerCase())}},{key:"lastSavedPretty",value:function lastSavedPretty(){return this.props.dbcLastSaved.fromNow()}},{key:"onMessageHover",value:function onMessageHover(e){var t=this.state.hoveredMessages;-1===t.indexOf(e)&&(t.push(e),this.setState({hoveredMessages:t}))}},{key:"onMessageHoverEnd",value:function onMessageHoverEnd(e){var t=this.state.hoveredMessages;t=t.filter((function(t){return t!==e})),this.setState({hoveredMessages:t})}},{key:"onMsgRemoveClick",value:function onMsgRemoveClick(e){var t=this.state.selectedMessages;t=t.filter((function(t){return t!==e})),this.props.onMessageUnselected(e),this.setState({selectedMessages:t})}},{key:"onMessageSelected",value:function onMessageSelected(e){var t=[];t.push(e),this.props.updateSelectedMessages(t),this.props.onMessageSelected(e)}},{key:"orderedMessages",value:function orderedMessages(){var e=this.state.orderedMessageKeys,t=this.props.messages;return e.map((function(e){return t[e]}))}},{key:"selectedMessageClass",value:function selectedMessageClass(e){return this.props.selectedMessages.includes(e)?"is-selected":null}},{key:"renderMessageBytes",value:function renderMessageBytes(e){var t=this;return s.a.createElement("tr",{onClick:function onClick(){t.onMessageSelected(e.id)},key:e.id,className:d()("cabana-meta-messages-list-item",this.selectedMessageClass(e.id))},s.a.createElement("td",null,e.frame?e.frame.name:"untitled"),s.a.createElement("td",null,e.id),s.a.createElement("td",null,e.entries.length),s.a.createElement("td",null,s.a.createElement("div",{className:"cabana-meta-messages-list-item-bytes"},s.a.createElement(Q,{key:e.id,message:e,seekIndex:this.props.seekIndex,seekTime:this.props.seekTime,live:this.props.live}))))}},{key:"renderCanMessages",value:function renderCanMessages(){return this.orderedMessages().filter(this.canMsgFilter).map(this.renderMessageBytes)}},{key:"renderAvailableMessagesList",value:function renderAvailableMessagesList(){return 0===Object.keys(this.props.messages).length?s.a.createElement("p",null,"Loading messages..."):s.a.createElement(s.a.Fragment,null,s.a.createElement("table",{cellPadding:"5"},s.a.createElement("thead",null,s.a.createElement("tr",null,s.a.createElement("td",null,"Name"),s.a.createElement("td",null,"ID"),s.a.createElement("td",null,"Count"),s.a.createElement("td",null,"Bytes"))),s.a.createElement("tbody",null,this.renderCanMessages())))}},{key:"saveable",value:function saveable(){try{return"serviceWorker"in navigator&&new ReadableStream&&new WritableStream,"saveable"}catch(e){return!1}}},{key:"render",value:function render(){return s.a.createElement("div",{className:"cabana-meta"},s.a.createElement("div",{className:"cabana-meta-header"},s.a.createElement("h5",{className:"cabana-meta-header-label t-capline"},"Currently editing:"),s.a.createElement("strong",{className:"cabana-meta-header-filename"},this.props.dbcFilename),null!==this.props.dbcLastSaved?s.a.createElement("div",{className:"cabana-meta-header-last-saved"},s.a.createElement("p",null,"Last saved:",this.lastSavedPretty())):null,s.a.createElement("div",{className:"cabana-meta-header-actions ".concat(this.saveable())},s.a.createElement("div",{className:"cabana-meta-header-action"},s.a.createElement("button",{onClick:this.props.showLoadDbc},"Load DBC")),this.saveable()&&s.a.createElement("div",{className:"cabana-meta-header-action"},s.a.createElement("button",{onClick:this.props.saveLog},"Save Log")),this.props.shareUrl?s.a.createElement("div",{className:"cabana-meta-header-action special-wide","data-clipboard-text":this.props.shareUrl,"data-clipboard-action":"copy",ref:function ref(e){return e?new q.a(e):null}},s.a.createElement("a",{className:"button",href:this.props.shareUrl,onClick:function onClick(e){return e.preventDefault()}},"Copy Share Link")):null,s.a.createElement("div",{className:"cabana-meta-header-action"},s.a.createElement("button",{onClick:this.props.showSaveDbc},"Save DBC")))),s.a.createElement("div",{className:"cabana-meta-messages-header"},s.a.createElement("h5",{className:"t-capline"},"Available messages")),s.a.createElement("div",{className:"cabana-meta-messages-filter"},s.a.createElement("div",{className:"form-field form-field--small"},s.a.createElement("input",{type:"text",value:this.state.filterText,onFocus:this.onFilterFocus,onBlur:this.onFilterUnfocus,onChange:this.onFilterChanged}))),s.a.createElement("div",{className:"cabana-meta-messages-list"},this.renderAvailableMessagesList()))}}]),Meta}(a.Component),$=n(5),ee=n(237),te=n(16),ne=n(106),ae=n(541);var se={elementWiseEquals:function elementWiseEquals(e,t){return e.length===t.length&&e.every((function(e,n){return t[n]===e}))},findIndexRight:function findIndexRight(e,t){for(var n=e.length-1;n>=0;n--)if(t(e[n]))return n}};function _calcGraphData(e,t,n){if(!e)return null;var a=Object.values(e.frame.signals).find((function(e){return e.uid===t}));if(!a)return console.warn("_calcGraphData: no signal",t,e),null;var s=[],i=Math.floor(e.entries.length/b.a);if(0===i)s=e.entries;else{for(var r=0;r<e.entries.length;r+=i)s.push(e.entries[r]);s.push(e.entries[e.entries.length-1])}if(!s.length)return[];var o=a.getColors(e.id);t=e.id+t;var l=s[0].relTime;return s.filter((function(e){return void 0!==e.signals[a.name]})).map((function(n){return n.relTime<l&&(console.log(e),console.error("Found out of order messages")),n.relTime-l>2&&(t=Math.random().toString(36)),l=n.relTime,{x:n.time,relTime:n.relTime,y:parseFloat(n.signals[a.name]),unit:a.unit,color:"rgba(".concat(o.join(","),", 0.5)"),signalName:a.name,signalUid:t}}))}var ie={_calcGraphData:_calcGraphData,appendNewGraphData:function appendNewGraphData(e,t,n,a){return e.map((function(e){return e.reduce((function(e,t){var n=t.messageId;t.signalUid;return e.push(n),e}),[])})).map((function(e,t){return{plottedMessageIds:e,index:t}})).filter((function(e){var a=e.plottedMessageIds,s=e.index;if(s<t.length){var i=0,r=t[s].series;return r.length>0&&(i=r[t[s].series.length-1].relTime),a.some((function(e){return n[e].entries.length>0&&0===r.length||n[e].entries.some((function(e){return e.relTime>i}))}))}return!1})).map((function(e){var t=e.plottedMessageIds,n=e.index;return{plottedMessageIds:t=t.reduce((function(e,t){return-1===e.indexOf(t)&&e.push(t),e}),[]),index:n}})).forEach((function(a){var s=a.plottedMessageIds,i=a.index,r=e[i].reduce((function(e,t){var n=t.messageId,a=t.signalUid;return e[n]||(e[n]=[]),e[n].push(a),e}),{}),o=t[i].series,l=s.reduce((function(e,t){var n=r[t],a=se.findIndexRight(o,(function(e){return-1!==n.indexOf(e.signalUid)}));return a?e[t]=o[a].relTime:o.length>0?e[t]=o[o.length-1].relTime:e[t]=-1,e}),{}),c=[];s.map((function(e){return{messageId:e,entries:n[e].entries}})).filter((function(e){var t=e.messageId,n=e.entries;return n[n.length-1].relTime>l[t]})).forEach((function(e){var t=e.messageId,a=e.entries,s=a.findIndex((function(e){return e.relTime>l[t]})),i=a.slice(s);r[t].forEach((function(e){var a=_calcGraphData(Object(te.a)(Object(te.a)({},n[t]),{},{entries:i}),e);c=c.concat(a)}))}));var d=o.length>0&&s.find((function(e){return n[e].entries.length>0&&o[0].relTime<n[e].entries[0].relTime}));if(t[i]={series:t[i].series.concat(c),updated:Date.now()},d){var u=t[i].series.findIndex((function(e){return e.relTime>n[d].entries[0].relTime}));u&&(t[i].series=t[i].series.slice(u))}})),Object($.a)(t)},signalColors:function signalColors(e,t){return e.colors.map((function(e){return e^t.address^t.bus}))}},re={$schema:"https://vega.github.io/schema/vega/v5.json",width:500,height:212,autosize:"none",padding:{top:5,left:70,right:20,bottom:20},data:[{name:"table"},{name:"segment"},{name:"tooltip",source:"table",transform:[{type:"filter",expr:"abs(datum.relTime - tipTime) <= 0.05"},{type:"aggregate",groupby:["color"],fields:["relTime","y","unit"],ops:["min","argmin","argmin"],as:["min","argmin","argmin"]}]},{name:"ySegmentScale",source:"table",transform:[{type:"filter",expr:"length(segment) != 2 || (datum.relTime >= segment[0] && datum.relTime <= segment[1])"},{type:"extent",field:"y",signal:"ySegment"}]}],scales:[{name:"xscale",type:"linear",range:"width",domain:{data:"table",field:"x"},zero:!1},{name:"xrelscale",type:"linear",range:"width",domain:{data:"table",field:"relTime"},zero:!1,clamp:!0,nice:!0,domainRaw:{signal:"segment"}},{name:"yscale",type:"linear",range:"height",clamp:!0,zero:!1,nice:!0,domain:{signal:"ySegment"}},{name:"color",type:"ordinal",domain:{data:"table",field:"color"},range:{data:"table",field:"color"}}],axes:[{orient:"bottom",scale:"xrelscale",labelOverlap:!0},{orient:"left",scale:"yscale",format:".6~g"}],signals:[{name:"tipTime",on:[{events:"mousemove",update:"invert('xrelscale', x())"},{events:"mouseout",update:"null"}]},{name:"clickTime",on:[{events:"click",update:"invert('xrelscale', x())"}]},{name:"videoTime"},{name:"segment",value:{data:"table",field:"relTime"}}],marks:[{type:"group",name:"plot",interactive:!0,encode:{enter:{width:{signal:"width"},height:{signal:"height"},fill:{value:"transparent"}}},signals:[{name:"brush",value:0,on:[{events:"@boundingRect:mousedown",update:"[x(), x()]"},{events:"[@boundingRect:mousedown, window:mouseup] > window:mousemove!",update:"[brush[0], clamp(x(), 0, width)]"},{events:{signal:"delta"},update:"clampRange([anchor[0] + delta, anchor[1] + delta], 0, width)"}]},{name:"anchor",value:null,on:[{events:"@brush:mousedown",update:"slice(brush)"}]},{name:"xdown",value:0,on:[{events:"@brush:mousedown",update:"x()"}]},{name:"xup",value:0,on:[{events:"@brush:mouseup",update:"x()"}]},{name:"delta",value:0,on:[{events:"[@brush:mousedown, window:mouseup] > window:mousemove!",update:"x() - xdown"}]},{name:"segment",push:"outer",on:[{events:"window:mouseup",update:"span(brush) && span(brush) > 15 ? invert('xrelscale', brush) : segment"}]}],marks:[{type:"group",from:{facet:{name:"series",data:"table",groupby:"signalUid"}},marks:[{type:"line",name:"lineMark",from:{data:"series"},interactive:!0,encode:{update:{value:"natural",tension:0,x:{scale:"xrelscale",field:"relTime"},y:{scale:"yscale",field:"y"},detail:{field:"signalUid"}},hover:{fillOpacity:{value:.5}},enter:{clip:{value:!0},stroke:{scale:"color",field:"color"},strokeWidth:{value:2}}}}]},{type:"rect",interactive:!0,name:"brush",encode:{enter:{y:{value:0},height:{signal:"height"},fill:{value:"#333"},fillOpacity:{value:.2}},update:{x:{signal:"brush[0]"},x2:{signal:"brush[1]"}}}},{type:"rule",encode:{update:{y:{value:0},y2:{field:{group:"height"}},stroke:{value:"#000"},strokeWidth:{value:2},x:{scale:"xrelscale",signal:"videoTime",offset:.5}}}},{type:"symbol",from:{data:"tooltip"},encode:{update:{x:{scale:"xrelscale",field:"argmin.relTime"},y:{scale:"yscale",field:"argmin.y"},size:{value:50},fill:{value:"black"}}}},{type:"group",from:{data:"tooltip"},interactive:!1,name:"tooltipGroup",encode:{update:{x:[{test:"inrange(datum.argmin.relTime + 80, domain('xrelscale'))",scale:"xrelscale",field:"argmin.relTime"},{scale:"xrelscale",field:"argmin.relTime",offset:-80}],y:{scale:"yscale",field:"argmin.y"},height:{value:20},width:{value:80},fill:{value:"#fff"},fillOpacity:{value:.85},stroke:{value:"#aaa"},strokeWidth:{value:.5}}},marks:[{type:"text",interactive:!1,encode:{update:{text:{signal:"format(parent.argmin.relTime, ',.2f') + ': ' + format(parent.argmin.y, ',.2f') + ' ' + parent.argmin.unit"},fill:{value:"black"},fontWeight:{value:"bold"},y:{value:20}}}}]},{type:"rect",name:"boundingRect",interactive:!0,encode:{enter:{width:{signal:"width"},height:{signal:"height"},fill:{value:"transparent"}}}}]}]};function debounce(e,t,n){var a;return function(){var s=this,i=arguments,r=function later(){a=null,n||e.apply(s,i)},o=n&&!a;clearTimeout(a),a=setTimeout(r,t),o&&e.apply(s,i)}}var oe={position:"absolute",top:0,left:0},le=function(e){Object(K.a)(CanGraph,e);var t=Object(W.a)(CanGraph);function CanGraph(e){var n;return Object(y.a)(this,CanGraph),(n=t.call(this,e)).updateBounds=debounce((function(){n.view.signal("width",n.state.bounds.width-90),n.view.signal("height",.4*(n.state.bounds.width-40)),n.view.run()}),100),n.insertData=debounce((function(){if(n.view){var e=n.state.data.series,t=n.view.changeset().remove((function(e){return!0})).insert(e);n.view.change("table",t),n.view.run()}else console.log("Cannot insertData")}),250),n.state={plotInnerStyle:null,shiftX:0,shiftY:0,bounds:null,isDataInserted:!1,data:n.getGraphData(e),spec:n.getGraphSpec(e)},n.onNewView=n.onNewView.bind(Object(Y.a)(n)),n.onSignalClickTime=n.onSignalClickTime.bind(Object(Y.a)(n)),n.onSignalSegment=n.onSignalSegment.bind(Object(Y.a)(n)),n.onDragAnchorMouseDown=n.onDragAnchorMouseDown.bind(Object(Y.a)(n)),n.onDragAnchorMouseUp=n.onDragAnchorMouseUp.bind(Object(Y.a)(n)),n.onDragStart=n.onDragStart.bind(Object(Y.a)(n)),n.onPlotResize=n.onPlotResize.bind(Object(Y.a)(n)),n.insertData=n.insertData.bind(Object(Y.a)(n)),n}return Object(C.a)(CanGraph,[{key:"getGraphData",value:function getGraphData(e){var t=-1,n=-1,a=e.plottedSignals.map((function(a){var s=a.messageId,i=a.signalUid,r=e.messages[s].entries;if(r.length){var o=r[0].relTime;t=-1===t?o:Math.min(t,o),o=r[r.length-1].relTime,n=Math.max(n,o)}return ie._calcGraphData(e.messages[s],i,0)})).reduce((function(e,t){return e.concat(t)}),[]);return{updated:Date.now(),series:a,firstRelTime:t,lastRelTime:n}}},{key:"getGraphSpec",value:function getGraphSpec(e){return Object(te.a)(Object(te.a)({},re),{},{scales:[Object(te.a)(Object(te.a)({},re.scales[0]),{},{domainMin:e.segment[0],domainMax:e.segment[1]})].concat(Object($.a)(re.scales.slice(1)))})}},{key:"segmentIsNew",value:function segmentIsNew(e){var t=this;return e.length!==this.props.segment.length||!e.every((function(e,n){return t.props.segment[n]===e}))}},{key:"visualChanged",value:function visualChanged(e,t){return e.canReceiveGraphDrop!==t.canReceiveGraphDrop||JSON.stringify(e.dragPos)!==JSON.stringify(t.dragPos)}},{key:"onPlotResize",value:function onPlotResize(e){if(this.view){e&&e.bounds?(this.setState({bounds:e.bounds}),e.bounds):this.state.bounds,this.view.runAfter(this.updateBounds)}}},{key:"componentDidUpdate",value:function componentDidUpdate(e){if(this.props.dragPos&&JSON.stringify(e.dragPos)!==JSON.stringify(this.props.dragPos)?this.updateStyleFromDragPos(this.props.dragPos):this.props.dragPos||null===this.state.plotInnerStyle||this.setState({plotInnerStyle:null}),e.messages!==this.props.messages||e.plottedSignal!==this.props.plottedSignal){var t=this.getGraphData(this.props);this.setState({data:t})}this.segmentIsNew(this.props.segment)&&this.setState({spec:this.getGraphSpec(this.props)}),this.view&&(this.props.segment.length>0?this.view.signal("segment",this.props.segment):this.view.signal("segment",0),this.view.signal("videoTime",this.props.currentTime),this.view.runAsync())}},{key:"shouldComponentUpdate",value:function shouldComponentUpdate(e,t){return!this.view||(!(this.props.messages===e.messages&&this.props.plottedSignal===e.plottedSignal&&!this.segmentIsNew(e.segment)&&this.state.spec===t.spec)||(this.state.data!==t.data&&this.insertData(),this.props.currentTime!==e.currentTime&&this.view.signal("videoTime",e.currentTime),this.segmentIsNew(e.segment)&&(e.segment.length>0?this.view.signal("segment",e.segment):this.view.signal("segment",0)),this.view.runAsync(),!1))}},{key:"updateStyleFromDragPos",value:function updateStyleFromDragPos(e){var t=e.left,n=e.top,a=Object(te.a)({},this.state.plotInnerStyle);a.left=t,a.top=n,this.setState({plotInnerStyle:a})}},{key:"onNewView",value:function onNewView(e){this.view=e,this.state.bounds&&this.onPlotResize(),this.props.segment.length>0&&e.signal("segment",this.props.segment),e.signal("videoTime",this.props.currentTime),this.insertData()}},{key:"onSignalClickTime",value:function onSignalClickTime(e,t){void 0!==t&&this.props.onRelativeTimeClick(this.props.messageId,t)}},{key:"onSignalSegment",value:function onSignalSegment(e,t){var n=this;Array.isArray(t)&&(this.props.onSegmentChanged(this.props.messageId,t),this.view&&this.view.runAfter((function(){var e=n.view.getState();e.subcontext[0].signals.brush=0,n.view.setState(e),n.insertData()})))}},{key:"plotInnerStyleFromMouseEvent",value:function plotInnerStyleFromMouseEvent(e){var t=this.state,n=t.shiftX,a=t.shiftY,s=Object(te.a)({},oe),i=this.props.container.getBoundingClientRect(),r=e.clientX-i.left-n,o=e.clientY-i.top-a;return s.left=r,s.top=o,s}},{key:"onDragAnchorMouseDown",value:function onDragAnchorMouseDown(e){var t=this;e.persist();var n=e.clientX-e.target.getBoundingClientRect().left,a=e.clientY-e.target.getBoundingClientRect().top;this.setState({shiftX:n,shiftY:a},(function(){t.setState({plotInnerStyle:t.plotInnerStyleFromMouseEvent(e)})})),this.props.onDragStart(this.props.messageId,this.props.signalSpec.uid,n,a)}},{key:"onDragAnchorMouseUp",value:function onDragAnchorMouseUp(e){this.props.onDragEnd(),this.setState({plotInnerStyle:null,shiftX:0,shiftY:0})}},{key:"onDragStart",value:function onDragStart(e){return e.preventDefault(),!1}},{key:"render",value:function render(){var e=this,t=this.state.plotInnerStyle,n=this.props.canReceiveGraphDrop?"is-droppable":null;return s.a.createElement("div",{className:"cabana-explorer-visuals-plot",ref:this.props.onGraphRefAvailable},s.a.createElement("div",{className:d()("cabana-explorer-visuals-plot-inner",n),style:t||null},s.a.createElement("div",{className:"cabana-explorer-visuals-plot-draganchor",onMouseDown:this.onDragAnchorMouseDown},s.a.createElement("span",{className:"fa fa-bars"})),this.props.plottedSignals.map((function(t){var n=t.messageId,a=t.signalUid,i=t.messageName,r=Object.values(e.props.messages[n].frame.signals).find((function(e){return e.uid===a})),o=r.getColors(n);return s.a.createElement("div",{className:"cabana-explorer-visuals-plot-header",key:"".concat(n,"_").concat(r.uid)},s.a.createElement("div",{className:"cabana-explorer-visuals-plot-header-toggle"},s.a.createElement("button",{className:"button--tiny",onClick:function onClick(){return e.props.unplot(n,a)}},s.a.createElement("span",null,"Hide Plot"))),s.a.createElement("div",{className:"cabana-explorer-visuals-plot-header-copy"},s.a.createElement("div",{className:"cabana-explorer-visuals-plot-message"},s.a.createElement("span",null,i," ",n)),s.a.createElement("div",{className:"cabana-explorer-visuals-plot-signal"},s.a.createElement("div",{className:"cabana-explorer-visuals-plot-signal-color",style:{background:"rgb(".concat(o)}}),s.a.createElement("strong",null,r.name))))})),s.a.createElement(ne.a,{bounds:!0,onResize:this.onPlotResize},(function(t){var n=t.measureRef;return s.a.createElement("div",{ref:n,className:"cabana-explorer-visuals-plot-container"},s.a.createElement(ae.a,{onNewView:e.onNewView,logLevel:1,signalListeners:{clickTime:e.onSignalClickTime,segment:e.onSignalSegment},renderer:"canvas",spec:e.state.spec,actions:!1,data:{table:e.state.data.series}}))}))))}}]),CanGraph}(a.Component);le.emptyTable=[];var ce=function(e){Object(K.a)(CanGraphList,e);var t=Object(W.a)(CanGraphList);function CanGraphList(e){var n;return Object(y.a)(this,CanGraphList),(n=t.call(this,e)).state={draggingSignal:{},dragPos:null,dragShift:null,graphToReceiveDrop:null},n.plotListRef=s.a.createRef(),n.plotRefs=[],n.renderSignalPlot=n.renderSignalPlot.bind(Object(Y.a)(n)),n.onGraphDragStart=n.onGraphDragStart.bind(Object(Y.a)(n)),n.onGraphDragEnd=n.onGraphDragEnd.bind(Object(Y.a)(n)),n.onMouseMove=n.onMouseMove.bind(Object(Y.a)(n)),n}return Object(C.a)(CanGraphList,[{key:"onGraphDragStart",value:function onGraphDragStart(e,t,n,a){this.setState({draggingSignal:{messageId:e,signalUid:t},dragShift:{x:n,y:a}})}},{key:"determineDraggingGraph",value:function determineDraggingGraph(){var e=this.state.draggingSignal;return this.plotRefs.find((function(t){var n=t.messageId,a=t.signalUid;return e.messageId===n&&e.signalUid===a}))}},{key:"onMouseMove",value:function onMouseMove(e){var t=this.state.dragShift;if(null!==t){var n=this.plotListRef.current.getBoundingClientRect(),a=this.determineDraggingGraph();if(a){a.ref.hidden=!0;var s=document.elementFromPoint(e.clientX,e.clientY);a.ref.hidden=!1;var i=s.closest(".cabana-explorer-visuals-plot"),r=this.plotRefs.find((function(e){var t=e.ref,n=e.messageId,s=e.signalUid;return!(n===a.messageId&&s===a.signalUid)&&t.isEqualNode(i)}));r?this.setState({graphToReceiveDrop:r}):this.setState({graphToReceiveDrop:null})}var o=e.clientX-n.left-t.x,l=e.clientY-n.top-t.y;this.setState({dragPos:{left:o,top:l}})}else null!==this.state.graphToReceiveDrop&&this.setState({graphToReceiveDrop:null})}},{key:"onGraphDragEnd",value:function onGraphDragEnd(){null!==this.state.graphToReceiveDrop&&this.props.mergePlots({fromPlot:this.state.draggingSignal,toPlot:this.state.graphToReceiveDrop}),this.setState({draggingSignal:{},dragShift:null,dragPos:null,graphToReceiveDrop:null})}},{key:"addCanGraphRef",value:function addCanGraphRef(e,t,n){if(e){var a=this.plotRefs;a=a.filter((function(e){return!(e.messageId===t&&e.signalUid===n)})).concat([{messageId:t,signalUid:n,ref:e}]),this.plotRefs=a}}},{key:"renderSignalPlot",value:function renderSignalPlot(e,t){var n=this,a=this.state,i=a.draggingSignal,r=a.graphToReceiveDrop,o=e[0],l=o.messageId,c=o.signalUid,d=this.props.messages[l];if(!this.plotListRef.current||!d)return[];var u=Object.values(d.frame.signals).find((function(e){return e.uid===c}));if(!u)return null;var g=i.signalUid===c&&i.messageId===l,h=r&&r.signalUid===c&&r.messageId===l,m=(e=e.map((function(e){return Object(te.a)({messageName:n.props.messages[e.messageId].frame.name},e)}))).reduce((function(e,t){var n=t.messageId,a=t.signalUid;return"".concat(e+n,"_").concat(a)}),"");return s.a.createElement(le,{onGraphRefAvailable:function onGraphRefAvailable(e){n.addCanGraphRef(e,l,c)},key:m,unplot:this.props.onSignalUnplotPressed,messages:this.props.messages,messageId:l,messageName:d.frame?d.frame.name:null,signalSpec:Object.assign(Object.create(u),u),onSegmentChanged:this.props.onSegmentChanged,segment:this.props.segment,onRelativeTimeClick:this.props.onGraphTimeClick,currentTime:this.props.seekTime,onDragStart:this.onGraphDragStart,onDragEnd:this.onGraphDragEnd,container:this.plotListRef.current,dragPos:g?this.state.dragPos:null,canReceiveGraphDrop:h,plottedSignals:e,live:this.props.live})}},{key:"render",value:function render(){return s.a.createElement("div",{className:"cabana-explorer-visuals-plots",ref:this.plotListRef,onMouseMove:this.onMouseMove,onMouseLeave:this.onGraphDragEnd,onMouseUp:this.onGraphDragEnd},this.props.plottedSignals.map(this.renderSignalPlot))}}]),CanGraphList}(a.Component),de=n(47),ue=n(83),ge=n.n(ue),he=function(e){Object(K.a)(HLS,e);var t=Object(W.a)(HLS);function HLS(){var e;Object(y.a)(this,HLS);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).onSeeking=function(){e.props.playing||(e.props.onLoadStart(),e.props.onPlaySeek(e.videoElement.currentTime))},e.shouldInitVideoTime=!0,e.onSeeked=function(){e.props.playing||e.props.onLoadEnd()},e.onLoadedData=function(){e.shouldInitVideoTime&&(e.videoElement.currentTime=e.props.startTime,e.shouldInitVideoTime=!1)},e}return Object(C.a)(HLS,[{key:"componentDidUpdate",value:function componentDidUpdate(e){this.videoElement.playbackRate=this.props.playbackSpeed,e.source!==this.props.source&&this.loadSource(this.props.source),this.props.playing?this.videoElement&&(this.videoElement.paused||this.videoElement.currentTime<.01)&&this.videoElement.play():this.videoElement.pause()}},{key:"componentDidMount",value:function componentDidMount(){var e=this;this.player=new ge.a({enableWorker:!1,disablePtsDtsCorrectionInMp4Remux:!1}),this.player.on(ge.a.Events.ERROR,(function(t,n){if(n.fatal)switch(n.type){case ge.a.ErrorTypes.NETWORK_ERROR:console.log("fatal network error encountered, try to recover"),e.player.startLoad();break;case ge.a.ErrorTypes.MEDIA_ERROR:console.log("fatal media error encountered, try to recover"),e.player.recoverMediaError();break;default:e.player.destroy(),e.player=null}})),this.loadSource()}},{key:"loadSource",value:function loadSource(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props.source;this.videoElement&&(this.player.loadSource(e),this.player.attachMedia(this.videoElement),this.props.onVideoElementAvailable(this.videoElement))}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.player&&(this.player.destroy(),this.player=null)}},{key:"render",value:function render(){var e=this;return s.a.createElement("div",{className:"cabana-explorer-visuals-camera-wrapper",onClick:this.props.onClick},s.a.createElement("video",{ref:function ref(t){e.videoElement=t},autoPlay:this.props.playing,muted:!0,onWaiting:this.props.onLoadStart,onPlaying:this.props.onLoadEnd,onSeeking:this.onSeeking,onSeeked:this.onSeeked,onLoadedData:this.onLoadedData}))}}]),HLS}(a.Component),me=function(e){Object(K.a)(PlayButton,e);var t=Object(W.a)(PlayButton);function PlayButton(e){var n;return Object(y.a)(this,PlayButton),(n=t.call(this,e)).state={hover:!1},n.onClick=n.onClick.bind(Object(Y.a)(n)),n}return Object(C.a)(PlayButton,[{key:"imageSource",value:function imageSource(){var e=this.state.hover,t=this.props.isPlaying;return"".concat("",t?e?"/img/ic_pause_circle_filled_white_24px.svg":"/img/ic_pause_circle_outline_white_24px.svg":e?"/img/ic_play_circle_filled_white_24px.svg":"/img/ic_play_circle_outline_white_24px.svg")}},{key:"onClick",value:function onClick(e){this.props.isPlaying?this.props.onPause():this.props.onPlay()}},{key:"render",value:function render(){var e=this;return s.a.createElement("img",{src:this.imageSource(),alt:this.props.isPlaying?"Pause":"Play",className:this.props.className,onClick:this.onClick,onMouseOver:function onMouseOver(){return e.setState({hover:!0})},onMouseLeave:function onMouseLeave(){return e.setState({hover:!1})}})}}]),PlayButton}(a.Component),pe=function(e){Object(K.a)(RouteSeeker,e);var t=Object(W.a)(RouteSeeker);function RouteSeeker(e){var n;return Object(y.a)(this,RouteSeeker),(n=t.call(this,e)).updateDraggingSeek=debounce((function(e){return n.props.onUserSeek(e)}),250),n.state={seekedBarStyle:RouteSeeker.zeroSeekedBarStyle,markerStyle:RouteSeeker.hiddenMarkerStyle,tooltipStyle:RouteSeeker.hiddenTooltipStyle,ratio:0,tooltipTime:"0:00",isPlaying:!1,isDragging:!1},n.onMouseMove=n.onMouseMove.bind(Object(Y.a)(n)),n.onMouseLeave=n.onMouseLeave.bind(Object(Y.a)(n)),n.onMouseDown=n.onMouseDown.bind(Object(Y.a)(n)),n.onMouseUp=n.onMouseUp.bind(Object(Y.a)(n)),n.onClick=n.onClick.bind(Object(Y.a)(n)),n.onPlay=n.onPlay.bind(Object(Y.a)(n)),n.onPause=n.onPause.bind(Object(Y.a)(n)),n.executePlayTimer=n.executePlayTimer.bind(Object(Y.a)(n)),n}return Object(C.a)(RouteSeeker,[{key:"componentDidUpdate",value:function componentDidUpdate(e){if(JSON.stringify(e.segmentIndices)!==JSON.stringify(this.props.segmentIndices))this.setState({seekedBarStyle:RouteSeeker.zeroSeekedBarStyle,markerStyle:RouteSeeker.hiddenMarkerStyle,ratio:0});else if(this.props.videoLength&&e.videoLength!==this.props.videoLength){var t=this.state.ratio*e.videoLength/this.props.videoLength;this.updateSeekedBar(t)}if(e.nearestFrameTime!==this.props.nearestFrameTime){var n=this.props.segmentProgress(this.props.nearestFrameTime);this.updateSeekedBar(n)}e.playing!==this.props.isPlaying&&(this.props.playing&&!this.state.isPlaying?this.onPlay():!this.props.playing&&this.state.isPlaying&&this.onPause())}},{key:"componentWillUnmount",value:function componentWillUnmount(){window.cancelAnimationFrame(this.playTimer)}},{key:"mouseEventXOffsetPercent",value:function mouseEventXOffsetPercent(e){var t=this.progressBar.getBoundingClientRect();return(e.clientX-t.left)/this.progressBar.offsetWidth*100}},{key:"onMouseMove",value:function onMouseMove(e){var t=this.mouseEventXOffsetPercent(e);if(t<0)this.onMouseLeave();else{var n=RouteSeeker.markerWidth,a={display:"",left:"calc(".concat(t,"% - ").concat(n/2,"px)")},s=RouteSeeker.tooltipWidth,i={display:"flex",left:"calc(".concat(t,"% - ").concat(s/2,"px)")},r=Math.max(0,t/100);this.state.isDragging&&(this.updateSeekedBar(r),this.updateDraggingSeek(r)),this.setState({markerStyle:a,tooltipStyle:i,tooltipTime:this.props.ratioTime(r).toFixed(3)})}}},{key:"onMouseLeave",value:function onMouseLeave(e){this.setState({markerStyle:RouteSeeker.hiddenMarkerStyle,tooltipStyle:RouteSeeker.hiddenTooltipStyle,isDragging:!1})}},{key:"updateSeekedBar",value:function updateSeekedBar(e){var t={width:"".concat(100*e,"%")};this.setState({seekedBarStyle:t,ratio:e})}},{key:"onClick",value:function onClick(e){var t=this.mouseEventXOffsetPercent(e)/100;t=Math.min(1,Math.max(0,t)),this.updateSeekedBar(t),this.props.onUserSeek(t)}},{key:"onPlay",value:function onPlay(){this.playTimer=window.requestAnimationFrame(this.executePlayTimer);var e=this.state.ratio;e>=1&&(e=0),this.setState({isPlaying:!0,ratio:e}),this.props.onPlay()}},{key:"executePlayTimer",value:function executePlayTimer(){var e=this.props.videoElement;if(null!==e){var t=this.props,n=t.videoLength,a=t.startTime,s=e.currentTime,i=((s=roundTime(s))-(a=roundTime(a)))/(n=roundTime(n));i!==this.state.ratio?(i>=1&&this.props.segment&&this.props.segment.length||i<0?(i=0,s=a,this.props.onUserSeek(i)):i>=1&&(e.pause(),this.onPause()),i>=0&&(this.updateSeekedBar(i),this.props.onPlaySeek(s)),this.playTimer=window.requestAnimationFrame(this.executePlayTimer)):this.playTimer=window.requestAnimationFrame(this.executePlayTimer)}else this.playTimer=window.requestAnimationFrame(this.executePlayTimer)}},{key:"onPause",value:function onPause(){window.cancelAnimationFrame(this.playTimer),this.setState({isPlaying:!1}),this.props.onPause()}},{key:"onMouseDown",value:function onMouseDown(){this.state.isDragging||this.setState({isDragging:!0})}},{key:"onMouseUp",value:function onMouseUp(){this.state.isDragging&&this.setState({isDragging:!1})}},{key:"render",value:function render(){var e=this,t=this.state,n=t.seekedBarStyle,a=t.markerStyle,i=t.tooltipStyle;return s.a.createElement("div",{className:"cabana-explorer-visuals-camera-seeker"},s.a.createElement(me,{className:"cabana-explorer-visuals-camera-seeker-playbutton",onPlay:this.onPlay,onPause:this.onPause,isPlaying:this.state.isPlaying}),s.a.createElement("div",{className:"cabana-explorer-visuals-camera-seeker-progress",onMouseMove:this.onMouseMove,onMouseLeave:this.onMouseLeave,onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onClick:this.onClick,ref:function ref(t){return e.progressBar=t}},s.a.createElement("div",{className:"cabana-explorer-visuals-camera-seeker-progress-tooltip",style:i},this.state.tooltipTime),s.a.createElement("div",{className:"cabana-explorer-visuals-camera-seeker-progress-marker",style:a}),s.a.createElement("div",{className:"cabana-explorer-visuals-camera-seeker-progress-inner",style:n})))}}]),RouteSeeker}(a.Component);function roundTime(e){return Math.round(1e3*e)/1e3}pe.hiddenMarkerStyle={display:"none",left:0},pe.zeroSeekedBarStyle={width:0},pe.hiddenTooltipStyle={display:"none",left:0},pe.markerWidth=20,pe.tooltipWidth=50;var Se=de.StyleSheet.create({loadingOverlay:{position:"absolute",top:0,left:0,width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",zIndex:3},loadingSpinner:{width:"25%",height:"25%",display:"block"},img:{height:480,display:"block",position:"absolute",zIndex:2},hls:{zIndex:1,height:480,backgroundColor:"rgba(0,0,0,0.9)"},seekBar:{position:"absolute",bottom:0,left:0,width:"100%",zIndex:4}}),fe=function(e){Object(K.a)(RouteVideoSync,e);var t=Object(W.a)(RouteVideoSync);function RouteVideoSync(e){var n;return Object(y.a)(this,RouteVideoSync),(n=t.call(this,e)).state={isLoading:!0,videoElement:null,source:null},n.onLoadStart=n.onLoadStart.bind(Object(Y.a)(n)),n.onLoadEnd=n.onLoadEnd.bind(Object(Y.a)(n)),n.segmentProgress=n.segmentProgress.bind(Object(Y.a)(n)),n.onVideoElementAvailable=n.onVideoElementAvailable.bind(Object(Y.a)(n)),n.onUserSeek=n.onUserSeek.bind(Object(Y.a)(n)),n.onPlaySeek=n.onPlaySeek.bind(Object(Y.a)(n)),n.ratioTime=n.ratioTime.bind(Object(Y.a)(n)),n}return Object(C.a)(RouteVideoSync,[{key:"componentDidMount",value:function componentDidMount(){this.componentDidUpdate({},{})}},{key:"componentDidUpdate",value:function componentDidUpdate(e){var t,n=this.props,a=n.userSeekTime,s=n.route,i=n.share,r=this.state.videoElement;if(e.userSeekTime&&a!==e.userSeekTime&&r&&(r.currentTime=a-this.props.videoOffset),s&&((null===(t=e.route)||void 0===t?void 0:t.fullname)!==s.fullname||e.share!==i)){var o=S.video.getQcameraStreamUrl(s.fullname,null===i||void 0===i?void 0:i.exp,null===i||void 0===i?void 0:i.sig);this.setState({source:o})}}},{key:"onVideoElementAvailable",value:function onVideoElementAvailable(e){this.setState({videoElement:e})}},{key:"onUserSeek",value:function onUserSeek(e){var t=this.state.videoElement,onUserSeek=this.props.onUserSeek,n=this.ratioTime(e);Number.isNaN(t.duration)||(t.currentTime=n-this.props.videoOffset,0!==e&&function funcSeekToRatio(){onUserSeek(n)}())}},{key:"onPlaySeek",value:function onPlaySeek(e){this.seekTime=e+this.props.videoOffset,this.props.onPlaySeek(this.seekTime)}},{key:"onLoadStart",value:function onLoadStart(){this.setState({isLoading:!0})}},{key:"onLoadEnd",value:function onLoadEnd(){this.setState({isLoading:!1})}},{key:"loadingOverlay",value:function loadingOverlay(){return s.a.createElement("div",{className:Object(de.css)(Se.loadingOverlay)},s.a.createElement("img",{className:Object(de.css)(Se.loadingSpinner),src:"".concat("","/img/loading.svg"),alt:"Loading video"}))}},{key:"videoLength",value:function videoLength(){return this.props.segment.length?this.props.segment[1]-this.props.segment[0]:this.state.videoElement?this.state.videoElement.duration:0}},{key:"startTime",value:function startTime(){return this.props.segment.length?this.props.segment[0]:0}},{key:"segmentProgress",value:function segmentProgress(e){var t=this.startTime();e<t&&(e=t);var n=(e-t)/this.videoLength();return Math.max(0,Math.min(1,n))}},{key:"ratioTime",value:function ratioTime(e){return e*this.videoLength()+this.startTime()}},{key:"render",value:function render(){var e=this.state,t=e.isLoading,n=e.videoElement,a=this.props,i=a.userSeekTime,r=a.playSpeed,o=a.playing,l=a.onVideoClick,c=a.segmentIndices,d=a.startTime,u=a.segment;return s.a.createElement("div",{className:"cabana-explorer-visuals-camera"},t?this.loadingOverlay():null,this.state.source&&s.a.createElement(he,{className:Object(de.css)(Se.hls),source:this.state.source,startTime:(d||0)-this.props.videoOffset,videoLength:this.videoLength(),playbackSpeed:r,onVideoElementAvailable:this.onVideoElementAvailable,playing:o,onClick:l,onLoadStart:this.onLoadStart,onLoadEnd:this.onLoadEnd,onUserSeek:this.onUserSeek,onPlaySeek:this.onPlaySeek}),s.a.createElement(pe,{className:Object(de.css)(Se.seekBar),nearestFrameTime:i,segmentProgress:this.segmentProgress,startTime:this.startTime()-this.props.videoOffset,videoLength:this.videoLength(),segmentIndices:c,onUserSeek:this.onUserSeek,onPlaySeek:this.onPlaySeek,videoElement:n,onPlay:this.props.onPlay,onPause:this.props.onPause,playing:this.props.playing,ratioTime:this.ratioTime,segment:u}))}}]),RouteVideoSync}(a.Component),be=n(245),ve=n.n(be),_e=function(e){Object(K.a)(CanLog,e);var t=Object(W.a)(CanLog);function CanLog(e){var n;return Object(y.a)(this,CanLog),(n=t.call(this,e)).state={length:0,expandedMessages:[],messageHeights:[],allPacketsExpanded:!1},n.renderLogListItemMessage=n.renderLogListItemMessage.bind(Object(Y.a)(n)),n.addDisplayedMessages=n.addDisplayedMessages.bind(Object(Y.a)(n)),n.renderLogListItem=n.renderLogListItem.bind(Object(Y.a)(n)),n.renderLogList=n.renderLogList.bind(Object(Y.a)(n)),n.onExpandAllChanged=n.onExpandAllChanged.bind(Object(Y.a)(n)),n.toggleExpandAllPackets=n.toggleExpandAllPackets.bind(Object(Y.a)(n)),n.toggleSignalPlot=n.toggleSignalPlot.bind(Object(Y.a)(n)),n}return Object(C.a)(CanLog,[{key:"componentDidUpdate",value:function componentDidUpdate(e){!e.message&&this.props.message&&this.addDisplayedMessages()}},{key:"shouldComponentUpdate",value:function shouldComponentUpdate(e,t){var n=this.props.message?this.props.message.entries.length:0,a=e.message?e.message.entries.length:0;return this.props.message!==e.message||a!==n||e.messageIndex!==this.props.messageIndex||e.plottedSignals.length!==this.props.plottedSignals.length||JSON.stringify(e.segmentIndices)!==JSON.stringify(this.props.segmentIndices)||JSON.stringify(t)!==JSON.stringify(this.state)||this.props.message!==e.message||void 0!==this.props.message&&void 0!==e.message&&void 0!==this.props.message.frame&&void 0!==e.message.frame&&JSON.stringify(this.props.message.frame)!==JSON.stringify(e.message.frame)}},{key:"addDisplayedMessages",value:function addDisplayedMessages(){var e=this.state.length+CanLog.ITEMS_PER_PAGE;this.setState({length:e})}},{key:"expandMessage",value:function expandMessage(e,t){this.setState({expandedMessages:this.state.expandedMessages.concat([e.time])}),this.props.onMessageExpanded()}},{key:"collapseMessage",value:function collapseMessage(e,t){this.setState({expandedMessages:this.state.expandedMessages.filter((function(t){return t!==e.time}))})}},{key:"isSignalPlotted",value:function isSignalPlotted(e,t){return void 0!==this.props.plottedSignals.find((function(n){return n.some((function(n){return n.messageId===e&&n.signalUid===t}))}))}},{key:"signalValuePretty",value:function signalValuePretty(e,t){return e.isFloat?t.toFixed(3):"bigint"===typeof t?t.toString():t}},{key:"isMessageExpanded",value:function isMessageExpanded(e){return-1!==this.state.expandedMessages.indexOf(e.time)}},{key:"toggleSignalPlot",value:function toggleSignalPlot(e,t,n){n?this.props.onSignalUnplotPressed(e,t):this.props.onSignalPlotPressed(e,t)}},{key:"toggleExpandPacketSignals",value:function toggleExpandPacketSignals(e){if(this.props.message.frame){var t=this.state.allPacketsExpanded||this.isMessageExpanded(e),n=Object.keys(this.props.message.frame.signals).length>0;t&&n?this.setState({expandedMessages:this.state.expandedMessages.filter((function(t){return t!==e.time}))}):n&&(this.setState({expandedMessages:this.state.expandedMessages.concat([e.time])}),this.props.onMessageExpanded())}}},{key:"renderLogListItemSignals",value:function renderLogListItemSignals(e){var t=this,n=this.props.message;return s.a.createElement("div",{className:"signals-log-list-signals"},Object.entries(e.signals).map((function(e){var a=Object(_.a)(e,2),i=a[0],r=a[1],o=n.frame.signals[i];if(void 0===o)return null;var l=o.unit.length>0?o.unit:"units",c=t.isSignalPlotted(n.id,o.uid),u=c?null:"button--alpha",g=c?"Hide Plot":"Show Plot";return s.a.createElement("div",{key:i,className:"signals-log-list-signal"},s.a.createElement("div",{className:"signals-log-list-signal-message"},s.a.createElement("span",null,i)),s.a.createElement("div",{className:"signals-log-list-signal-value"},s.a.createElement("span",null,"(",s.a.createElement("strong",null,t.signalValuePretty(o,r))," ",l,")")),s.a.createElement("div",{className:"signals-log-list-signal-action",onClick:function onClick(){t.toggleSignalPlot(n.id,o.uid,c)}},s.a.createElement("button",{className:d()("button--tiny",u)},s.a.createElement("span",null,g))))})))}},{key:"renderLogListItemMessage",value:function renderLogListItemMessage(e,t){for(var n=this,a=this.props.message,i=this.state.allPacketsExpanded||this.isMessageExpanded(e),r=Object.keys(e.signals).length>0?"has-signals":null,o=i?"is-expanded":null,l=[],c=0;c<e.data.length;c+=8)l.push(e.hexData.substring(2*c,2*Math.min(c+8,e.data.length)));return s.a.createElement("div",{key:t,className:d()("signals-log-list-item",r,o)},s.a.createElement("div",{className:"signals-log-list-item-header",onClick:function onClick(){n.toggleExpandPacketSignals(e)}},s.a.createElement("div",{className:"signals-log-list-message"},s.a.createElement("strong",null,(a.frame?a.frame.name:null)||a.id)),s.a.createElement("div",{className:"signals-log-list-time"},s.a.createElement("span",null,"[",e.relTime.toFixed(3),"]")),s.a.createElement("div",{className:"signals-log-list-bytes"},l.map((function(e,t){return s.a.createElement("span",{key:t,className:"t-mono"},e)})))),s.a.createElement("div",{className:"signals-log-list-item-body"},i?this.renderLogListItemSignals(e):null))}},{key:"renderLogListItem",value:function renderLogListItem(e,t){var n=this.props.messageIndex;return 0===n&&2===this.props.segmentIndices.length&&(n=this.props.segmentIndices[0]),n+e<this.props.message.entries.length?this.renderLogListItemMessage(this.props.message.entries[n+e],t):null}},{key:"renderLogList",value:function renderLogList(e,t){return s.a.createElement("div",{className:"signals-log-list"},s.a.createElement("div",{className:"signals-log-list-header"},s.a.createElement("div",{className:"signals-log-list-message"},"Message"),s.a.createElement("div",{className:"signals-log-list-time"},"Time"),s.a.createElement("div",{className:"signals-log-list-bytes"},"Bytes")),s.a.createElement("div",{className:"signals-log-list-items",ref:t},e))}},{key:"listLength",value:function listLength(){var e=this.props,t=e.segmentIndices,n=e.messageIndex;return n>0?this.props.message.entries.length-n:2===t.length?t[1]-t[0]:this.props.message?this.props.message.entries.length:0}},{key:"onExpandAllChanged",value:function onExpandAllChanged(e){this.setState({allPacketsExpanded:e.target.checked})}},{key:"toggleExpandAllPackets",value:function toggleExpandAllPackets(){this.setState({allPacketsExpanded:!this.state.allPacketsExpanded})}},{key:"render",value:function render(){var e=this.state.allPacketsExpanded?"Collapse All":"Expand All",t=this.state.allPacketsExpanded?null:"button--alpha";return s.a.createElement("div",{className:"cabana-explorer-signals-log"},s.a.createElement("div",{className:"cabana-explorer-signals-log-header"},s.a.createElement("strong",null,"Message Packets"),s.a.createElement("button",{className:d()("button--tiny",t),onClick:this.toggleExpandAllPackets},e)),s.a.createElement("div",{className:"cabana-explorer-signals-log-body"},s.a.createElement(ve.a,{itemRenderer:this.renderLogListItem,itemsRenderer:this.renderLogList,length:this.listLength(),pageSize:50,updateWhenThisValueChanges:this.props.messageIndex,type:"variable"})))}}]),CanLog}(a.Component);function findTimeIndex(e,t){return e.findIndex((function(e){return e.time>=t}))}function findRelativeTimeIndex(e,t){return e.findIndex((function(e){return e.relTime>=t}))}_e.ITEMS_PER_PAGE=50;var Ee={findTimeIndex:findTimeIndex,findRelativeTimeIndex:findRelativeTimeIndex,findSegmentIndices:function findSegmentIndices(e,t,n){var a=Object(_.a)(t,2),s=a[0],i=a[1],r=!0===n?findRelativeTimeIndex:findTimeIndex,o=Math.max(0,r(e,s)),l=r(e.slice(o),i),c=l>=0?l+o+1:e.length-1;return[o,Math.max(0,Math.min(c,e.length-1))]}},ye=function(e){Object(K.a)(PlaySpeedSelector,e);var t=Object(W.a)(PlaySpeedSelector);function PlaySpeedSelector(e){var n;return Object(y.a)(this,PlaySpeedSelector),(n=t.call(this,e)).onChange=n.onChange.bind(Object(Y.a)(n)),n}return Object(C.a)(PlaySpeedSelector,[{key:"onChange",value:function onChange(e){this.props.onPlaySpeedChanged&&this.props.onPlaySpeedChanged(Number(e.currentTarget.value))}},{key:"render",value:function render(){return s.a.createElement("div",{style:{display:"inline-block",float:"right",margin:10}},s.a.createElement("label",null,"Play speed:\xa0"),s.a.createElement("select",{id:"playSpeed",style:{width:70},onChange:this.onChange,value:this.props.playSpeed},s.a.createElement("option",{value:"0.1"},"0.1x"),s.a.createElement("option",{value:"0.5"},"0.5x"),s.a.createElement("option",{value:"1"},"1x"),s.a.createElement("option",{value:"2"},"2x")))}}]),PlaySpeedSelector}(a.Component);function clipSegment(e,t,n){var a=e,s=t;if(2===a.length){var i=n.entries.findIndex((function(e){return e.relTime>=a[0]})),r=n.entries.findIndex((function(e){return e.relTime>=a[1]}));if(-1!==i){-1===r&&(r=n.entries.length-1);var o=n.entries[i].relTime,l=n.entries[r].relTime;a=[o,l],s=[i,r]}else a=[],s=[]}return{segment:a,segmentIndices:s}}var Ce=function(e){Object(K.a)(Explorer,e);var t=Object(W.a)(Explorer);function Explorer(e){var n;return Object(y.a)(this,Explorer),(n=t.call(this,e)).updateSegment=debounce((function(e,t){var a=t,s=n.props,i=s.messages,r=s.selectedMessage,o=s.currentParts,l=i[r].entries,c=Ee.findSegmentIndices(l,a,!0);a[0]===60*o[0]&&a[1]===60*(o[1]+1)&&(a=[],c=[]);var d=n.state.userSeekTime;a.length?(d=Math.max(a[0],d),d=Math.min(a[1],d)):(d=Math.max(60*o[0],d),d=Math.min(60*o[1],d)),n.setState({segment:a,segmentIndices:c,userSeekIndex:c[0],userSeekTime:d})}),250),n.state={plottedSignals:[],segment:e.startSegments||[],segmentIndices:[],shouldShowAddSignal:!0,userSeekIndex:0,userSeekTime:0,playing:e.autoplay,playSpeed:1},n.onSignalPlotPressed=n.onSignalPlotPressed.bind(Object(Y.a)(n)),n.onSignalUnplotPressed=n.onSignalUnplotPressed.bind(Object(Y.a)(n)),n.onSegmentChanged=n.onSegmentChanged.bind(Object(Y.a)(n)),n.showAddSignal=n.showAddSignal.bind(Object(Y.a)(n)),n.onGraphTimeClick=n.onGraphTimeClick.bind(Object(Y.a)(n)),n.onUserSeek=n.onUserSeek.bind(Object(Y.a)(n)),n.onPlaySeek=n.onPlaySeek.bind(Object(Y.a)(n)),n.onPlay=n.onPlay.bind(Object(Y.a)(n)),n.onPause=n.onPause.bind(Object(Y.a)(n)),n.onVideoClick=n.onVideoClick.bind(Object(Y.a)(n)),n.onSignalPlotChange=n.onSignalPlotChange.bind(Object(Y.a)(n)),n.onKeyDown=n.onKeyDown.bind(Object(Y.a)(n)),n.mergePlots=n.mergePlots.bind(Object(Y.a)(n)),n.toggleShouldShowAddSignal=n.toggleShouldShowAddSignal.bind(Object(Y.a)(n)),n.changePlaySpeed=n.changePlaySpeed.bind(Object(Y.a)(n)),n}return Object(C.a)(Explorer,[{key:"componentDidMount",value:function componentDidMount(){document.addEventListener("keydown",this.onKeyDown)}},{key:"componentWillUnmount",value:function componentWillUnmount(){document.removeEventListener("keydown",this.onKeyDown)}},{key:"onKeyDown",value:function onKeyDown(e){27===e.keyCode&&this.resetSegment()}},{key:"componentDidUpdate",value:function componentDidUpdate(e){var t=this,n=e.messages[e.selectedMessage],a=this.props.messages[this.props.selectedMessage];0===Object.keys(e.messages).length&&0!==Object.keys(this.props.messages).length&&this.resetSegment(),a&&a.frame&&n!==a&&0===Object.keys(a.frame.signals).length&&this.setState({shouldShowAddSignal:!0});var s=this.state.plottedSignals.map((function(e){return e.filter((function(e){var n=e.messageId,a=e.signalUid,s=Boolean(t.props.messages[n]),i=!0;return s&&(i=Object.values(t.props.messages[n].frame.signals).some((function(e){return e.uid===a}))),s&&i}))})).filter((function(e){return e.length>0}));if(this.state.plottedSignals.length!==s.length&&this.setState({plottedSignals:s}),this.props.selectedMessage&&e.selectedMessage!==this.props.selectedMessage){var i=clipSegment(this.state.segment,this.state.segmentIndices,a),r=i.segment,o=i.segmentIndices;this.setState({segment:r,segmentIndices:o,userSeekIndex:this.props.seekIndex})}if(n&&a&&n.entries.length!==a.entries.length){var l=clipSegment(this.state.segment,this.state.segmentIndices,a),c=l.segment,d=l.segmentIndices;this.setState({segment:c,segmentIndices:d})}}},{key:"changePlaySpeed",value:function changePlaySpeed(e){this.setState({playSpeed:e})}},{key:"timeWindow",value:function timeWindow(){var e=this.props,t=e.routeStartTime,n=e.currentParts;if(t){var a=60*n[0],s=60*(n[1]+1),i=t.clone().add(a,"s").format("HH:mm:ss"),r=t.clone().add(s,"s").format("HH:mm:ss");return"".concat(i," - ").concat(r)}return""}},{key:"onSignalPlotPressed",value:function onSignalPlotPressed(e,t){var n=this.state.plottedSignals;n=[[{messageId:e,signalUid:t}]].concat(Object($.a)(n)),this.setState({plottedSignals:n})}},{key:"onSignalUnplotPressed",value:function onSignalUnplotPressed(e,t){var n=this.state.plottedSignals.map((function(n){return n.filter((function(n){return!(n.messageId===e&&n.signalUid===t)}))})).filter((function(e){return e.length>0}));this.setState({plottedSignals:n})}},{key:"onSegmentChanged",value:function onSegmentChanged(e,t){Array.isArray(t)&&this.updateSegment(e,t)}},{key:"resetSegment",value:function resetSegment(){var e=this.state,t=e.segment,n=e.segmentIndices;(t.length>0||n.length>0)&&this.setState({segment:[],segmentIndices:[],userSeekIndex:0})}},{key:"showAddSignal",value:function showAddSignal(){this.setState({shouldShowAddSignal:!0})}},{key:"toggleShouldShowAddSignal",value:function toggleShouldShowAddSignal(){this.setState({shouldShowAddSignal:!this.state.shouldShowAddSignal})}},{key:"indexFromSeekTime",value:function indexFromSeekTime(e){var t=this.props.messages[this.props.selectedMessage].entries;if(0===t.length)return null;var n=this.state.segmentIndices;if(2===n.length&&n[0]>=0){for(var a=n[0],s=Math.min(t.length-1,n[1]);a<=s;a++)if(t[a].relTime>=e)return a;return n[1]}for(var i=0;i<t.length;i++)if(t[i].relTime>=e)return i;return t.length-1}},{key:"onUserSeek",value:function onUserSeek(e){this.props.onUserSeek(e),this.setState({userSeekTime:e})}},{key:"onPlaySeek",value:function onPlaySeek(e){var t=this.props.messages[this.props.selectedMessage];if(t&&0!==t.entries.length){var n=this.indexFromSeekTime(e),a=e;this.props.onSeek(n,a)}else this.props.onSeek(0,e)}},{key:"onGraphTimeClick",value:function onGraphTimeClick(e,t){this.onUserSeek(t)}},{key:"onPlay",value:function onPlay(){this.setState({playing:!0})}},{key:"onPause",value:function onPause(){this.setState({playing:!1})}},{key:"secondsLoadedRouteRelative",value:function secondsLoadedRouteRelative(e){return 60*(e[1]-e[0]+1)}},{key:"secondsLoaded",value:function secondsLoaded(){return 60*this.props.partsCount}},{key:"onVideoClick",value:function onVideoClick(){var e=!this.state.playing;this.setState({playing:e})}},{key:"seekTime",value:function seekTime(){var e=this.state.userSeekIndex;return this.props.messages[this.props.selectedMessage].entries[e].time}},{key:"onSignalPlotChange",value:function onSignalPlotChange(e,t,n){e?this.onSignalPlotPressed(t,n):this.onSignalUnplotPressed(t,n)}},{key:"renderSelectMessagePrompt",value:function renderSelectMessagePrompt(){return s.a.createElement("div",{className:"cabana-explorer-select-prompt"},s.a.createElement("h1",null,"Select a message"))}},{key:"selectedMessagePlottedSignalUids",value:function selectedMessagePlottedSignalUids(){var e=this;return this.state.plottedSignals.map((function(t){return t.filter((function(t){var n=t.messageId;t.signalUid;return n===e.props.selectedMessage})).map((function(e){return e.signalUid}))})).reduce((function(e,t){return e.concat(t)}),[])}},{key:"renderExplorerSignals",value:function renderExplorerSignals(){var e=this,t=this.props.selectedMessage,n=this.props.messages[t],a=void 0!==n.frame?n.frame.name:"undefined";return s.a.createElement("div",{className:"cabana-explorer-signals-wrapper"},s.a.createElement("div",{className:"cabana-explorer-signals-header"},s.a.createElement("div",{className:"cabana-explorer-signals-header-context"},s.a.createElement("h5",{className:"t-capline"},"Selected Message:"),s.a.createElement("h3",null,a)),s.a.createElement("div",{className:"cabana-explorer-signals-header-action"},s.a.createElement("button",{className:"button--small",onClick:function onClick(){return e.props.showEditMessageModal(t)}},"Edit"))),s.a.createElement("div",{className:"cabana-explorer-signals-subheader",onClick:this.toggleShouldShowAddSignal},s.a.createElement("strong",null,"Edit Signals")),s.a.createElement("div",{className:"cabana-explorer-signals-window"},this.state.shouldShowAddSignal?s.a.createElement(ee.a,{onConfirmedSignalChange:this.props.onConfirmedSignalChange,message:this.props.messages[this.props.selectedMessage],onClose:function onClose(){e.setState({shouldShowAddSignal:!1})},messageIndex:this.props.seekIndex,onSignalPlotChange:this.onSignalPlotChange,plottedSignalUids:this.selectedMessagePlottedSignalUids(),selectedMessageKey:t}):null,s.a.createElement(_e,{message:this.props.messages[this.props.selectedMessage],messageIndex:this.props.seekIndex,segmentIndices:this.state.segmentIndices,plottedSignals:this.state.plottedSignals,onSignalPlotPressed:this.onSignalPlotPressed,onSignalUnplotPressed:this.onSignalUnplotPressed,showAddSignal:this.showAddSignal,onMessageExpanded:this.onPause})))}},{key:"mergePlots",value:function mergePlots(e){var t=e.fromPlot,n=e.toPlot,a=this.state.plottedSignals,s=a.findIndex((function(e){return e.some((function(e){return e.signalUid===t.signalUid&&e.messageId===t.messageId}))}));a.splice(s,1);var i=a.findIndex((function(e){return e.some((function(e){return e.signalUid===n.signalUid&&e.messageId===n.messageId}))}));a[i]=[t,n],this.setState({plottedSignals:a})}},{key:"render",value:function render(){var e=this,t=this.state.shouldShowAddSignal?"is-expanded":null,n=this.props,a=n.thumbnails,i=n.messages,r=n.startTime,o=this.state.segment;return!o.length&&this.props.currentParts&&(o=[60*this.props.currentParts[0],60*(this.props.currentParts[1]+1)]),s.a.createElement("div",{className:"cabana-explorer"},s.a.createElement("div",{className:d()("cabana-explorer-signals",t)},i[this.props.selectedMessage]?this.renderExplorerSignals():this.renderSelectMessagePrompt()),s.a.createElement("div",{className:"cabana-explorer-visuals"},!1===this.props.live?s.a.createElement("div",null,s.a.createElement("div",{className:"cabana-explorer-visuals-header g-row"},s.a.createElement(ye,{playSpeed:this.state.playSpeed,onPlaySpeedChanged:this.changePlaySpeed})),s.a.createElement(fe,{message:i[this.props.selectedMessage],segment:this.state.segment,maxqcamera:this.props.maxqcamera,startTime:r,seekIndex:this.props.seekIndex,userSeekIndex:this.state.userSeekIndex,playing:this.state.playing,url:this.props.url,firstCanTime:this.props.firstCanTime,videoOffset:this.props.videoOffset,onVideoClick:this.onVideoClick,onPlaySeek:this.onPlaySeek,onUserSeek:this.onUserSeek,onPlay:this.onPlay,onPause:this.onPause,userSeekTime:this.state.userSeekTime,playSpeed:this.state.playSpeed,thumbnails:a,route:this.props.route,share:this.props.share})):null,this.state.segment.length>0?s.a.createElement("div",{className:"cabana-explorer-visuals-segmentreset",onClick:function onClick(){e.resetSegment()}},s.a.createElement("p",null,"Reset Segment")):null,s.a.createElement(ce,{plottedSignals:this.state.plottedSignals,messages:i,onGraphTimeClick:this.onGraphTimeClick,seekTime:this.props.seekTime,onSegmentChanged:this.onSegmentChanged,onSignalUnplotPressed:this.onSignalUnplotPressed,segment:o,mergePlots:this.mergePlots,live:this.props.live})))}}]),Explorer}(a.Component),Te=n(105),Oe=n.n(Te),ke=function(e){Object(K.a)(Modal,e);var t=Object(W.a)(Modal);function Modal(e){var n;return Object(y.a)(this,Modal),(n=t.call(this,e)).state={windowHeight:{},modalHeight:{}},n.updateHeights=n.updateHeights.bind(Object(Y.a)(n)),n}return Object(C.a)(Modal,[{key:"updateHeights",value:function updateHeights(e){this.setState({windowHeight:window.innerHeight}),this.setState({modalHeight:e.bounds.height})}},{key:"readVariationClasses",value:function readVariationClasses(){if(this.props.variations)return this.props.variations.reduce((function(e,t){return"".concat(e,"cabana-modal--").concat(t," ")}),"")}},{key:"checkClosability",value:function checkClosability(){return this.props.disableClose||!1}},{key:"checkYScrollability",value:function checkYScrollability(){return this.state.modalHeight>this.state.windowHeight}},{key:"render",value:function render(){var e=this;return s.a.createElement("div",{className:d()("cabana-modal",this.readVariationClasses(),{"cabana-modal--not-closable":this.checkClosability(),"cabana-modal--scrollable-y":this.checkYScrollability()})},s.a.createElement(ne.a,{bounds:!0,onResize:function onResize(t){e.updateHeights(t)}},(function(t){var n=t.measureRef;return s.a.createElement("div",{ref:n,className:"cabana-modal-container"},s.a.createElement("div",{className:"cabana-modal-close-icon",onClick:e.props.handleClose}),s.a.createElement("div",{className:"cabana-modal-header"},s.a.createElement("h1",null,e.props.title),s.a.createElement("p",null,e.props.subtitle)),s.a.createElement("div",{className:"cabana-modal-navigation"},e.props.navigation),s.a.createElement("div",{className:"cabana-modal-body"},s.a.createElement("div",{className:"cabana-modal-body-window"},e.props.children),s.a.createElement("div",{className:"cabana-modal-body-gradient"})),s.a.createElement("div",{className:"cabana-modal-actions"},e.props.actions),s.a.createElement("div",{className:"cabana-modal-footer"},e.props.footer))})),s.a.createElement("div",{className:"cabana-modal-backdrop",onClick:this.props.handleClose}))}}]),Modal}(a.Component),Me=function(e){Object(K.a)(OnboardingModal,e);var t=Object(W.a)(OnboardingModal);function OnboardingModal(e){var n;return Object(y.a)(this,OnboardingModal),(n=t.call(this,e)).state={webUsbEnabled:!!navigator.usb,viewingUsbInstructions:!1,pandaConnected:!1},n.attemptPandaConnection=n.attemptPandaConnection.bind(Object(Y.a)(n)),n.toggleUsbInstructions=n.toggleUsbInstructions.bind(Object(Y.a)(n)),n.navigateToExplorer=n.navigateToExplorer.bind(Object(Y.a)(n)),n}return Object(C.a)(OnboardingModal,[{key:"componentDidMount",value:function componentDidMount(){var e=document.createElement("script");document.body.appendChild(e),e.onload=function(){window.AppleID.auth.init({clientId:m.config.APPLE_CLIENT_ID,scope:m.config.APPLE_SCOPES,redirectURI:m.config.APPLE_REDIRECT_URI,state:m.config.APPLE_STATE})},e.src="https://appleid.cdn-apple.com/appleauth/static/jsapi/appleid/1/en_US/appleid.auth.js",e.async=!0,document.addEventListener("AppleIDSignInOnSuccess",(function(e){var t=e.detail.authorization,n=t.code,a=t.state;window.location=[m.config.APPLE_REDIRECT_PATH,Oe.a.stringify({code:n,state:a})].join("?")})),document.addEventListener("AppleIDSignInOnFailure",console.log)}},{key:"attemptPandaConnection",value:function attemptPandaConnection(){this.state.webUsbEnabled&&this.props.handlePandaConnect()}},{key:"toggleUsbInstructions",value:function toggleUsbInstructions(){this.setState({viewingUsbInstructions:!this.state.viewingUsbInstructions})}},{key:"navigateToExplorer",value:function navigateToExplorer(){window.location.href=b.b}},{key:"filterRoutesWithCan",value:function filterRoutesWithCan(e){return!0===e.can}},{key:"renderPandaEligibility",value:function renderPandaEligibility(){var e=this.state,t=e.webUsbEnabled,n=e.pandaConnected,a=this.props.attemptingPandaConnection;return t?!n&&a?s.a.createElement("p",null,s.a.createElement("i",{className:"fa fa-spinner animate-spin"}),s.a.createElement("span",{className:"animate-pulse-opacity"},"Waiting for panda USB connection")):void 0:s.a.createElement("p",null,s.a.createElement("i",{className:"fa fa-exclamation-triangle"}),s.a.createElement("span",{onClick:this.toggleUsbInstructions},s.a.createElement("span",null,"WebUSB is not enabled in your Chrome settings")))}},{key:"renderLogin",value:function renderLogin(){return p.a.isAuthenticated()?s.a.createElement("button",{onClick:this.navigateToExplorer,className:"button--primary button--kiosk"},s.a.createElement("i",{className:"fa fa-video-camera"}),s.a.createElement("strong",null,"Find a drive in connect"),s.a.createElement("sup",null,'Click "View in cabana" while replaying a drive')):s.a.createElement(s.a.Fragment,null,s.a.createElement("a",{href:m.config.GOOGLE_REDIRECT_LINK,className:"button button--primary button--icon"},s.a.createElement("i",{className:"fa fa-google"}),s.a.createElement("strong",null,"Sign in with Google")),s.a.createElement("button",{onClick:function onClick(){return window.AppleID.auth.signIn()},className:"button button--primary button--icon"},s.a.createElement("i",{className:"fa fa-apple"}),s.a.createElement("strong",null,"Sign in with Apple")),s.a.createElement("a",{href:m.config.GITHUB_REDIRECT_LINK,className:"button button--primary button--icon"},s.a.createElement("i",{className:"fa fa-github"}),s.a.createElement("strong",null,"Sign in with GitHub")))}},{key:"renderOnboardingOptions",value:function renderOnboardingOptions(){return s.a.createElement("div",{className:"cabana-onboarding-modes"},s.a.createElement("div",{className:"cabana-onboarding-mode"},this.renderLogin()),s.a.createElement("div",{className:"cabana-onboarding-mode"},s.a.createElement("button",{className:d()("button--secondary button--kiosk",{"is-disabled":!this.state.webUsbEnabled||this.props.attemptingPandaConnection}),onClick:this.attemptPandaConnection},s.a.createElement("i",{className:"fa fa-bolt"}),s.a.createElement("strong",null,"Launch Realtime Streaming"),s.a.createElement("sup",null,"Interactively stream car data over USB with"," ",s.a.createElement("em",null,"panda")),this.renderPandaEligibility())))}},{key:"renderUsbInstructions",value:function renderUsbInstructions(){return s.a.createElement("div",{className:"cabana-onboarding-instructions"},s.a.createElement("button",{className:"button--small button--inverted",onClick:this.toggleUsbInstructions},s.a.createElement("i",{className:"fa fa-chevron-left"}),s.a.createElement("span",null," Go back")),s.a.createElement("h3",null,"Follow these directions to enable WebUSB:"),s.a.createElement("ol",{className:"cabana-onboarding-instructions-list list--bubbled"},s.a.createElement("li",null,s.a.createElement("p",null,s.a.createElement("strong",null,"Open your Chrome settings:")),s.a.createElement("div",{className:"inset"},s.a.createElement("span",null,"chrome://flags/#enable-experimental-web-platform-features"))),s.a.createElement("li",null,s.a.createElement("p",null,s.a.createElement("strong",null,"Enable Experimental Platform features:")),s.a.createElement("img",{alt:"Screenshot of Google Chrome Experimental Platform features",src:OnboardingModal.instructionalImages.step2})),s.a.createElement("li",null,s.a.createElement("p",null,s.a.createElement("strong",null,"Enable WebUSB:")),s.a.createElement("img",{alt:"Screenshot of Google Chrome enable WebUSB",src:OnboardingModal.instructionalImages.step3})),s.a.createElement("li",null,s.a.createElement("p",null,s.a.createElement("strong",null,"Relaunch your Chrome browser and try enabling live mode again.")))))}},{key:"renderModalContent",value:function renderModalContent(){return this.state.viewingUsbInstructions?this.renderUsbInstructions():this.renderOnboardingOptions()}},{key:"renderModalFooter",value:function renderModalFooter(){return s.a.createElement("p",null,s.a.createElement("span",null,"Don't have a"," ",s.a.createElement("a",{href:"https://comma.ai/shop/products/panda",target:"_blank",rel:"noopener noreferrer"},"panda"),"?"," "),s.a.createElement("span",null,s.a.createElement("a",{href:"https://comma.ai/shop/products/panda",target:"_blank",rel:"noopener noreferrer"},"Get one here")," "),s.a.createElement("span",null,"or"," ",s.a.createElement("a",{href:"".concat(window.location.href,"?demo=1")},"try the demo"),"."))}},{key:"render",value:function render(){return s.a.createElement(ke,{title:"Welcome to Cabana",subtitle:"Get started by selecting a drive from connect or enabling live mode",footer:this.renderModalFooter(),disableClose:!0,variations:["wide","dark"]},this.renderModalContent())}}]),OnboardingModal}(a.Component);Me.instructionalImages={step2:n(457),step3:n(458)};var Ae=n(11),Xe=n.n(Ae),De=n(20),Ne=n(246),Ie=n.n(Ne),we=n(247),Re=n.n(we);class xe{constructor(e){this.token=e,this.github=new Re.a({token:e}),this.sourceRepo=this.github.getRepo("boggyver","tesladbc"),this.githubUsername=null}hasAuth(){return null!==this.token}async getGithubUsername(){if(this.githubUsername)return this.githubUsername;const e=await this.fetchGithubUsername();return e||void 0}async fetchGithubUsername(){try{const e=await this.github.getUser();if(e){const t=await e.getProfile();if(t)return t.data.login}}catch(e){return null}}async list(e){let t;if(void 0===e)t=this.sourceRepo;else{const[n,a]=e.split("/");t=this.github.getRepo(n,a)}try{return(await t.getContents("master","")).data.map(e=>e.path)}catch(n){return[]}}async getDbcContents(e,t){let n;if(void 0===t)n=this.sourceRepo;else{const[e,a]=t.split("/");n=this.github.getRepo(e,a)}const a=(await n.getContents("master",e)).data.download_url;return(await fetch(a,{cache:"no-cache"})).text()}repoSourceIsOpenDbc(e){return e.source&&e.source.full_name===b.i}async getUserOpenDbcFork(){const e=await this.getGithubUsername();if(!e)return null;const t=this.github.getRepo(e,"opendbc"),n=(await t.getDetails()).data;return this.repoSourceIsOpenDbc(n)?n.full_name:null}async fork(){return 202===(await this.sourceRepo.fork()).status}async commitFile(e,t,n,a){const[s,i]=e.split("/"),r=this.github.getRepo(s,i),o=(await r.getRef("heads/master")).data,l=(await r.getCommit(o.object.sha)).data,c=(await r.getTree(l.tree.sha)).data,d=[{mode:"100644",path:t,type:"blob",content:n}],u=(await r.createTree(d,c.sha)).data,g=(await r.commit(l.sha,u.sha,a||"TeslaDBC updates")).data;return 200===(await r.updateHead("heads/master",g.sha,!1)).status}}var Le=function(e){Object(K.a)(SaveDbcModal,e);var t=Object(W.a)(SaveDbcModal);function SaveDbcModal(e){var n;return Object(y.a)(this,SaveDbcModal),(n=t.call(this,e)).state={tab:"GitHub",openDbcFork:null,dbcFilename:n.props.sourceDbcFilename,tabs:["GitHub","Download"],commitMessage:"OpenDBC updates"},n.commitToGitHub=n.commitToGitHub.bind(Object(Y.a)(n)),n.downloadDbcFile=n.downloadDbcFile.bind(Object(Y.a)(n)),n.forkOpenDbcAndWait=n.forkOpenDbcAndWait.bind(Object(Y.a)(n)),n.renderForkButton=n.renderForkButton.bind(Object(Y.a)(n)),n.renderTabNavigation=n.renderTabNavigation.bind(Object(Y.a)(n)),n.renderActions=n.renderActions.bind(Object(Y.a)(n)),n}return Object(C.a)(SaveDbcModal,[{key:"componentDidMount",value:function(){var e=Object(De.a)(Xe.a.mark((function _callee(){var e;return Xe.a.wrap((function _callee$(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.props.openDbcClient.getUserOpenDbcFork();case 2:e=t.sent,this.setState({openDbcFork:e});case 4:case"end":return t.stop()}}),_callee,this)})));return function componentDidMount(){return e.apply(this,arguments)}}()},{key:"commitToGitHub",value:function(){var e=Object(De.a)(Xe.a.mark((function _callee2(){var e,t,n,a;return Xe.a.wrap((function _callee2$(s){for(;;)switch(s.prev=s.next){case 0:return e=this.state,t=e.openDbcFork,n=e.dbcFilename,a="".concat(n.replace(/\.dbc/g,""),".dbc"),s.next=4,this.props.openDbcClient.commitFile(t,a,this.props.dbc.text(),this.state.commitMessage);case 4:s.sent&&this.props.onDbcSaved(a);case 6:case"end":return s.stop()}}),_callee2,this)})));return function commitToGitHub(){return e.apply(this,arguments)}}()},{key:"downloadDbcFile",value:function(){var e=Object(De.a)(Xe.a.mark((function _callee3(){var e,t;return Xe.a.wrap((function _callee3$(n){for(;;)switch(n.prev=n.next){case 0:e=new Blob([this.props.dbc.text()],{type:"text/plain;charset=utf-8"}),t="".concat(this.state.dbcFilename.replace(/\.dbc/g,""),".dbc"),Ie.a.saveAs(e,t,!0);case 3:case"end":return n.stop()}}),_callee3,this)})));return function downloadDbcFile(){return e.apply(this,arguments)}}()},{key:"forkOpenDbcAndWait",value:function(){var e=Object(De.a)(Xe.a.mark((function _callee4(){var e,t,n,a=this;return Xe.a.wrap((function _callee4$(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,this.props.openDbcClient.fork();case 2:s.sent&&(e=!1,t=window.setTimeout((function(){e=!0}),3e4),n=window.setInterval((function(){e?window.clearInterval(n):a.props.openDbcClient.getUserOpenDbcFork().then((function(e){null!==e&&(a.setState({openDbcFork:e}),window.clearInterval(n),window.clearTimeout(t))}))}),3e3));case 4:case"end":return s.stop()}}),_callee4,this)})));return function forkOpenDbcAndWait(){return e.apply(this,arguments)}}()},{key:"primaryActionDisabled",value:function primaryActionDisabled(){var e=this.state.tab;return"GitHub"===e?null!=this.state.openDbcFork&&this.state.dbcFilename.length>0:"Download"===e||void 0}},{key:"renderForkButton",value:function renderForkButton(){return s.a.createElement("button",{onClick:this.forkOpenDbcAndWait},s.a.createElement("i",{className:"fa fa-code-fork"}),s.a.createElement("span",null," Fork OpenDBC"))}},{key:"renderForkStep",value:function renderForkStep(){var e,t=this.state.openDbcFork;return e=null!==t?s.a.createElement("button",{disabled:!0},s.a.createElement("i",{className:"fa fa-code-fork"}),s.a.createElement("span",null," ","Forked:",t)):this.props.hasGithubAuth?this.renderForkButton():this.props.loginWithGithub,s.a.createElement("div",null,null!==t?this.renderForkButton():null,e,s.a.createElement("hr",null))}},{key:"renderFilenameField",value:function renderFilenameField(){var e=this;return s.a.createElement("div",{className:"form-field","data-extension":".dbc"},s.a.createElement("label",{htmlFor:"filename"},s.a.createElement("span",null,"Choose a filename:"),s.a.createElement("sup",null,"Pick a unique name for your car DBC file")),s.a.createElement("input",{type:"text",id:"filename",value:this.state.dbcFilename.replace(/\.dbc/g,""),size:this.state.dbcFilename.length+2,onChange:function onChange(t){return e.setState({dbcFilename:t.target.value})}}))}},{key:"renderTabNavigation",value:function renderTabNavigation(){var e=this;return s.a.createElement("div",{className:"cabana-tabs-navigation"},this.state.tabs.map((function(t){return s.a.createElement("button",{className:d()({"is-active":e.state.tab===t}),onClick:function onClick(){e.setState({tab:t})},key:t},s.a.createElement("span",null,t))})))}},{key:"renderCommitMessage",value:function renderCommitMessage(){var e=this;return s.a.createElement("div",{className:"form-field"},s.a.createElement("label",{htmlFor:"commit-message"},s.a.createElement("span",null,"Commit Message:"),s.a.createElement("sup",null,"Message appears in git logs")),s.a.createElement("input",{type:"text",id:"commit-message",value:this.state.commitMessage,onChange:function onChange(t){return e.setState({commitMessage:t.target.value})}}))}},{key:"renderTabContent",value:function renderTabContent(){var e=this.state.tab;return"GitHub"===e?s.a.createElement("div",null,this.renderForkStep(),this.renderFilenameField(),this.renderCommitMessage()):"Download"===e?s.a.createElement("div",null,this.renderFilenameField()):void 0}},{key:"renderActions",value:function renderActions(){var e=this.state.tab;return"GitHub"===e?s.a.createElement("div",null,s.a.createElement("button",{className:"button--inverted",onClick:this.props.handleClose},s.a.createElement("span",null,"Cancel")),s.a.createElement("button",{className:"button--primary",onClick:this.commitToGitHub},s.a.createElement("span",null,"Commit to GitHub"))):"Download"===e?s.a.createElement("div",null,s.a.createElement("button",{className:"button--inverted",onClick:this.props.handleClose},s.a.createElement("span",null,"Cancel")),s.a.createElement("button",{className:"button--primary",onClick:this.downloadDbcFile},s.a.createElement("span",null,"Download"))):void 0}},{key:"render",value:function render(){return s.a.createElement(ke,{title:"Save DBC File",subtitle:"Save your progress and output to a DBC file",handleClose:this.props.handleClose,navigation:this.renderTabNavigation(),actions:this.renderActions()},this.renderTabContent())}}]),SaveDbcModal}(a.Component),Ge=function(e){Object(K.a)(GithubDbcList,e);var t=Object(W.a)(GithubDbcList);function GithubDbcList(e){var n;return Object(y.a)(this,GithubDbcList),(n=t.call(this,e)).state={paths:[],selectedPath:null,pathQuery:""},n.updatePathQuery=n.updatePathQuery.bind(Object(Y.a)(n)),n}return Object(C.a)(GithubDbcList,[{key:"componentDidMount",value:function componentDidMount(){var e=this;this.props.openDbcClient.list(this.props.repo).then((function(t){t=t.filter((function(e){return-1!==e.indexOf(".dbc")})),e.setState({paths:t})}))}},{key:"componentDidUpdate",value:function componentDidUpdate(e){var t=this;e.repo!==this.props.repo&&this.props.openDbcClient.list(this.props.repo).then((function(e){t.setState({paths:e,selectedPath:null})}))}},{key:"updatePathQuery",value:function updatePathQuery(e){this.setState({pathQuery:e.target.value})}},{key:"selectPath",value:function selectPath(e){var t=this;this.setState({selectedPath:e}),this.props.openDbcClient.getDbcContents(e,this.props.repo).then((function(n){t.props.onDbcLoaded(e,n)}))}},{key:"render",value:function render(){var e=this;return s.a.createElement("div",{className:"cabana-dbc-list"},s.a.createElement("div",{className:"cabana-dbc-list-header"},s.a.createElement("a",{href:"https://github.com/".concat(this.props.repo),target:"_blank",rel:"noopener noreferrer"},s.a.createElement("i",{className:"fa fa-github"}),s.a.createElement("span",null,this.props.repo)),s.a.createElement("div",{className:"form-field form-field--small"},s.a.createElement("input",{type:"text",placeholder:"Search DBC Files",onChange:this.updatePathQuery}))),s.a.createElement("div",{className:"cabana-dbc-list-files"},this.state.paths.filter((function(t){return""===e.state.pathQuery|t.includes(e.state.pathQuery)})).map((function(t){return s.a.createElement("div",{className:d()("cabana-dbc-list-file",{"is-selected":e.state.selectedPath===t}),onClick:function onClick(){e.selectPath(t)},key:t},s.a.createElement("span",null,t))}))))}}]),GithubDbcList}(a.Component),Pe=function(e){Object(K.a)(DbcUpload,e);var t=Object(W.a)(DbcUpload);function DbcUpload(e){var n;return Object(y.a)(this,DbcUpload),(n=t.call(this,e)).state={dbcText:""},n.onTextChanged=n.onTextChanged.bind(Object(Y.a)(n)),n}return Object(C.a)(DbcUpload,[{key:"onTextChanged",value:function onTextChanged(e){var t=e.target.value;this.setState({dbcText:t}),this.props.onDbcLoaded("from paste",t)}},{key:"render",value:function render(){return s.a.createElement("div",{className:"cabana-dbc-upload-raw"},s.a.createElement("div",{className:"form-field"},s.a.createElement("label",{htmlFor:"raw_dbc_upload"},s.a.createElement("span",null,"Raw DBC File:"),s.a.createElement("sup",null,"Paste your DBC text output within this box")),s.a.createElement("textarea",{value:this.state.dbcText,id:"raw_dbc_upload",className:"t-mono",placeholder:"PASTE DBC FILE HERE",onChange:this.onTextChanged})))}}]),DbcUpload}(a.Component);class Ue extends a.Component{constructor(e){super(e),this.state={tab:"TeslaDBC",tabs:["TeslaDBC","Upload"],dbc:null,dbcSource:null,userOpenDbcRepo:null},this.onDbcLoaded=this.onDbcLoaded.bind(this),this.handleSave=this.handleSave.bind(this),this.renderTabNavigation=this.renderTabNavigation.bind(this),this.renderTabContent=this.renderTabContent.bind(this),this.renderActions=this.renderActions.bind(this)}componentDidMount(){this.props.openDbcClient.getUserOpenDbcFork().then(e=>{this.setState({userOpenDbcRepo:e})})}onDbcLoaded(e,t){const n=new V(t);this.setState({dbcSource:e,dbc:n})}handleSave(){const{dbc:e,dbcSource:t}=this.state;this.props.onDbcSelected(t,e)}renderTabNavigation(){return s.a.createElement("div",{className:"cabana-tabs-navigation"},this.state.tabs.map(e=>s.a.createElement("button",{className:d()({"is-active":this.state.tab===e}),onClick:()=>{this.setState({tab:e,dbc:null,dbcSource:null})},key:e},s.a.createElement("span",null,e))))}renderTabContent(){const{tab:e}=this.state;return"TeslaDBC"===e?s.a.createElement(Ge,{onDbcLoaded:this.onDbcLoaded,repo:"boggyver/tesladbc",openDbcClient:this.props.openDbcClient}):"GitHub"===e?this.props.openDbcClient.hasAuth()?null===this.state.userOpenDbcRepo?s.a.createElement("div",null,"Fork it"):s.a.createElement(Ge,{onDbcLoaded:this.onDbcLoaded,repo:this.state.userOpenDbcRepo,openDbcClient:this.props.openDbcClient}):this.props.loginWithGithub:"Upload"===e?s.a.createElement(Pe,{onDbcLoaded:this.onDbcLoaded}):void 0}renderActions(e){return s.a.createElement("div",null,s.a.createElement("button",{className:"button--inverted",onClick:this.props.handleClose},s.a.createElement("span",null,"Cancel")),s.a.createElement("button",{className:"button--primary",disabled:e,onClick:this.handleSave},s.a.createElement("span",null,"Load DBC")))}render(){return s.a.createElement(ke,{title:"Load DBC File",subtitle:"Modify an existing DBC file with Cabana",handleClose:this.props.handleClose,navigation:this.renderTabNavigation(),actions:this.renderActions(Boolean(null===this.state.dbc))},this.renderTabContent())}}var Be=function(e){Object(K.a)(EditMessageModal,e);var t=Object(W.a)(EditMessageModal);function EditMessageModal(e){var n;return Object(y.a)(this,EditMessageModal),(n=t.call(this,e)).state={messageFrame:e.message.frame.copy()},n.handleSave=n.handleSave.bind(Object(Y.a)(n)),n.editTransmitter=n.editTransmitter.bind(Object(Y.a)(n)),n.addTransmitter=n.addTransmitter.bind(Object(Y.a)(n)),n.renderActions=n.renderActions.bind(Object(Y.a)(n)),n}return Object(C.a)(EditMessageModal,[{key:"handleSave",value:function handleSave(){this.props.handleSave(this.state.messageFrame)}},{key:"addTransmitter",value:function addTransmitter(){var e=this.state.messageFrame;e.addTransmitter(),this.setState({messageFrame:e})}},{key:"editTransmitter",value:function editTransmitter(e){}},{key:"renderActions",value:function renderActions(){return s.a.createElement("div",null,s.a.createElement("button",{className:"button--inverted",onClick:this.props.handleClose},"Cancel"),s.a.createElement("button",{className:"button--primary",onClick:this.handleSave},"Save Message"))}},{key:"render",value:function render(){var e=this;return s.a.createElement(ke,{title:"Edit Message: (".concat(this.props.message.id,")"),subtitle:"Make changes and update defaults of this message",handleClose:this.props.handleClose,handleSave:this.handleSave,actions:this.renderActions()},s.a.createElement("div",{className:"form-field"},s.a.createElement("label",{htmlFor:"message_name"},s.a.createElement("span",null,"Name"),s.a.createElement("sup",null,"Customize the name of this message")),s.a.createElement("input",{type:"text",id:"message_name",value:this.state.messageFrame.name,onChange:function onChange(t){var n=e.state.messageFrame;n.name=t.target.value,e.setState({messageFrame:n})}})),s.a.createElement("div",{className:"form-field"},s.a.createElement("label",{htmlFor:"message_size"},s.a.createElement("span",null,"Size"),s.a.createElement("sup",null,"Add a size parameter to this message")),s.a.createElement("input",{type:"number",id:"message_size",value:this.state.messageFrame.size,onChange:function onChange(t){var n=e.state.messageFrame;n.size=parseInt(t.target.value,10),e.setState({messageFrame:n})}})),s.a.createElement("div",{className:"form-field u-hidden"},s.a.createElement("label",{htmlFor:"message_transmitters"},s.a.createElement("span",null,"Transmitters"),s.a.createElement("sup",null,"Add the physical ECU units that this message is coming from.")),s.a.createElement("div",{className:"form-field-inset"},s.a.createElement("ul",{className:"form-field-inset-list"},this.state.messageFrame.transmitters.map((function(e){return s.a.createElement("li",{className:"form-field-inset-list-item",key:e},s.a.createElement("div",{className:"form-field-inset-list-item-title"},s.a.createElement("span",null,e)),s.a.createElement("div",{className:"form-field-inset-list-item-action"},s.a.createElement("button",{className:"button--tiny button--alpha"},"Edit")))})),s.a.createElement("button",{className:"button--tiny button--alpha"},s.a.createElement("span",null,s.a.createElement("i",{className:"fa fa-plus"})," ","Add Transmitter"))))))}}]),EditMessageModal}(a.Component);function fetchPersistedDbc(e){var t=window.localStorage.getItem(e);if(null!==t){var n=JSON.parse(t),a=n.dbcFilename,s=n.dbcText;return{dbc:new V(s),dbcText:s,dbcFilename:a}}return null}function persistDbc(e,t){var n=t.dbcFilename,a=t.dbc,s=JSON.stringify({dbcFilename:n,dbcText:a.text()});window.localStorage.setItem(e,s)}var je=n(248),Fe=n.n(je),He=function(){function UnloggerClient(){Object(y.a)(this,UnloggerClient),this.socket=Fe()(b.j)}return Object(C.a)(UnloggerClient,[{key:"seek",value:function seek(e,t,n){this.socket.emit("seek",e,t,n)}}]),UnloggerClient}();const Ve=n(518),Ye=n(519),Ke=n(520),We=n(521),ze={};class qe extends a.Component{constructor(e){super(e),this.partChangeDebounced=debounce(()=>{this.loadMessagesFromCache(),this.spawnWorker()},500),this.state={messages:{},thumbnails:[],selectedMessages:[],route:null,canFrameOffset:0,routeInitTime:0,firstFrameTime:0,carFingerprint:null,firstCanTime:null,lastBusTime:null,selectedMessage:null,currentParts:[0,0],currentPart:0,currentWorkers:{},loadingParts:[],loadedParts:[],showOnboarding:!1,showLoadDbc:!1,showSaveDbc:!1,showEditMessageModal:!1,editMessageModalMessage:null,dbc:e.dbc?e.dbc:new V,dbcText:e.dbc?e.dbc.text():(new V).text(),dbcFilename:e.dbcFilename?e.dbcFilename:"New_DBC",dbcLastSaved:null,seekTime:e.seekTime||0,seekIndex:0,maxByteStateChangeCount:0,partsLoaded:0,spawnWorkerHash:null,attemptingPandaConnection:!1,pandaNoDeviceSelected:!1,live:!1,isGithubAuthenticated:null!==e.githubAuthToken&&void 0!==e.githubAuthToken,shareUrl:null,logUrls:null,share:null},this.openDbcClient=new xe(e.githubAuthToken),b.k&&(this.unloggerClient=new He),this.showOnboarding=this.showOnboarding.bind(this),this.hideOnboarding=this.hideOnboarding.bind(this),this.showLoadDbc=this.showLoadDbc.bind(this),this.hideLoadDbc=this.hideLoadDbc.bind(this),this.showSaveDbc=this.showSaveDbc.bind(this),this.hideSaveDbc=this.hideSaveDbc.bind(this),this.showEditMessageModal=this.showEditMessageModal.bind(this),this.hideEditMessageModal=this.hideEditMessageModal.bind(this),this.onDbcSelected=this.onDbcSelected.bind(this),this.onDbcSaved=this.onDbcSaved.bind(this),this.onConfirmedSignalChange=this.onConfirmedSignalChange.bind(this),this.onPartChange=this.onPartChange.bind(this),this.onMessageFrameEdited=this.onMessageFrameEdited.bind(this),this.onSeek=this.onSeek.bind(this),this.onUserSeek=this.onUserSeek.bind(this),this.onMessageSelected=this.onMessageSelected.bind(this),this.onMessageUnselected=this.onMessageUnselected.bind(this),this.initCanData=this.initCanData.bind(this),this.updateSelectedMessages=this.updateSelectedMessages.bind(this),this.handlePandaConnect=this.handlePandaConnect.bind(this),this.processStreamedCanMessages=this.processStreamedCanMessages.bind(this),this.onStreamedCanMessagesProcessed=this.onStreamedCanMessagesProcessed.bind(this),this.showingModal=this.showingModal.bind(this),this.lastMessageEntriesById=this.lastMessageEntriesById.bind(this),this.githubSignOut=this.githubSignOut.bind(this),this.downloadLogAsCSV=this.downloadLogAsCSV.bind(this),this.pandaReader=new h.a,this.pandaReader.onMessage(this.processStreamedCanMessages)}componentDidMount(){this.dataCacheTimer=Object(f.interval)(()=>{const{currentParts:e}=this.state;let{loadedParts:t}=this.state;this.loadMessagesFromCacheRunning||t.length<4||t.forEach(n=>{n>=e[0]&&n<=e[1]||Date.now()-ze[n].lastUsed>18e4&&(console.log("Decaching part",n),t=t.filter(e=>e!==n),this.setState({loadedParts:t},()=>{delete ze[n]}))})},1e4);const{dongleId:e,name:t}=this.props;if(p.a.isAuthenticated()&&!t)this.showOnboarding();else if(this.props.max&&this.props.url&&!this.props.exp&&!this.props.sig){const{max:n,url:a}=this.props,s=l()(t,"YYYY-MM-DD--H-m-s"),i={fullname:"".concat(e,"|").concat(t),proclog:n,url:a,start_time:s};this.setState({route:i,currentParts:[0,Math.min(n,b.g-1)]},this.initCanData)}else if(e&&t){const n="".concat(e,"|").concat(t);let a,s;a=this.props.url?Promise.resolve({maxqcamera:null,url:this.props.url}):S.drives.getRouteInfo(n),s=this.props.sig&&this.props.exp?S.raw.getRouteFiles(n,!1,{sig:this.props.sig,exp:this.props.exp}):S.raw.getRouteFiles(n),Promise.all([a,s]).then(e=>{const[a,s]=e,i=s.logs,r={route:{fullname:n,proclog:i.length-1,start_time:l()(t,"YYYY-MM-DD--H-m-s"),url:a.url.replace("chffrprivate.blob.core.windows.net","chffrprivate.azureedge.net"),maxqcamera:a.maxqcamera?a.maxqcamera:i.length-1},currentParts:[0,Math.min(i.length-1,b.g-1)],logUrls:i};this.setState(r,this.initCanData),this.props.sig&&this.props.exp?this.setState({share:{exp:this.props.exp,sig:this.props.sig}}):S.drives.getShareSignature(n).then(e=>this.setState({share:{exp:e.exp,sig:e.sig},shareUrl:Object(v.b)({add:{exp:e.exp,sig:e.sig,max:i.length-1,url:a.url.replace("chffrprivate.blob.core.windows.net","chffrprivate.azureedge.net")},remove:[b.c]})}))}).catch(e=>{console.log(e),m.storage.logOut().then(()=>{m.storage.isAuthed=!1,this.showOnboarding()})})}else this.showOnboarding()}componentWillUnmount(){this.dataCacheTimer&&this.dataCacheTimer()}initCanData(){this.spawnWorker(this.state.currentParts)}onDbcSelected(e,t){const{route:n}=this.state;this.hideLoadDbc(),t.lastUpdated=Date.now(),this.persistDbc({dbcFilename:e,dbc:t}),n?this.setState({dbc:t,dbcFilename:e,dbcText:t.text(),partsLoaded:0,selectedMessage:null,messages:{}},()=>{this.loadMessagesFromCache()}):this.setState({dbc:t,dbcFilename:e,dbcText:t.text(),messages:{}})}onDbcSaved(e){const t=l()();this.setState({dbcLastSaved:t,dbcFilename:e}),this.hideSaveDbc()}downloadLogAsCSV(){console.log("downloadLogAsCSV:start");const{dbcFilename:e}=this.state,t=Object(u.createWriteStream)("".concat(e.replace(/\.dbc/g,"-")).concat(+new Date,".csv")).getWriter(),n=new TextEncoder;return this.state.live?this.downloadLiveLogAsCSV(dataHandler):this.downloadRawLogAsCSV(dataHandler);function dataHandler(e){const{logData:a,shouldClose:s,progress:i}=e.data;if(s)return console.log("downloadLogAsCSV:close"),void t.close();console.log("CSV export progress:",i);const r=n.encode("".concat(a,"\n"));t.write(r)}}downloadRawLogAsCSV(e){return this.downloadLiveLogAsCSV(e)}downloadLiveLogAsCSV(e){const{firstCanTime:t,canFrameOffset:n}=this.state,a=new Ye;a.onmessage=e,a.postMessage({data:Object.keys(this.state.messages).map(e=>{const t=this.state.messages[e];return{id:t.id,bus:t.bus,address:t.address,entries:t.entries.slice()}}),canStartTime:t-n})}mergeThumbnails(e){const{thumbnails:t}=this.state;if(!e||!e.length)return t;if(!t.length)return e;let n=0,a=0;if(e[0].monoTime>t[t.length-1])return t.concat(e);if(e[e.length-1]<t[0])return e.concat(t);let s=[];for(;n<t.length&&a<e.length;)t[n].monoTime<e[a].monoTime?(s.push(t[n]),n+=1):(s.push(e[a]),a+=1);return n<t.length?s=s.concat(t.slice(n)):a<e.length&&(s=s.concat(e.slice(a))),s}cancelWorker(e){}spawnWorker(e){let{currentParts:t,currentWorkers:n,loadingParts:a}=this.state;if(console.log("Checking worker for",t),a.length>1)return;const[s,i]=t;n={...this.state.currentWorkers};const{loadedParts:r,currentPart:o}=this.state;let l=-1;const c=a.concat(r);for(let b=0;b<=i-s;++b){let e=o+b;if(e>i&&(e=s+(e-s)%(i-s+1)),-1===c.indexOf(e)){l=e;break}}if(-1===l)return;console.log("Starting worker for part",l),e=e||{};let{prevMsgEntries:d}=e;const{dbc:u,route:g,firstCanTime:h,canFrameOffset:m}=this.state;let{maxByteStateChangeCount:p}=this.state;if(!d){const{messages:e}=this.state;d={},Object.keys(e).forEach(t=>{const{entries:n}=e[t];d[t]=n[n.length-1]})}const S=new Ve,f=function hash(e){for(var t=5381,n=e.length;n;)t=33*t^e.charCodeAt(--n);return(t>>>0).toString(16)}(Math.random().toString(16));n[f]={part:l,worker:S},a=[l,...a],this.setState({currentWorkers:n,loadingParts:a}),S.onmessage=e=>{if(void 0===this.state.currentWorkers[f])return void console.log("Worker was canceled");p=e.data.maxByteStateChangeCount;const{newMessages:t,newThumbnails:n,isFinished:a,routeInitTime:s,firstFrameTime:i,carParams:r}=e.data;if(p>this.state.maxByteStateChangeCount?this.setState({maxByteStateChangeCount:p}):p=this.state.maxByteStateChangeCount,s!==this.state.routeInitTime&&this.setState({routeInitTime:s}),i&&i!==this.state.firstFrameTime&&this.setState({firstFrameTime:i}),r&&r.CarFingerprint!==this.state.carFingerprint&&(this.setState({carFingerprint:r.CarFingerprint}),"New_DBC"===this.state.dbcFilename)){const e=A.a.findDbcForCar(r.CarFingerprint);e&&this.openDbcClient.getDbcContents(e+".dbc","boggyver/tesladbc").then(t=>{this.onDbcSelected(e,new V(t))})}if(t&&this.addMessagesToDataCache(l,t,n),a){const e=this.state.loadingParts.filter(e=>e!==l),t=[l,...this.state.loadedParts];this.setState({partsLoaded:this.state.partsLoaded+1,loadingParts:e,loadedParts:t},()=>{this.spawnWorker({prevMsgEntries:d,spawnWorkerHash:f,prepend:!1}),window.dataCallback&&(window.dataCallback(),window.dataCallback=null)})}},S.postMessage({base:g.url,num:l,isLegacyShare:this.props.isLegacyShare,logUrls:this.state.logUrls,dbcText:u.text(),route:g.fullname,part:l,canStartTime:null!=h?h-m:null,prevMsgEntries:d,maxByteStateChangeCount:p})}addAndRehydrateMessages(e,t){t=t||{};const n={...this.state.messages};Object.keys(e).forEach(a=>{if(!0!==t.replace&&a in n){const t=n[a].entries,s=e[a].entries,i=t.length,r=s.length,o=i+r;n[a]={...n[a],entries:Array(o)};let l=0,c=0;for(let e=0;e<o;++e)c>=r?n[a].entries[e]=t[l++]:l>=i?n[a].entries[e]=s[c++]:t[l].relTime<=s[c].relTime?n[a].entries[e]=t[l++]:t[l].relTime>=s[c].relTime&&(n[a].entries[e]=s[c++]);n[a].byteStateChangeCounts=e[a].byteStateChangeCounts}else n[a]=e[a],n[a].frame=this.state.dbc.getMessageFrame(n[a].address)});const a=A.a.findMaxByteStateChangeCount(n);return this.setState({maxByteStateChangeCount:a}),Object.keys(n).forEach(e=>{n[e]=A.a.setMessageByteColors(n[e],a)}),n}async addMessagesToDataCache(e,t,n){const{dbc:a,currentParts:s}=this.state,i=await this.getParseSegment(e);if(!i)return Object.keys(t).forEach(e=>{t[e]=this.parseMessageEntry(t[e],a)}),ze[e]={messages:t,thumbnails:n,lastUpdated:Date.now(),lastUsed:Date.now()},void(e>=s[0]&&e<=s[1]&&this.setState({messages:this.addAndRehydrateMessages(t)}));i.lastUsed=Date.now(),Object.keys(t).forEach(n=>{let s=t[n];if(ze[e].messages[n]){let{entries:t}=ze[e].messages[n];const i=t.length?t[t.length-1]:null;s=this.parseMessageEntry(s,a,i),t=t.concat(s.entries),ze[e].messages[n].entries=t}else s=this.parseMessageEntry(s,a),ze[e].messages[n]=s;t[n]=s}),ze[e].thumbnails=ze[e].thumbnails.concat(n),e>=s[0]&&e<=s[1]&&this.setState({messages:this.addAndRehydrateMessages(t)})}async loadMessagesFromCache(){if(this.loadMessagesFromCacheRunning)return void(this.loadMessagesFromCacheTimer||(this.loadMessagesFromCacheTimer=Object(f.timeout)(()=>this.loadMessagesFromCache(),10)));this.loadMessagesFromCacheRunning=!0,this.loadMessagesFromCacheTimer&&(this.loadMessagesFromCacheTimer(),this.loadMessagesFromCacheTimer=null);const{currentParts:e,dbc:t}=this.state,{lastUpdated:n}=t,[a,s]=e,i={};let r=[],o=!1,l=performance.now();const c=[];for(let u=a,g=s;u<=g;++u)c.push(this.getParseSegment(u));if(await c.reduce(async(e,t)=>{if(await e,o)return;const a=await t;if(this.state.dbc.lastUpdated===n){if(a){const e=a.messages;r=r.concat(a.thumbnails),Object.keys(e).forEach(t=>{if(i[t]){const n=e[t].entries,a=i[t].entries;n.length&&n[0].relTime<a[a.length-1].relTime&&console.error("Found out of order messages",n[0],a[a.length-1]),i[t].entries=i[t].entries.concat(e[t].entries)}else i[t]={...e[t]}})}console.log("Done with",performance.now()-l),l=performance.now()}else o||(o=!0,this.loadMessagesFromCacheRunning=!1,console.log("Canceling!"),this.loadMessagesFromCache())},Promise.resolve()),o)return;Object.keys(this.state.messages).forEach(e=>{i[e]||(i[e]=this.state.messages[e],i[e].entries=[])}),Object.keys(i).forEach(e=>{i[e].frame=t.getMessageFrame(i[e].address)});const d=A.a.findMaxByteStateChangeCount(i);this.setState({maxByteStateChangeCount:d}),Object.keys(i).forEach(e=>{i[e]=A.a.setMessageByteColors(i[e],d)}),console.log("Done with old messages",performance.now()-l),this.setState({messages:i,thumbnails:r}),this.loadMessagesFromCacheRunning=!1}async getParseSegment(e){return ze[e]?(ze[e].promise&&await ze[e].promise,ze[e].promise=this.getParseSegmentInternal(e),ze[e].promise):null}async getParseSegmentInternal(e){const t=performance.now(),{dbc:n}=this.state;n.lastUpdated||(n.lastUpdated=Date.now());const{lastUpdated:a}=n;let{messages:s}=ze[e],i={};Object.keys(s).forEach(e=>{s[e].lastUpdated>=a||(i[e]=s[e])}),Object.keys(i).length&&(console.log("Reparsing messages!",Object.keys(i).length),i=await this.reparseMessages(i)),s={...s,...i},ze[e].messages=s;const r=performance.now();return r-t>200&&console.warn("getParseSegment took",e,r-t,Object.keys(s).length),ze[e]}decacheMessageId(e){Object.keys(ze).forEach(t=>{ze[t].messages[e]&&(ze[t].messages[e].lastUpdated=0)})}async reparseMessages(e){const t=e,{dbc:n}=this.state;return n.lastUpdated=n.lastUpdated||Date.now(),Object.keys(t).forEach(e=>{t[e].frame=n.getMessageFrame(t[e].address)}),new Promise((e,a)=>{const s=new Ke;s.onmessage=t=>{const a=t.data.messages;Object.keys(a).forEach(e=>{a[e].lastUpdated=n.lastUpdated,a[e].frame=n.getMessageFrame(a[e].address)}),e(a)},s.postMessage({messages:t,dbcText:n.text(),canStartTime:this.state.firstCanTime})})}parseMessageEntry(e,t,n){const a=e;t.lastUpdated=t.lastUpdated||Date.now(),a.lastUpdated=t.lastUpdated,a.frame=t.getMessageFrame(a.address);let s=n||null;const i=[];return a.entries=a.entries.map(e=>(s=e.hexData?A.a.reparseMessage(t,e,s):A.a.parseMessage(t,e.time,e.address,e.data,e.timeStart,s),i.push(s.byteStateChangeCounts),s=s.msgEntry,s)),a.byteStateChangeCounts=i.reduce((e,t)=>e?e.map((e,n)=>t[n]+e):t,null),a}showingModal(){const{showOnboarding:e,showLoadDbc:t,showSaveDbc:n,showAddSignal:a,showEditMessageModal:s}=this.state;return e||t||n||a||s}showOnboarding(){!p.a.isAuthenticated()&&window.sessionStorage&&window.location&&window.location.pathname!==m.config.AUTH_PATH&&window.sessionStorage.setItem("onboardingPath",window.location.href),this.setState({showOnboarding:!0})}hideOnboarding(){this.setState({showOnboarding:!1})}showLoadDbc(){this.setState({showLoadDbc:!0})}hideLoadDbc(){this.setState({showLoadDbc:!1})}showSaveDbc(){this.setState({showSaveDbc:!0})}hideSaveDbc(){this.setState({showSaveDbc:!1})}updateMessageFrame(e,t){const{messages:n}=this.state;n[e].frame=t,this.setState({messages:n})}persistDbc(e){let{dbcFilename:t,dbc:n}=e;const{route:a}=this.state;persistDbc(a?a.fullname:"live",{dbcFilename:t,dbc:n}),this.loadMessagesFromCache()}onConfirmedSignalChange(e,t){const{dbc:n,dbcFilename:a}=this.state,s=A.a.maxMessageSize(e);n.setSignals(e.address,{...t},s),this.persistDbc({dbcFilename:a,dbc:n}),this.updateMessageFrame(e.id,n.getMessageFrame(e.address)),this.setState({dbc:n,dbcText:n.text()},()=>{this.decacheMessageId(e.id),this.loadMessagesFromCache()})}onPartChange(e){let{currentParts:t,currentPart:n,canFrameOffset:a,route:s}=this.state;if(-1===a||e===n)return;let i=Math.min(s.proclog,e+1);const r=Math.max(0,i-b.g+1);0===r&&(i=Math.min(s.proclog,2)),t=[r,i],n=e,n===this.state.currentPart&&t[0]===this.state.currentParts[0]&&t[1]===this.state.currentParts[1]||this.setState({currentParts:t,currentPart:n},this.partChangeDebounced)}showEditMessageModal(e){const t=this.state.messages[e];console.log(t),t.frame||(t.frame=this.state.dbc.createFrame(t.address)),this.setState({showEditMessageModal:!0,editMessageModalMessage:e,messages:this.state.messages,dbcText:this.state.dbc.text()})}hideEditMessageModal(){this.setState({showEditMessageModal:!1})}onMessageFrameEdited(e){const{messages:t,dbcFilename:n,dbc:a,editMessageModalMessage:s}=this.state,i={...t[s]};i.frame=e,a.messages.set(e.id,e),this.persistDbc({dbcFilename:n,dbc:a}),t[s]=i,this.setState({messages:t,dbc:a,dbcText:a.text()}),this.hideEditMessageModal()}onSeek(e,t){this.setState({seekIndex:e,seekTime:t});const{currentPart:n}=this.state,a=~~(t/60);a!==n&&this.onPartChange(a)}onUserSeek(e){b.k&&this.unloggerClient.seek(this.props.dongleId,this.props.name,e);const t=this.state.messages[this.state.selectedMessage];let n;t?(n=t.entries.findIndex(t=>t.relTime>=e),-1===n&&(n=0)):n=0,this.onSeek(n,e)}onMessageSelected(e){let{seekTime:t,seekIndex:n,messages:a}=this.state;const s=a[e];t>0&&s.entries.length>0&&(n=s.entries.findIndex(e=>e.relTime>=t),-1===n&&(n=0),t=s.entries[n].relTime),this.setState({seekTime:t,seekIndex:n,selectedMessage:e})}updateSelectedMessages(e){this.setState({selectedMessages:e})}onMessageUnselected(e){this.setState({selectedMessage:null})}loginWithGithub(){const{route:e}=this.state;return s.a.createElement("a",{href:authorizeUrl(e&&e.fullname?e.fullname:""),className:"button button--dark button--inline"},s.a.createElement("i",{className:"fa fa-github"}),s.a.createElement("span",null," Log in with Github"))}lastMessageEntriesById(e,t){let[n,a]=t;return e[n]=a.entries[a.entries.length-1],e}processStreamedCanMessages(e){const{dbcText:t}=this.state,{firstCanTime:n,lastBusTime:a,messages:s,maxByteStateChangeCount:i}=this.state,r=Object.entries(s).reduce(this.lastMessageEntriesById,{}),o=Object.entries(s).reduce((e,t)=>{let[n,a]=t;return e[n]=a.byteStateChangeCounts,e},{});this.canStreamerWorker.postMessage({newCanMessages:e,prevMsgEntries:r,firstCanTime:n,dbcText:t,lastBusTime:a,byteStateChangeCountsByMessage:o,maxByteStateChangeCount:i})}firstEntryIndexInsideStreamingWindow(e){const t=e[e.length-1].relTime-b.h;for(let n=0;n<e.length;n++)if(e[n].relTime>t)return n;return 0}enforceStreamingMessageWindow(e){const t=Object.keys(e);for(let n=0;n<t.length;n++){const a=t[n],s=e[a];if(s.entries.length<2)continue;if(s.entries[s.entries.length-1].relTime-s.entries[0].relTime>b.h){const t=this.firstEntryIndexInsideStreamingWindow(s.entries);s.entries=s.entries.slice(t),e[a]=s}}return e}_onStreamedCanMessagesProcessed(e){let{newMessages:t,seekTime:n,lastBusTime:a,firstCanTime:s,maxByteStateChangeCount:i}=e;i<this.state.maxByteStateChangeCount&&(i=this.state.maxByteStateChangeCount);let r=this.addAndRehydrateMessages(t);r=this.enforceStreamingMessageWindow(r);let{seekIndex:o,selectedMessages:l}=this.state;l.length>0&&void 0!==r[l[0]]&&(o=Math.max(0,r[l[0]].entries.length-1)),this.setState({messages:r,seekTime:n,seekIndex:o,lastBusTime:a,firstCanTime:s,maxByteStateChangeCount:i})}onStreamedCanMessagesProcessed(e){this._onStreamedCanMessagesProcessed(e.data)}async handlePandaConnect(e){this.setState({attemptingPandaConnection:!0,live:!0});const t=fetchPersistedDbc("live");if(t){const{dbc:e,dbcText:n}=t;this.setState({dbc:e,dbcText:n})}this.canStreamerWorker=new We,this.canStreamerWorker.onmessage=this.onStreamedCanMessagesProcessed;const n=this.pandaReader.onError(e=>{console.error(e.stack||e),this.setState({attemptingPandaConnection:!1})});try{await this.pandaReader.start(),this.setState({showOnboarding:!1,showLoadDbc:!0})}catch(e){}this.setState({attemptingPandaConnection:!1}),n()}githubSignOut(e,t){!function unpersistGithubAuthToken(){window.localStorage.removeItem("gh_auth_token")}(),this.setState({isGithubAuthenticated:!1}),e.preventDefault()}render(){const{route:e,messages:t,selectedMessages:n,currentParts:a,dbcFilename:i,dbcLastSaved:r,seekTime:o,seekIndex:c,shareUrl:u,maxByteStateChangeCount:g,live:h,thumbnails:m,selectedMessage:p,canFrameOffset:S,firstCanTime:f,currentPart:b,partsLoaded:v,share:_}=this.state,{startTime:E,segments:y}=this.props;return s.a.createElement("div",{id:"cabana",className:d()({"is-showing-modal":this.showingModal()})},s.a.createElement("div",{className:"cabana-header"},s.a.createElement("a",{className:"cabana-header-logo",href:"/"},"Comma Cabana"),s.a.createElement("div",{className:"cabana-header-account"},this.state.isGithubAuthenticated?s.a.createElement("div",null,s.a.createElement("p",null,"GitHub Authenticated"),s.a.createElement("p",{className:"cabana-header-account-signout",onClick:this.githubSignOut},"Sign out")):this.loginWithGithub())),s.a.createElement("div",{className:"cabana-window"},s.a.createElement(Z,{url:this.state.route?e.url:null,messages:t,selectedMessages:n,updateSelectedMessages:this.updateSelectedMessages,showEditMessageModal:this.showEditMessageModal,currentParts:a,onMessageSelected:this.onMessageSelected,onMessageUnselected:this.onMessageUnselected,showLoadDbc:this.showLoadDbc,showSaveDbc:this.showSaveDbc,dbcFilename:i,dbcLastSaved:r,dongleId:this.props.dongleId,name:this.props.name,route:e,seekTime:o,seekIndex:c,shareUrl:u,maxByteStateChangeCount:g,live:h,saveLog:debounce(this.downloadLogAsCSV,500)}),e||h?s.a.createElement(Ce,{url:e?e.url:null,live:h,messages:t,thumbnails:m,selectedMessage:p,onConfirmedSignalChange:this.onConfirmedSignalChange,onSeek:this.onSeek,onUserSeek:this.onUserSeek,canFrameOffset:S,firstCanTime:f,seekTime:o,startTime:E,startSegments:y,seekIndex:c,currentParts:a,selectedPart:b,partsLoaded:v,autoplay:this.props.autoplay,showEditMessageModal:this.showEditMessageModal,onPartChange:this.onPartChange,routeStartTime:e?e.start_time:l()(),videoOffset:this.state.firstFrameTime&&this.state.routeInitTime?this.state.firstFrameTime-this.state.routeInitTime:0,partsCount:e?e.proclog:0,maxqcamera:e?e.maxqcamera:0,route:e,share:_}):null),this.state.showOnboarding?s.a.createElement(Me,{handlePandaConnect:this.handlePandaConnect,attemptingPandaConnection:this.state.attemptingPandaConnection,routes:this.state.routes}):null,this.state.showLoadDbc?s.a.createElement(Ue,{onDbcSelected:this.onDbcSelected,handleClose:this.hideLoadDbc,openDbcClient:this.openDbcClient,loginWithGithub:this.loginWithGithub()}):null,this.state.showSaveDbc?s.a.createElement(Le,{dbc:this.state.dbc,sourceDbcFilename:this.state.dbcFilename,onDbcSaved:this.onDbcSaved,handleClose:this.hideSaveDbc,openDbcClient:this.openDbcClient,hasGithubAuth:null!==this.props.githubAuthToken,loginWithGithub:this.loginWithGithub()}):null,this.state.showEditMessageModal?s.a.createElement(Be,{handleClose:this.hideEditMessageModal,handleSave:this.onMessageFrameEdited,message:this.state.messages[this.state.editMessageModalMessage]}):null)}}var Qe=n(249),Je=n.n(Qe);var Ze={init:function init(){var e={};"undefined"!==typeof __webpack_hash__&&(e.release=__webpack_hash__),Je.a.config("https://50006e5d91894f508dd288bbbf4585a6@sentry.io/185303",e).install()}},$e={max:10,name:"2021-09-29--13-46-36",dongleId:"4cf7a6ad03080c90",dbc:new V('\nCM_ "AUTOGENERATED FILE, DO NOT EDIT"\n\n\nCM_ "Imported file _comma.dbc starts here"\nBO_ 359 STEERING_IPAS_COMMA: 8 IPAS\n SG_ STATE : 7|4@0+ (1,0) [0|15] "" XXX\n SG_ ANGLE : 3|12@0- (1.5,0) [-510|510] "deg" XXX\n SG_ SET_ME_X10 : 23|8@0+ (1,0) [0|255] "" XXX\n SG_ SET_ME_X00 : 31|8@0+ (1,0) [0|255] "" XXX\n SG_ DIRECTION_CMD : 38|2@0+ (1,0) [0|3] "" XXX\n SG_ SET_ME_X40 : 47|8@0+ (1,0) [0|255] "" XXX\n SG_ SET_ME_X00 : 55|8@0+ (1,0) [0|255] "" XXX\n SG_ CHECKSUM : 63|8@0+ (1,0) [0|255] "" XXX\n\nCM BO_ STEERING_IPAS_COMMA "Copy of msg 614 so we can do angle control while the Park Assist ECU is connected (Panda spoofs 614 with 359 on connector J70). Note that addresses 0x266 and 0x167 are checksum-invariant";\n\n BO_ 512 GAS_COMMAND: 6 EON\n  SG_ GAS_COMMAND : 7|16@0+ (0.159375,-75.555) [0|1] "" INTERCEPTOR\n  SG_ GAS_COMMAND2 : 23|16@0+ (0.159375,-151.111) [0|1] "" INTERCEPTOR\n  SG_ ENABLE : 39|1@0+ (1,0) [0|1] "" INTERCEPTOR\n  SG_ COUNTER_PEDAL : 35|4@0+ (1,0) [0|15] "" INTERCEPTOR\n  SG_ CHECKSUM_PEDAL : 47|8@0+ (1,0) [0|255] "" INTERCEPTOR\n\n BO_ 513 GAS_SENSOR: 6 INTERCEPTOR\n  SG_ INTERCEPTOR_GAS : 7|16@0+ (0.159375,-75.555) [0|1] "" EON\n  SG_ INTERCEPTOR_GAS2 : 23|16@0+ (0.159375,-151.111) [0|1] "" EON\n  SG_ STATE : 39|4@0+ (1,0) [0|15] "" EON\n  SG_ COUNTER_PEDAL : 35|4@0+ (1,0) [0|15] "" EON\n  SG_ CHECKSUM_PEDAL : 47|8@0+ (1,0) [0|255] "" EON\n\n VAL_ 513 STATE 5 "FAULT_TIMEOUT" 4 "FAULT_STARTUP" 3 "FAULT_SCE" 2 "FAULT_SEND" 1 "FAULT_BAD_CHECKSUM" 0 "NO_FAULT" ;\n\n\nCM_ "Imported file _toyota_2017.dbc starts here"\nVERSION ""\n\n\nNS_ :\n    NS_DESC_\n    CM_\n    BA_DEF_\n    BA_\n    VAL_\n    CAT_DEF_\n    CAT_\n    FILTER\n    BA_DEF_DEF_\n    EV_DATA_\n    ENVVAR_DATA_\n    SGTYPE_\n    SGTYPE_VAL_\n    BA_DEF_SGTYPE_\n    BA_SGTYPE_\n    SIG_TYPE_REF_\n    VAL_TABLE_\n    SIG_GROUP_\n    SIG_VALTYPE_\n    SIGTYPE_VALTYPE_\n    BO_TX_BU_\n    BA_DEF_REL_\n    BA_REL_\n    BA_DEF_DEF_REL_\n    BU_SG_REL_\n    BU_EV_REL_\n    BU_BO_REL_\n    SG_MUL_VAL_\n\nBS_:\n\nBU_: XXX DSU HCU EPS IPAS CGW\n\nBO_ 36 KINEMATICS: 8 XXX\n SG_ ACCEL_Y : 33|10@0+ (0.03589,-18.375) [0|65535] "m/s^2" XXX\n SG_ YAW_RATE : 1|10@0+ (0.244,-125) [0|65535] "deg/sec" XXX\n SG_ STEERING_TORQUE : 17|10@0+ (1,-512) [0|65535] "" XXX\n\nBO_ 37 STEER_ANGLE_SENSOR: 8 XXX\n SG_ STEER_ANGLE : 3|12@0- (1.5,0) [-500|500] "deg" XXX\n SG_ STEER_FRACTION : 39|4@0- (0.1,0) [-0.7|0.7] "deg" XXX\n SG_ STEER_RATE : 35|12@0- (1,0) [-2000|2000] "deg/s" XXX\n\nBO_ 166 BRAKE: 8 XXX\n SG_ BRAKE_AMOUNT : 7|8@0+ (1,0) [0|255] "" XXX\n SG_ BRAKE_PEDAL : 23|8@0+ (1,0) [0|255] "" XXX\n\nBO_ 170 WHEEL_SPEEDS: 8 XXX\n SG_ WHEEL_SPEED_FR : 7|16@0+ (0.01,-67.67) [0|250] "kph" XXX\n SG_ WHEEL_SPEED_FL : 23|16@0+ (0.01,-67.67) [0|250] "kph" XXX\n SG_ WHEEL_SPEED_RR : 39|16@0+ (0.01,-67.67) [0|250] "kph" XXX\n SG_ WHEEL_SPEED_RL : 55|16@0+ (0.01,-67.67) [0|250] "kph" XXX\n\nBO_ 180 SPEED: 8 XXX\n SG_ ENCODER : 39|8@0+ (1,0) [0|255] "" XXX\n SG_ SPEED : 47|16@0+ (0.01,0) [0|250] "kph" XXX\n SG_ CHECKSUM : 63|8@0+ (1,0) [0|255] "" XXX\n\nBO_ 353 DSU_SPEED: 8 XXX\n SG_ FORWARD_SPEED : 15|16@0- (0.00390625,-30) [0|255] "kph" XXX\n\nBO_ 466 PCM_CRUISE: 8 XXX\n SG_ GAS_RELEASED : 4|1@0+ (1,0) [0|1] "" XXX\n SG_ CRUISE_ACTIVE : 5|1@0+ (1,0) [0|1] "" XXX\n SG_ STANDSTILL_ON : 12|1@0+ (1,0) [0|1] "" XXX\n SG_ ACCEL_NET : 23|16@0- (0.001,0) [-20|20] "m/s2" XXX\n SG_ CRUISE_STATE : 55|4@0+ (1,0) [0|15] "" XXX\n SG_ CANCEL_REQ : 49|1@1+ (1,0) [0|1] "" XXX\n SG_ CHECKSUM : 63|8@0+ (1,0) [0|255] "" XXX\n\nBO_ 467 PCM_CRUISE_2: 8 XXX\n SG_ MAIN_ON : 15|1@0+ (1,0) [0|1] "" XXX\n SG_ LOW_SPEED_LOCKOUT : 14|2@0+ (1,0) [0|3] "kph" XXX\n SG_ SET_SPEED : 23|8@0+ (1,0) [0|255] "kph" XXX\n SG_ CHECKSUM : 63|8@0+ (1,0) [0|255] "" XXX\n\nBO_ 552 ACCELEROMETER: 8 XXX\n SG_ ACCEL_Z : 22|15@0- (1,0) [0|32767] "" XXX\n SG_ ACCEL_X : 6|15@0- (0.001,0) [-20|20] "m/s2" XXX\n\nBO_ 560 BRAKE_MODULE2: 7 XXX\n SG_ BRAKE_PRESSED : 26|1@0+ (1,0) [0|1] "" XXX\n\nBO_ 614 STEERING_IPAS: 8 IPAS\n SG_ STATE : 7|4@0+ (1,0) [0|15] "" XXX\n SG_ ANGLE : 3|12@0- (1.5,0) [-510|510] "deg" XXX\n SG_ SET_ME_X10 : 23|8@0+ (1,0) [0|255] "" XXX\n SG_ SET_ME_X00 : 31|8@0+ (1,0) [0|255] "" XXX\n SG_ DIRECTION_CMD : 38|2@0+ (1,0) [0|3] "" XXX\n SG_ SET_ME_X40 : 47|8@0+ (1,0) [0|255] "" XXX\n SG_ SET_ME_X00_1 : 55|8@0+ (1,0) [0|255] "" XXX\n SG_ CHECKSUM : 63|8@0+ (1,0) [0|255] "" XXX\n\nBO_ 643 PRE_COLLISION: 7 DSU\n SG_ COUNTER : 7|8@0+ (1,0) [0|255] "" XXX\n SG_ SET_ME_X00 : 15|8@0+ (1,0) [0|255] "" XXX\n SG_ FORCE : 23|16@0- (2,0) [0|255] "N" XXX\n SG_ SET_ME_X002 : 33|8@0+ (1,0) [0|3] "" XXX\n SG_ BRAKE_STATUS : 39|3@0+ (1,0) [0|255] "" XXX\n SG_ STATE : 36|3@0+ (1,0) [0|255] "" XXX\n SG_ SET_ME_X003 : 40|1@0+ (1,0) [0|1] "" XXX\n SG_ PRECOLLISION_ACTIVE : 41|1@0+ (1,0) [0|255] "" XXX\n SG_ CHECKSUM : 55|8@0+ (1,0) [0|255] "" XXX\n\nBO_ 740 STEERING_LKA: 5 XXX\n SG_ LKA_STATE : 31|8@0+ (1,0) [0|255] "" XXX\n SG_ STEER_REQUEST : 0|1@0+ (1,0) [0|1] "" XXX\n SG_ COUNTER : 6|6@0+ (1,0) [0|63] "" XXX\n SG_ SET_ME_1 : 7|1@0+ (1,0) [0|1] "" XXX\n SG_ STEER_TORQUE_CMD : 15|16@0- (1,0) [0|65535] "" XXX\n SG_ CHECKSUM : 39|8@0+ (1,0) [0|255] "" XXX\n\nBO_ 742 LEAD_INFO: 8 DSU\n SG_ CHECKSUM : 63|8@0+ (1,0) [0|255] "" HCU\n SG_ LEAD_REL_SPEED : 23|12@0- (0.025,0) [-100|100] "m/s" HCU\n SG_ LEAD_LONG_DIST : 7|13@0+ (0.05,0) [0|300] "m" HCU\n\nBO_ 835 ACC_CONTROL: 8 DSU\n SG_ ACCEL_CMD : 7|16@0- (0.001,0) [-20|20] "m/s2" HCU\n SG_ SET_ME_X01 : 23|2@0+ (1,0) [0|3] "" HCU\n SG_ DISTANCE : 20|1@0+ (1,0) [0|1] "" XXX\n SG_ MINI_CAR : 21|1@0+ (1,0) [0|1] "" XXX\n SG_ SET_ME_X3 : 19|4@0+ (1,0) [0|15] "" XXX\n SG_ SET_ME_1 : 30|1@0+ (1,0) [0|1] "" HCU\n SG_ RELEASE_STANDSTILL : 31|1@0+ (1,0) [0|1] "" HCU\n SG_ CANCEL_REQ : 24|1@0+ (1,0) [0|1] "" HCU\n SG_ CHECKSUM : 63|8@0+ (1,0) [0|255] "" XXX\n\nBO_ 836 PRE_COLLISION_2: 8 DSU\n SG_ CHECKSUM : 63|8@0+ (1,0) [0|0] "" XXX\n\nBO_ 869 DSU_CRUISE : 7 DSU\n SG_ RES_BTN : 3|1@0+ (1,0) [0|0] "" XXX\n SG_ SET_BTN : 2|1@0+ (1,0) [0|0] "" XXX\n SG_ CANCEL_BTN : 1|1@0+ (1,0) [0|0] "" XXX\n SG_ MAIN_ON : 0|1@0+ (1,0) [0|0] "" XXX\n SG_ SET_SPEED : 15|8@0+ (1,0) [0|0] "km/h" XXX\n SG_ CRUISE_REQUEST : 31|8@0+ (100,-12800) [0|0] "N" XXX\n SG_ LEAD_DISTANCE : 39|8@0+ (1,0) [0|0] "m" XXX\n\nBO_ 921 PCM_CRUISE_SM: 8 XXX\n SG_ MAIN_ON : 4|1@0+ (1,0) [0|1] "" XXX\n SG_ CRUISE_CONTROL_STATE : 11|4@0+ (1,0) [0|15] "" XXX\n SG_ DISTANCE_LINES : 14|2@0+ (1,0) [0|3] "" XXX\n SG_ UI_SET_SPEED : 31|8@0+ (1,0) [0|255] "" XXX\n\nBO_ 951 ESP_CONTROL: 8 ESP\n SG_ TC_DISABLED : 13|1@0+ (1,0) [0|1] "" XXX\n SG_ VSC_DISABLED : 12|2@0+ (1,0) [0|1] "" XXX\n SG_ BRAKE_LIGHTS_ACC : 18|1@0+ (1,0) [0|1] "" XXX\n\nBO_ 1041 ACC_HUD: 8 DSU\n SG_ FCW : 4|1@0+ (1,0) [0|1] "" XXX\n SG_ SET_ME_X20 : 15|8@0+ (1,0) [0|1] "" XXX\n SG_ SET_ME_X10 : 39|8@0+ (1,0) [0|1] "" XXX\n SG_ SET_ME_X80 : 55|8@0+ (1,0) [0|1] "" XXX\n\nBO_ 1042 LKAS_HUD: 8 XXX\n SG_ BARRIERS : 1|2@0+ (1,0) [0|3] "" XXX\n SG_ RIGHT_LINE : 3|2@0+ (1,0) [0|3] "" XXX\n SG_ LEFT_LINE : 5|2@0+ (1,0) [0|3] "" XXX\n SG_ SET_ME_X01 : 7|2@0+ (1,0) [0|3] "" XXX\n SG_ SET_ME_X01_2 : 11|2@0+ (1,0) [0|3] "" XXX\n SG_ LDA_ALERT : 9|2@0+ (1,0) [0|3] "" XXX\n SG_ TWO_BEEPS : 12|1@0+ (1,0) [0|1] "" XXX\n SG_ ADJUSTING_CAMERA : 13|1@0+ (1,0) [0|1] "" XXX\n SG_ LDA_MALFUNCTION : 15|1@0+ (1,0) [0|1] "" XXX\n SG_ REPEATED_BEEPS : 32|1@0+ (1,0) [0|1] "" XXX\n SG_ SET_ME_X0C : 23|8@0+ (1,0) [0|1] "" XXX\n SG_ SET_ME_X2C : 47|8@0+ (1,0) [0|1] "" XXX\n SG_ SET_ME_X38 : 55|8@0+ (1,0) [0|1] "" XXX\n SG_ SET_ME_X02 : 63|8@0+ (1,0) [0|1] "" XXX\n\nBO_ 1043 TIME : 8 CGW\n SG_ YEAR : 7|8@0+ (1,0) [0|0] "year" XXX\n SG_ MONTH : 15|8@0+ (1,0) [0|0] "month" XXX\n SG_ DAY : 23|8@0+ (1,0) [0|0] "day" XXX\n SG_ HOUR : 31|8@0+ (1,0) [0|0] "hour" XXX\n SG_ MINUTE : 39|8@0+ (1,0) [0|0] "minute" XXX\n SG_ GMT_DIFF : 55|1@0+ (1,0) [0|0] "" XXX\n SG_ GMTDIFF_HOURS : 54|4@0+ (1,0) [0|0] "hours" XXX\n SG_ GMTDIFF_MINUTES : 50|6@0+ (1,0) [0|0] "minutes" XXX\n SG_ SUMMER : 60|1@0+ (1,0) [0|0] "" XXX\n\nBO_ 1408 VIN_PART_1: 8 CGW\n SG_ VIN_1 : 7|8@0+ (1,0) [0|0] "" XXX\n SG_ VIN_2 : 15|8@0+ (1,0) [0|0] "" XXX\n SG_ VIN_3 : 23|8@0+ (1,0) [0|0] "" XXX\n SG_ VIN_4 : 31|8@0+ (1,0) [0|0] "" XXX\n SG_ VIN_5 : 39|8@0+ (1,0) [0|0] "" XXX\n SG_ VIN_6 : 47|8@0+ (1,0) [0|0] "" XXX\n SG_ VIN_7 : 55|8@0+ (1,0) [0|0] "" XXX\n SG_ VIN_8 : 63|8@0+ (1,0) [0|0] "" XXX\n\nBO_ 1409 VIN_PART_2: 8 CGW\n SG_ VIN_9 : 7|8@0+ (1,0) [0|0] "" XXX\n SG_ VIN_10 : 15|8@0+ (1,0) [0|0] "" XXX\n SG_ VIN_11 : 23|8@0+ (1,0) [0|0] "" XXX\n SG_ VIN_12 : 31|8@0+ (1,0) [0|0] "" XXX\n SG_ VIN_13 : 39|8@0+ (1,0) [0|0] "" XXX\n SG_ VIN_14 : 47|8@0+ (1,0) [0|0] "" XXX\n SG_ VIN_15 : 55|8@0+ (1,0) [0|0] "" XXX\n SG_ VIN_16 : 63|8@0+ (1,0) [0|0] "" XXX\n\nBO_ 1410 VIN_PART_3: 8 CGW\n SG_ VIN_17 : 7|8@0+ (1,0) [0|0] "" XXX\n\nBO_ 1553 UI_SETTING: 8 XXX\n SG_ UNITS : 26|2@0+ (1,0) [0|3] "" XXX\n\nBO_ 1556 STEERING_LEVERS: 8 XXX\n SG_ TURN_SIGNALS : 29|2@0+ (1,0) [0|3] "" XXX\n\nBO_ 1568 SEATS_DOORS: 8 XXX\n SG_ SEATBELT_DRIVER_UNLATCHED : 62|1@0+ (1,0) [0|1] "" XXX\n SG_ DOOR_OPEN_FL : 45|1@0+ (1,0) [0|1] "" XXX\n SG_ DOOR_OPEN_RL : 42|1@0+ (1,0) [0|1] "" XXX\n SG_ DOOR_OPEN_RR : 43|1@0+ (1,0) [0|1] "" XXX\n SG_ DOOR_OPEN_FR : 44|1@0+ (1,0) [0|1] "" XXX\n\nBO_ 1570 LIGHT_STALK: 8 SCM\n SG_ AUTO_HIGH_BEAM : 37|1@0+ (1,0) [0|1] "" XXX\n\nBO_ 1161 RSA1: 8 FCM\n SG_ TSGN1 : 7|8@0+ (1,0) [0|0] "" XXX\n SG_ TSGNGRY1 : 12|3@0+ (1,0) [0|0] "" XXX\n SG_ TSGNHLT1 : 9|2@0+ (1,0) [0|0] "" XXX\n SG_ SPDVAL1 : 23|8@0+ (1,0) [0|0] "kph" XXX\n SG_ SPLSGN1 : 31|4@0+ (1,0) [0|0] "" XXX\n SG_ SPLSGN2 : 27|4@0+ (1,0) [0|0] "" XXX\n SG_ TSGN2 : 39|8@0+ (1,0) [0|0] "" XXX\n SG_ TSGNGRY2 : 44|3@0+ (1,0) [0|0] "" XXX\n SG_ TSGNHLT2 : 41|2@0+ (1,0) [0|0] "" XXX\n SG_ SPDVAL2 : 55|8@0+ (1,0) [0|0] "" XXX\n SG_ BZRRQ_P : 63|2@0+ (1,0) [0|0] "" XXX\n SG_ BZRRQ_A : 61|2@0+ (1,0) [0|0] "" XXX\n SG_ SYNCID1 : 59|4@0+ (1,0) [0|0] "" XXX\n\nBO_ 1162 RSA2: 8 FCM\n SG_ TSGN3 : 7|8@0+ (1,0) [0|0] "" XXX\n SG_ TSGNGRY3 : 12|3@0+ (1,0) [0|0] "" XXX\n SG_ TSGNHLT3 : 9|2@0+ (1,0) [0|0] "" XXX\n SG_ SPLSGN3 : 31|4@0+ (1,0) [0|0] "" XXX\n SG_ SPLSGN4 : 27|4@0+ (1,0) [0|0] "" XXX\n SG_ TSGN4 : 39|8@0+ (1,0) [0|0] "" XXX\n SG_ TSGNGRY4 : 44|3@0+ (1,0) [0|0] "" XXX\n SG_ TSGNHLT4 : 41|2@0+ (1,0) [0|0] "" XXX\n SG_ DPSGNREQ : 54|1@0+ (1,0) [0|0] "" XXX\n SG_ SGNNUMP : 53|3@0+ (1,0) [0|0] "" XXX\n SG_ SGNNUMA : 50|3@0+ (1,0) [0|0] "" XXX\n SG_ SPDUNT : 63|2@0+ (1,0) [0|0] "" XXX\n SG_ TSRWMSG : 61|2@0+ (1,0) [0|0] "" XXX\n SG_ SYNCID2 : 59|4@0+ (1,0) [0|0] "" XXX\n\nBO_ 1163 RSA3: 8 FCM\n SG_ TSREQPD : 7|1@0+ (1,0) [0|0] "" XXX\n SG_ TSRMSW : 6|1@0+ (1,0) [0|0] "" XXX\n SG_ OTSGNNTM : 5|2@0+ (1,0) [0|0] "" XXX\n SG_ NTLVLSPD : 3|2@0+ (1,0) [0|0] "" XXX\n SG_ OVSPNTM : 1|2@0+ (1,0) [0|0] "" XXX\n SG_ OVSPVALL : 11|4@0+ (1,-5) [0|0] "" XXX\n SG_ OVSPVALM : 19|4@0+ (1,-5) [0|0] "" XXX\n SG_ OVSPVALH : 27|4@0+ (1,-5) [0|0] "" XXX\n SG_ TSRSPU : 33|2@0+ (1,0) [0|0] "" XXX\n\nCM_ SG_ 36 ACCEL_Y "unit is tbd";\nCM_ SG_ 36 YAW_RATE "verify";\nCM_ SG_ 36 STEERING_TORQUE "does not seem the steer torque, tbd";\nCM_ SG_ 37 STEER_FRACTION "1/15th of the signal STEER_ANGLE, which is 1.5 deg; note that 0x8 is never set";\nCM_ SG_ 37 STEER_RATE "factor is tbd";\nCM_ SG_ 466 ACCEL_NET "net acceleration produced by the system, given ACCEL_CMD, road grade and other factors";\nCM_ SG_ 467 SET_SPEED "43 kph are shown as 28mph, so conversion isnt perfect";\nCM_ SG_ 467 LOW_SPEED_LOCKOUT "in low speed lockout, system would always disengage below 28mph";\nCM_ SG_ 560 BRAKE_PRESSED "another brake pressed?";\nCM_ SG_ 608 STEER_TORQUE_DRIVER "driver torque";\nCM_ SG_ 608 STEER_OVERRIDE "set when driver torque exceeds a certain value";\nCM_ SG_ 614 ANGLE "set to measured angle when ipas control isn\'t active";\nCM_ SG_ 643 COUNTER "only used on cars that use this msg for cruise control";\nCM_ SG_ 643 BRAKE_STATUS "only used on cars that use this msg for cruise control";\nCM_ SG_ 643 PRECOLLISION_ACTIVE "set 0.5s before any braking";\nCM_ SG_ 921 UI_SET_SPEED "set speed shown in UI with user set unit";\nCM_ SG_ 951 BRAKE_LIGHTS_ACC "brake lights when ACC commands decel";\nCM_ SG_ 1042 SET_ME_1 "unclear what this is, but it\'s always 1 in drive traces";\nCM_ SG_ 1042 REPEATED_BEEPS "recommended for fcw and other important alerts";\nCM_ SG_ 1161 SPDVAL1 "Numbers 0-199 is displayed, 200-254 displays circle without number and 255 is for no limit.";\nCM_ SG_ 1161 SYNCID1 "counter from 1 to f at 1 Hz";\nCM_ SG_ 1161 SPDVAL2 "conditional speed value 70"\nCM_ SG_ 1162 SGNNUMP "1 if SPDVAL1 is set, otherwise 0";\nCM_ SG_ 1162 SYNCID2 "counter from 1 to f at 1 Hz";\nCM_ SG_ 1163 TSREQPD "always 1";\nCM_ SG_ 1163 TSRMSW "always 1";\nCM_ SG_ 1163 OTSGNNTM "always 3";\nCM_ SG_ 1163 NTLVLSPD "always 3";\nCM_ SG_ 1163 OVSPNTM "always 3";\nCM_ SG_ 1163 OVSPVALL "-5 at start then 2 after 2 seconds";\nCM_ SG_ 1163 OVSPVALM "-5 at start then 5 after 2 seconds";\nCM_ SG_ 1163 OVSPVALH "-5 at start then 10 after 2 seconds";\nCM_ SG_ 1163 TSRSPU "always 1";\n\nVAL_ 466 CRUISE_STATE 8 "active" 7 "standstill" 1 "off";\nVAL_ 467 LOW_SPEED_LOCKOUT 2 "low speed locked" 1 "ok";\nVAL_ 614 STATE 3 "enabled" 1 "disabled";\nVAL_ 614 DIRECTION_CMD 3 "right" 2 "center" 1 "left";\nVAL_ 643 STATE 0 "normal" 1 "adaptive_cruise_control" 3 "emergency_braking";\nVAL_ 921 CRUISE_CONTROL_STATE 2 "disabled" 11 "hold" 10 "hold_waiting_user_cmd" 6 "enabled" 5 "faulted";\nVAL_ 1042 LDA_ALERT 3 "hold with continuous beep" 2 "LDA unavailable" 1 "hold" 0 "none";\nVAL_ 1042 BARRIERS 3 "both" 2 "right" 1 "left" 0 "none";\nVAL_ 1042 RIGHT_LINE 3 "orange" 2 "faded" 1 "solid" 0 "none";\nVAL_ 1042 LEFT_LINE 3 "orange" 2 "faded" 1 "solid" 0 "none";\nVAL_ 1553 UNITS 1 "km" 2 "miles";\nVAL_ 1556 TURN_SIGNALS 3 "none" 2 "right" 1 "left";\nVAL_ 1161 TSGN1 1 "speed sign" 0 "none";\nVAL_ 1161 TSGN2 1 "speed sign" 0 "none";\nVAL_ 1161 SPLSGN2 15 "conditional blank" 4 "wet road" 5 "rain" 0 "none";\nVAL_ 1162 TSGN3 0 "none" 1 "speed sign" 2 "0 unlimited" 7 "unlimited" 16 "highway" 17 "no highway" 18 "motorway" 19 "no motorway" 20 "in city" 21 "outside city" 22 "pedestrian area" 23 "no pedestrian area" 65 "no overtaking left" 66 "no overtaking right" 67 "overtaking allowed again" 129 "no entry";\nVAL_ 1162 SPLSGN3 15 "conditional blank" 4 "wet road" 5 "rain" 0 "none";\n\n\nCM_ "CHFFR_METRIC 37 STEER_ANGLE STEER_ANGLE 0.36 180";\n\nCM_ "toyota_nodsu_pt.dbc starts here"\n\n\n\nBO_ 401 STEERING_LTA: 8 XXX\n SG_ COUNTER : 7|8@0+ (1,0) [0|255] "" XXX\n SG_ CHECKSUM : 63|8@0+ (1,0) [0|255] "" XXX\n SG_ SETME_X3 : 29|2@0+ (1,0) [0|3] "" XXX\n SG_ PERCENTAGE : 39|8@0+ (1,0) [0|255] "" XXX\n SG_ SETME_X64 : 47|8@0+ (1,0) [0|255] "" XXX\n SG_ ANGLE : 55|8@0- (0.5,0) [0|255] "" XXX\n SG_ STEER_ANGLE_CMD : 15|16@0- (0.0573,0) [-540|540] "" XXX\n SG_ STEER_REQUEST : 25|1@0+ (1,0) [0|1] "" XXX\n SG_ BIT : 30|1@0+ (1,0) [0|1] "" XXX\n\nBO_ 550 BRAKE_MODULE: 8 XXX\n SG_ BRAKE_PRESSURE : 0|9@0+ (1,0) [0|511] "" XXX\n SG_ BRAKE_POSITION : 16|9@0+ (1,0) [0|511] "" XXX\n SG_ BRAKE_PRESSED : 37|1@0+ (1,0) [0|1] "" XXX\n\nBO_ 705 GAS_PEDAL: 8 XXX\n SG_ GAS_RELEASED : 3|1@0+ (1,0) [0|1] "" XXX\n SG_ GAS_PEDAL : 55|8@0+ (0.005,0) [0|1] "" XXX\n\nBO_ 608 STEER_TORQUE_SENSOR: 8 XXX\n SG_ STEER_TORQUE_EPS : 47|16@0- (0.73,0) [-20000|20000] "" XXX\n SG_ STEER_TORQUE_DRIVER : 15|16@0- (1,0) [-32768|32767] "" XXX\n SG_ STEER_OVERRIDE : 0|1@0+ (1,0) [0|1] "" XXX\n SG_ CHECKSUM : 63|8@0+ (1,0) [0|255] "" XXX\n SG_ STEER_ANGLE : 31|16@0- (0.0573,0) [-500|500] "" XXX\n\nBO_ 610 EPS_STATUS: 8 EPS\n SG_ IPAS_STATE : 3|4@0+ (1,0) [0|15] "" XXX\n SG_ LKA_STATE : 31|7@0+ (1,0) [0|127] "" XXX\n SG_ TYPE : 24|1@0+ (1,0) [0|1] "" XXX\n SG_ CHECKSUM : 63|8@0+ (1,0) [0|255] "" XXX\n\nBO_ 956 GEAR_PACKET: 8 XXX\n SG_ SPORT_ON : 2|1@0+ (1,0) [0|1] "" XXX\n SG_ GEAR : 13|6@0+ (1,0) [0|63] "" XXX\n SG_ ECON_ON : 40|1@0+ (1,0) [0|1] "" XXX\n\nCM_ SG_ 548 BRAKE_PRESSURE "seems prop to pedal force";\nCM_ SG_ 548 BRAKE_POSITION "seems proportional to pedal displacement, unclear the max value of 0x1c8";\nCM_ SG_ 610 TYPE "seems 1 on Corolla, 0 on all others";\nVAL_ 610 IPAS_STATE 5 "override" 3 "enabled" 1 "disabled";\nVAL_ 610 LKA_STATE 25 "temporary_fault" 9 "temporary_fault2" 5 "active" 1 "standby";\nVAL_ 956 GEAR 0 "D" 1 "S" 8 "N" 16 "R" 32 "P";\nVAL_ 956 SPORT_ON 0 "off" 1 "on";\nVAL_ 956 ECON_ON 0 "off" 1 "on";\n'),isDemo:!0,dbcFilename:"toyota_new_mc_pt_generated.dbc"};function _authenticate(){return(_authenticate=Object(De.a)(Xe.a.mark((function _callee(){var e,t,n,a,s,i;return Xe.a.wrap((function _callee$(r){for(;;)switch(r.prev=r.next){case 0:if(!window.location||window.location.pathname!==m.config.AUTH_PATH){r.next=12;break}return r.prev=1,e=Oe.a.parse(window.location.search),t=e.code,n=e.provider,r.next=5,S.auth.refreshAccessToken(t,n);case 5:(a=r.sent)&&(m.storage.setCommaAccessToken(a),window.sessionStorage&&(s=window.sessionStorage.getItem("onboardingPath"))&&(window.sessionStorage.removeItem("onboardingPath"),window.location=s)),r.next=12;break;case 9:r.prev=9,r.t0=r.catch(1),console.log(r.t0);case 12:return r.next=14,p.a.init();case 14:(i=r.sent)&&S.request.configure(i);case 16:case"end":return r.stop()}}),_callee,null,[[1,9]])})))).apply(this,arguments)}n(527);(function init_init(){Ze.init();var e=Object(v.a)("route"),t=!!Object(v.a)("demo"),n=Object(v.a)("segments");n&&n.length&&2!==(n=n.split(",").map(Number)).length&&(n=void 0);var a={autoplay:!0,startTime:Number(Object(v.a)("seekTime")||0),segments:n,isDemo:t},s=null;if(e){var i=e.split("|"),r=Object(_.a)(i,2),o=r[0],l=r[1];a.dongleId=o,a.name=l,s=fetchPersistedDbc(e);var c=Object(v.a)("max"),d=Object(v.a)("url"),u=Object(v.a)("exp"),g=Object(v.a)("sig");c&&(a.max=parseInt(c)),d&&(a.url=d),u&&(a.exp=u),g&&(a.sig=g),a.isLegacyShare=c&&d&&!u&&!g,a.isShare=c&&d&&u&&g}else t&&(a=Object(te.a)(Object(te.a)({},a),$e));if(s){var h=s,m=h.dbcFilename,p=h.dbc;a.dbc=p,a.dbcFilename=m}var S=Object(v.a)(b.c);if(null!==S){a.githubAuthToken=S,function persistGithubAuthToken(e){return window.localStorage.setItem("gh_auth_token",e)}(S);var f=Object(v.b)({remove:[b.c]});window.location.href=f}else a.githubAuthToken=function fetchPersistedGithubAuthToken(){return window.localStorage.getItem("gh_auth_token")}();return new Promise((function(e){(function authenticate(){return _authenticate.apply(this,arguments)})().then((function(){e(a)}))}))})().then((function(e){r.a.render(s.a.createElement(qe,e),document.getElementById("root"))}))},69:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(10),s=n(3),i=n(4),r=n(235),o=n.n(r),l=n(14),c=function(){function Signal(e){var t=e.name,n=e.startBit,a=void 0===n?0:n,i=e.size,r=void 0===i?0:i,o=e.isLittleEndian,l=void 0===o||o,c=e.isSigned,d=void 0!==c&&c,u=e.isFloat,g=void 0!==u&&u,h=e.factor,m=void 0===h?1:h,p=e.offset,S=void 0===p?0:p,f=e.unit,b=void 0===f?"":f,v=e.receiver,_=void 0===v?["XXX"]:v,E=e.comment,y=void 0===E?null:E,C=e.multiplex,T=void 0===C?null:C,O=e.min,k=void 0===O?null:O,M=e.max,A=void 0===M?null:M,X=e.valueDescriptions,D=void 0===X?new Map:X;Object(s.a)(this,Signal),Object.assign(this,{name:t,startBit:a,size:r,isLittleEndian:l,isSigned:d,isFloat:g,factor:m,offset:S,unit:b,receiver:_,comment:y,multiplex:T,valueDescriptions:D});var N=Math.random().toString(36);null==k&&(k=this.calculateMin()),null==A&&(A=this.calculateMax());var I=this.generateColors();Object.assign(this,{min:k,max:A,uid:N,_colors:I}),Object.defineProperty(this,"colors",{get:function get(){return console.error("Something is still using the old colors"),I},enumberable:!1})}return Object(i.a)(Signal,[{key:"text",value:function text(){var e=this.multiplex?" ".concat(this.multiplex):"",t=this.isLittleEndian?1:0,n=this.isSigned?"-":"+";return"SG_ ".concat(this.name).concat(e," : ")+"".concat(this.startBit,"|").concat(this.size,"@").concat(t).concat(n)+" (".concat(this.factor,",").concat(this.offset,")")+" [".concat(this.min,"|").concat(this.max,"]")+' "'.concat(this.unit,'" ').concat(this.receiver)}},{key:"valueDescriptionText",value:function valueDescriptionText(e){var t=Array.from(this.valueDescriptions.entries()).reduce((function(e,t){var n=Object(a.a)(t,2),s=n[0],i=n[1];return"".concat(e+s,' "').concat(i,'" ')}),"");return"VAL_ ".concat(e," ").concat(this.name," ").concat(t,";")}},{key:"lsbBitIndex",value:function lsbBitIndex(){if(this.isLittleEndian)return this.startBit;var e=this.lsbBitNumber();return l.a.matrixBitNumber(e)}},{key:"lsbBitNumber",value:function lsbBitNumber(){return l.a.bigEndianBitIndex(this.startBit)+this.size-1}},{key:"msbBitIndex",value:function msbBitIndex(){return this.isLittleEndian?this.startBit+this.size-1:this.startBit}},{key:"littleEndianBitDescription",value:function littleEndianBitDescription(e){var t=[this.startBit,this.startBit+this.size-1];return e<t[0]||e>t[1]?null:{bitNumber:e-t[0],isLsb:e===t[0],isMsb:e===t[1]}}},{key:"bigEndianBitDescription",value:function bigEndianBitDescription(e){var t=l.a.bigEndianBitIndex(this.startBit),n=[t,t+this.size-1],a=l.a.bigEndianBitIndex(e);return a<n[0]||a>n[1]?null:{bitNumber:a,isLsb:a===n[1],isMsb:e===this.startBit,range:n}}},{key:"bitDescription",value:function bitDescription(e){return this.isLittleEndian?this.littleEndianBitDescription(e):this.bigEndianBitDescription(e)}},{key:"calculateRawRange",value:function calculateRawRange(){var e=Math.pow(2,this.size);return this.isSigned&&(e/=2),[this.isSigned?-1*e:0,e-1]}},{key:"calculateMin",value:function calculateMin(){var e=this.calculateRawRange()[0];return this.offset+e*this.factor}},{key:"calculateMax",value:function calculateMax(){var e=this.calculateRawRange()[1];return this.offset+e*this.factor}},{key:"getColors",value:function getColors(e){var t=e.split(":").map((function(e){return 3*(3+Number.parseInt(e,16))%253})),n=this._colors||this.generateColors(),a=0;return n.map((function(e){return t=t.map((function(e){return e^a})),a=t.reduce((function(e,t){return e^t}),e)}))}},{key:"generateColors",value:function generateColors(){return o()({format:"rgbArray"})}},{key:"equals",value:function equals(e){var t=this;return e.name===this.name&&e.startBit===this.startBit&&e.size===this.size&&e.isLittleEndian===this.isLittleEndian&&e.isSigned===this.isSigned&&e.isFloat===this.isFloat&&e.factor===this.factor&&e.offset===this.offset&&e.unit===this.unit&&e.receiver.length===this.receiver.length&&e.receiver.every((function(e,n){return e===t.receiver[n]}))&&e.comment===this.comment&&e.multiplex===this.multiplex}}]),Signal}()},80:function(e,t,n){"use strict";if("undefined"===typeof a)var a=self;var s=function _indexOf(e,t){for(var n=0;n<e.length;n++)if(t===e[n])return n;return-1};function LogStream(e){var t,n=e.trace?(Math.random()+Math.PI).toString(36).substring(2,10):null,i=e.page_info,r=e.token,o=e.print,l=e.no_format,c="undefined"===typeof XDomainRequest?e.ssl:"https:"===a.location.protocol;t=(c?"https://":"http://")+(t=a.LEENDPOINT?a.LEENDPOINT:l?"webhook.logentries.com/noformat":"js.logentries.com/v1")+"/logs/"+r;var d=[],u=!1,g=!1,h=function _apiCall(e,n){u=!0;var a=function _getAjaxObject(){return"undefined"!==typeof XDomainRequest?new XDomainRequest:new XMLHttpRequest}();a.constructor===XMLHttpRequest?a.onreadystatechange=function(){4===a.readyState&&(a.status>=400?(console.error("Couldn't submit events."),410===a.status&&console.warn("This version of le_js is no longer supported!")):(301===a.status&&console.warn("This version of le_js is deprecated! Consider upgrading."),d.length>0?_apiCall(e,d.shift()):u=!1))}:a.onload=function(){d.length>0?_apiCall(e,d.shift()):u=!1},a.open("POST",t,!0),a.constructor===XMLHttpRequest&&(a.setRequestHeader("X-Requested-With","XMLHttpRequest"),a.setRequestHeader("Content-type","application/json")),a.overrideMimeType&&a.overrideMimeType("text"),a.send(n)},m=function _getEvent(){var e=Array.prototype.slice.call(arguments);if(0===e.length)throw new Error("No arguments!");return 1===e.length?e[0]:e},p=function _agentInfo(){var e=a.navigator||{doNotTrack:void 0},t=a.screen||{};return{url:(a.location||{}).pathname,referrer:document.referrer,screen:{width:t.width,height:t.height},window:{width:a.innerWidth,height:a.innerHeight},browser:{name:e.appName,version:e.appVersion,cookie_enabled:e.cookieEnabled,do_not_track:e.doNotTrack},platform:e.platform}},S=function _rawLog(e){var t=m.apply(this,arguments),a={event:t};return"never"!==i&&(g&&"per-entry"!==i||(g=!0,"undefined"===typeof t.screen&&"undefined"===typeof t.browser&&_rawLog(p()).level("PAGE").send())),n&&(a.trace=n),{level:function level(e){if(o&&"undefined"!==typeof console&&"PAGE"!==e){var t=null;"undefined"!==typeof XDomainRequest&&(t=a.trace+" "+a.event);try{console[e.toLowerCase()].call(console,t||a)}catch(n){console.log(t||a)}}return a.level=e,{send:function send(){var e=[],t=JSON.stringify(a,(function(t,n){if("undefined"===typeof n)return"undefined";if("object"===typeof n&&null!==n){if(-1!==s(e,n))return"<?>";e.push(n)}return n}));u?d.push(t):h(r,t)}}}}};if(e.catchall){var f=a.onerror;a.onerror=function newHandler(e,t,n){return S({error:e,line:n,location:t}).level("ERROR").send(),!!f&&f(e,t,n)}}this.log=S}function Logger(e){var t,n={ssl:!0,catchall:!1,trace:!0,page_info:"never",print:!1,endpoint:null,token:null};if("object"!==typeof e)throw new Error("Invalid parameters for createLogStream()");for(var a in e)n[a]=e[a];if(null===n.token)throw new Error("Token not present.");t=new LogStream(n);var s=function _log(e){if(t)return t.log.apply(this,arguments);throw new Error("You must call LE.init(...) first.")};return{log:function log(){s.apply(this,arguments).level("LOG").send()},warn:function warn(){s.apply(this,arguments).level("WARN").send()},error:function error(){s.apply(this,arguments).level("ERROR").send()},info:function info(){s.apply(this,arguments).level("INFO").send()}}}var i={},r=function _createLogStream(e){if("string"!==typeof e.name)throw new Error("Name not present.");if(i.hasOwnProperty(e.name))throw new Error("A logger with that name already exists!");return i[e.name]=new Logger(e),!0};t.a={init:function _deprecatedInit(e){var t={name:"default"};if("object"===typeof e)for(var n in e)t[n]=e[n];else{if("string"!==typeof e)throw new Error("Invalid parameters for init()");t.token=e}return r(t)},createLogStream:r,to:function _getLogger(e){if(!i.hasOwnProperty(e))throw new Error("Invalid name for logStream");return i[e]},destroy:function _destroyLogStream(e){"undefined"===typeof e&&(e="default"),delete i[e]},log:function log(){for(var e in i)i[e].log.apply(this,arguments)},warn:function warn(){for(var e in i)i[e].warn.apply(this,arguments)},error:function error(){for(var e in i)i[e].error.apply(this,arguments)},info:function info(){for(var e in i)i[e].info.apply(this,arguments)}}},81:function(e,t,n){"use strict";var a=n(238),s=n(17),i=n.n(s);t.a=function(){var e=[],t=[];return[].forEach.call(arguments,(function(n){n&&n._definition&&n._name?e.push(n):t.push(n)})),i.a.apply(null,[].concat(t,[Object(a.css)(e)]))}}},[[257,1,2]]]);
//# sourceMappingURL=main.f00a9f6f.chunk.js.map